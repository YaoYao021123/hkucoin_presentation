<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>HKUCoin Fund - Group 2 Presentation</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.2/dist/chart.umd.min.js"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');
    *{margin:0;padding:0;box-sizing:border-box}
    html,body{width:100%;height:100%}
    body{font-family:'Inter',sans-serif;background:#000001;color:#E5E7EB;overflow:hidden}

    /* 舞台：固定 1920×1080，居中等比缩放 */
    .scale-wrapper{position:fixed;inset:0;background:#000001;overflow:hidden}
    .presentation-stage{width:1920px;height:1080px;position:absolute;left:50%;top:50%;transform-origin:center;will-change:transform}

    /* 安全可视区：上 5% 到 95% */
    .safe-viewport{
      position:absolute;left:0;right:0;top:5%;height:90%;
      display:flex;flex-direction:column;justify-content:center;align-items:center;
      overflow:hidden;padding:40px 48px;
    }

    .slide{position:absolute;inset:0;opacity:0;visibility:hidden;transition:.6s}
    .slide.active{opacity:1;visibility:visible}

    .content-wrapper{width:100%;max-width:1824px;margin:0 auto;display:flex;flex-direction:column;align-items:center;text-align:center;flex:1}

    .corner-logo{position:absolute;top:40px;right:48px;width:100px;height:100px;z-index:100}
    .corner-logo img{width:100%;height:100%;object-fit:contain}

    /* 封面 */
    .title{font-size:112px;font-weight:900;margin-bottom:16px;background:linear-gradient(135deg,#6559F9,#8B5CF6);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
    .subtitle{font-size:48px;color:#FFFFFF;margin-bottom:32px}
    .team-section{background:rgba(30,41,59,.9);border:2px solid rgba(101,89,249,.3);border-radius:24px;padding:24px;margin:16px auto;max-width:1632px;max-height:540px;overflow:hidden}
    .team-title{font-size:35px;font-weight:700;color:#6559F9;margin-bottom:24px;letter-spacing:.05em;text-transform:uppercase}
    .team-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:24px;max-width:1200px;margin:0 auto}
    .team-member{background:rgba(101,89,249,.1);border:1px solid rgba(101,89,249,.3);border-radius:16px;padding:24px 16px}
    .member-name{font-weight:700;color:#E5E7EB;margin-bottom:8px;font-size:28px}
    .member-role{font-size:24px;color:#6559F9;font-weight:600}
    .date{font-size:28px;color:#64748B;margin-top:8px}

    /* P1 和 P2 整体内容垂直居中 */
    #slide1 .content-wrapper, #slide2 .content-wrapper {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 100%;
      max-width: 1824px;
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
    }

    /* 通用绝对居中类 - 用于所有 Part 报幕页 */
    .center-abs {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 100%;
      max-width: 1824px;
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
    }

    /* Part 卡片 */
    .part-announcement{background:rgba(101,89,249,.9);border:2px solid rgba(101,89,249,.3);border-radius:24px;padding:48px 64px;max-width:1536px}
    .part-number{font-size:56px;font-weight:900;color:#E5E7EB;margin-bottom:24px;letter-spacing:.1em;text-transform:uppercase}
    .part-title{font-size:56px;font-weight:700;color:#E5E7EB;margin-bottom:16px;line-height:1.2}
    .speaker-info {font-size: 28px; color: #E5E7EB; margin-top: 24px; /* Optional: Adds some space above it */
}
    /* —— 分析页（p3）—— */
    #slide3 .content-wrapper{width:100%;max-width:1824px;margin:0 auto;display:flex;flex-direction:column;align-items:center;text-align:center;justify-content:flex-start;padding-top:40px} /* 调整为顶部对齐并增加顶部边距 */
    #slide3 .slide-title{font-size:54px;font-weight:900;margin-bottom:24px;color:#6559F9;line-height:1.15} /* 恢复统一边距 */
    #slide3 .tournament-header{margin-bottom:24px} /* 调整为与其他元素一致的间距 */
    #slide3 .tournament-header .tournament-period{font-size:24px;color:#6559F9;margin-bottom:12px;font-weight:600;line-height:1.28} /* 减少标题下方边距 */
    #slide3 .tournament-header .performance-summary{font-size:22px;color:#FFFFFF;line-height:1.28;max-width:1400px;margin:0 auto;margin-bottom:12px} /* 增加总结文字下方边距 */

    /* 中部主区域：适中高度 + 两列布局 */
    #slide3 .performance-main-content{
      display:grid;grid-template-columns:7fr 3fr;gap:24px;align-items:stretch;width:100%;
      height:420px; /* 适中高度 */
    }
    #slide3 .chart-area{
      background:rgba(30,41,59,.9);border:2px solid rgba(101,89,249,.3);border-radius:24px;
      padding:16px;display:flex;flex-direction:column
    }
    #slide3 .chart-title{font-size:26px;font-weight:700;color:#6559F9;margin-bottom:12px}
    #slide3 .chart-container{
      flex:1;background:rgba(15,23,42,.5);border:1px solid rgba(101,89,249,.2);
      border-radius:16px;padding:10px;position:relative;min-height:260px;display:flex;align-items:center;justify-content:center
    }

    /* 右侧三卡：等高 + 等间距（更紧凑） */
    #slide3 .key-metrics-area{display:grid;grid-template-rows:repeat(3,1fr);gap:16px}
    #slide3 .key-metric-card{background:rgba(101,89,249,.15);border:2px solid rgba(101,89,249,.4);border-radius:16px;padding:14px;display:flex;flex-direction:column;justify-content:center;align-items:center}
    #slide3 .key-metric-value{font-size:34px;font-weight:900;color:#6559F9;margin-bottom:6px}
    #slide3 .key-metric-label{color:#E5E7EB;font-size:20px;margin-bottom:4px;font-weight:600}
    #slide3 .key-metric-subtitle{color:#FFFFFF;font-size:17px}

    /* 底部风险指标：统一间距 */
    #slide3 .risk-metrics-section{display:grid;grid-template-columns:repeat(4,1fr);gap:24px;width:100%;margin-top:60px}
    #slide3 .risk-metric-card{background:rgba(30,41,59,.9);border:1px solid rgba(101,89,249,.2);border-radius:16px;padding:22px}
    #slide3 .risk-metric-value{font-size:34px;font-weight:900;color:#FFFFFF;margin-bottom:6px}
    #slide3 .risk-metric-label{color:#64748B;font-size:20px}

    /* 导航 */
    .navigation{position:absolute;bottom:24px;left:50%;transform:translateX(-50%);display:flex;gap:16px;z-index:1000}
    .nav-btn{background:rgba(101,89,249,.9);border:none;color:#fff;padding:12px 24px;border-radius:12px;cursor:pointer;font-weight:700;font-size:18px}
    .nav-btn:disabled{opacity:.4;cursor:not-allowed}
    .slide-indicator{position:absolute;bottom:18px;left:50%;transform:translateX(-50%);display:flex;gap:12px;z-index:1000}
    .indicator{width:12px;height:12px;border-radius:50%;background:rgba(255,255,255,.3);transition:.4s;cursor:pointer}
    .indicator.active{background:#6559F9;width:40px;border-radius:6px}

    /* P4 网格区域 - 使用剩余空间 */
    /* —— Slide4：只保留上排两面板（加高） —— */
    #slide4 .unified-slide{width:90%;height:87%;margin:0 auto;display:flex;flex-direction:column}
    #slide4 .unified-slide .slide-title{text-align:center;font-size:54px;font-weight:900;color:#6559F9;margin-bottom:32px}

    #slide4 .grid-container{
      flex:1;display:grid;grid-template-columns:3fr 1fr;grid-template-rows:1fr;
      gap:28px;width:100%;max-height:760px;padding:0
    }
    #slide4 .grid-panel{background:rgba(30,41,59,.9);border:2px solid rgba(101,89,249,.3);border-radius:18px;padding:20px;display:flex;flex-direction:column}
    #slide4 .panel-title{font-size:34px;font-weight:800;color:#A78BFA;margin-bottom:14px;line-height:1.2}
    #slide4 .panel-title-with-badge{display:flex;align-items:center;justify-content:center;gap:10px;margin-bottom:10px}
    #slide4 .panel-title-with-badge .title-text{font-size:34px;font-weight:800;color:#A78BFA;line-height:1.2}
    #slide4 .title-badge{background:rgba(101,89,249,.2);color:#6559F9;padding:6px 12px;border-radius:10px;font-size:14px;font-weight:700}

    /* 左侧 Core–Satellite：行高更大、文字更粗 */
    #slide4 .badge-title-lg{font-size:24px;font-weight:900;color:#fff;line-height:1.1;text-align:center;display:inline-block;padding:0 4px}
    #slide4 .badge-title-md{font-size:22px;font-weight:900;color:#fff;line-height:1.1;text-align:center;display:inline-block;padding:0 4px}
    /* 你新加的小一档字号（Leverage 用） */
    #slide4 .badge-title-sm{font-size:18px;font-weight:900;color:#fff;line-height:1.1;text-align:center;display:inline-block;padding:0 4px}

    #slide4 .satellite-row{height:126px;display:flex;gap:14px;justify-content:center}
    #slide4 .core-row{height:207px;display:flex;gap:14px;justify-content:center}
    #slide4 .ins-row{height:81px;display:flex;gap:14px;justify-content:center}

    #slide4 .subcell{min-width:50px;padding:4px 3px;display:flex;flex-direction:column;align-items:center;justify-content:center}
    #slide4 .subcell span:first-child{color:#fff;font-size:16px;font-weight:900}
    #slide4 .subcell span:last-child{color:rgba(255,255,255,.95);font-size:16px;font-weight:700}

    /* 右侧 Doughnut：320×320 + 居中数值 */
    #slide4 .donut-wrap{position:relative;width:320px;height:320px;margin:8px auto 0}
    #slide4 .donut-center{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;flex-direction:column;text-align:center;pointer-events:none}
    #slide4 .donut-center .big{font-size:34px;font-weight:900;color:#6559F9}
    #slide4 .donut-center .sub{font-size:20px;font-weight:600;color:#FFFFFF}
    #slide4 #assetLegend{
      display:grid;
      grid-template-columns:repeat(auto-fit, minmax(160px, 1fr));
      gap:12px 20px;
      margin-top:18px;
      font-size:18px;
      justify-content:center;
      align-items:center;
      width:100%;
    }

    /* Slide 7 变量控制高度 */
    :root{
      --unh-main-h: 260px;  /* 主图容器高度 */
      --unh-mini-h: 320px;  /* 迷你相关性框高度 - 延伸到右侧面板0.85位置 */
      --unh-gap: 10px;    /* 左列内部间距 */
    }
    #slide7 .unh-main{ height: var(--unh-main-h); padding: 14px; }
    #slide7 .unh-mini{ height: var(--unh-mini-h); padding: 10px; margin-top: var(--unh-gap); }
    #slide7 h3{ margin-bottom: 12px !important; }
    #slide7 .unh-metrics{ gap: 8px !important; margin-bottom: var(--unh-gap) !important; }

    /* P4 Grid Panel Hover Effects */
    .grid-panel {
      transition: all 0.25s ease;
    }
    .grid-panel:hover {
      box-shadow: 0 8px 25px rgba(101, 89, 249, 0.15);
      border-color: rgba(101, 89, 249, 0.5);
    }

    /* Table Row Hover */
    .grid-panel table tbody tr {
      transition: background-color 0.2s ease;
    }
    .grid-panel table tbody tr:hover {
      background-color: rgba(101, 89, 249, 0.08);
    }

    /* 环形图增长动画 */
    @keyframes donutGrow {
      from {
        stroke-dasharray: 0 100;
      }
    }

    /* P4 统一卡片标题样式 */
    #slide4 .grid-panel {
      display: flex;
      flex-direction: column;
    }

    #slide4 .panel-title {
      font-size: 32px;
      font-weight: 700;
      color: #6559F9;
      margin-bottom: 16px;
      text-align: center;
      line-height: 1.2;
    }

    #slide4 .panel-title-with-badge {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
    }

    #slide4 .title-badge {
      background: rgba(101,89,249,0.2);
      color: #6559F9;
      padding: 6px 12px;
      border-radius: 12px;
      font-size: 16px;
      font-weight: 600;
    }

    /* P9A Apple Event Study */
    #slide9a .chart-container {
      background: rgba(30,41,59,.9);
      border: 2px solid rgba(101,89,249,.3);
      border-radius: 16px;
      padding: 20px;
      display: flex;
      flex-direction: column;
    }

    #slide9a .key-points {
      background: rgba(30,41,59,.9);
      border: 2px solid rgba(101,89,249,.3);
      border-radius: 16px;
      padding: 20px;
      display: flex;
      flex-direction: column;
    }

    /* P9B UNH */
    #slide9b .chart-container {
      background: rgba(30,41,59,.9);
      border: 2px solid rgba(101,89,249,.3);
      border-radius: 16px;
      padding: 20px;
    }

    /* Universal slide scaling - 90% width, centered, 0.05-0.92 vertical */
    .unified-slide {
      width: 90%;
      height: 87%; /* 0.92 - 0.05 = 0.87 */
      margin: 0 auto;
      display: flex;
      flex-direction: column;
    }

    .unified-slide .slide-title {
      text-align: center;
      font-size: 54px;
      font-weight: 900;
      color: #6559F9;
      margin-bottom: 40px;
    }

    /* ===== Slide12（图1布局）===== */
    #slide12 .grid-fig1 {
      display: grid;
      grid-template-columns: 1fr 1fr;               /* 左右等分 */
      grid-template-rows: 1fr 1fr;                  /* 左列上下两块 */
      grid-template-areas:
        "areaA areaB"                               /* A 左上图，B 右大面板 */
        "areaC areaB";                              /* C 左下图，B 右大面板 */
      gap: 28px;
      height: 100%;
    }
    #slide12 .panel {
      background: rgba(30,41,59,.9);
      border: 2px solid rgba(101,89,249,.3);
      border-radius: 16px;
      padding: 18px;
      display: flex; flex-direction: column;
      min-height: 0;
    }
    #slide12 .panel h3{font-size:22px;font-weight:800;color:#A78BFA;margin-bottom:10px}
    #slide12 .canvas-wrap{
      flex:1; min-height:0; position:relative;
      background:rgba(15,23,42,.5); border:1px solid rgba(101,89,249,.2); border-radius:12px; padding:12px;
      display: flex; justify-content: center; align-items: center;
    }
    #slide12 .canvas-wrap canvas {
      max-width: 90% !important;
      max-height: 90% !important;
    }

    /* 右侧交易表面板 */
    #slide12 .panel.table{border-color:rgba(16,185,129,.35)}
    #slide12 .trade-table{width:100%;border-collapse:collapse;font-size:20px}
    #slide12 .trade-table thead th{
      text-align:right;padding:10px 8px;color:#FFFFFF;font-weight:700;border-bottom:1px solid rgba(255,255,255,.08)
    }
    #slide12 .trade-table thead th:first-child,
    #slide12 .trade-table tbody td:first-child{ text-align:left }
    #slide12 .trade-table tbody td{padding:10px 8px;border-bottom:1px solid rgba(255,255,255,.06)}
    #slide12 .pill{display:inline-block;padding:2px 8px;border-radius:999px;font-weight:700;font-size:12px}
    #slide12 .pill-buy{background:rgba(16,185,129,.15);color:#10B981}
    #slide12 .pill-sell{background:rgba(239,68,68,.15);color:#EF4444}
    #slide12 .summary-cards{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:12px}
    #slide12 .summary-card{background:rgba(16,185,129,.08);border:1px solid rgba(16,185,129,.25);border-radius:10px;padding:10px 12px;font-size:20px}
    #slide12 .summary-card h4{color:#10B981;font-size:24px;margin-bottom:6px}

    /* ===== Slide16 (True Drivers & Lessons) ===== */
    #slide16 .performance-main-content {
      padding: 20px 0;
    }
    #slide16 .insight-card {
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }
    #slide16 .insight-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(0,0,0,0.15);
    }
    #slide16 .chart-area {
      background: rgba(30,41,59,.6);
      border: 1px solid rgba(101,89,249,.2);
      border-radius: 12px;
      overflow: hidden;
    }
    #slide16 .chart-title {
      font-size: 18px;
      font-weight: 700;
      color: #A78BFA;
      padding: 16px 20px 0;
      margin-bottom: 8px;
    }

    /* Crypto Section CSS - Missing from Reference File */
    .performance-main-content {
      display: flex;
      gap: 1.5rem;
      margin-bottom: 2rem;
      align-items: stretch;
      width: 100%;
    }

    .cumulative-returns-area {
      flex: 0 0 70%;
      background: rgba(30, 41, 59, 0.9);
      border: 2px solid rgba(101, 89, 249, 0.3);
      border-radius: 1.5rem;
      padding: 1.5rem;
      display: flex;
      flex-direction: column;
    }

    .metrics-table-area {
      flex: 0 0 28%;
      background: rgba(30, 41, 59, 0.9);
      border: 2px solid rgba(101, 89, 249, 0.3);
      border-radius: 1.5rem;
      padding: 1.5rem;
      display: flex;
      flex-direction: column;
    }

    .returns-chart-title {
      font-size: 1.6rem;
      font-weight: 900;
      color: #6559F9;
      margin-bottom: 0.5rem;
      text-align: center;
    }

    .returns-subtitle {
      font-size: 1.2rem;
      color:#FFFFFF;
      margin-bottom: 0.75rem;
      text-align: center;
      font-weight: 600;
    }

    .cumulative-chart-container {
      flex: 1;
      background: rgba(15, 23, 42, 0.5);
      border: 1px solid rgba(101, 89, 249, 0.2);
      border-radius: 1rem;
      padding: 1rem;
      position: relative;
      min-height: 280px;
      max-height: 280px;
    }

    .portfolio-allocation {
      display: flex;
      justify-content: space-between;
      gap: 1rem;
      margin-top: 1rem;
      margin-bottom: 1rem;
    }

    .allocation-layout {
      display: flex;
      align-items: flex-start;
      gap: 1rem;
      margin-bottom: 1rem;
    }

    .allocation-charts-container {
      display: flex;
      justify-content: space-between;
      gap: 1rem;
      flex: 1;
    }

    .allocation-chart {
      flex: 1;
      background: rgba(15, 23, 42, 0.5);
      border: 1px solid rgba(101, 89, 249, 0.2);
      border-radius: 1rem;
      padding: 0.5rem;
      text-align: center;
    }

    .allocation-title {
      color: #E5E7EB;
      font-size: 1.1rem;
      font-weight: 600;
      margin-bottom: 0.5rem;
    }

    .chart-wrapper-large {
      position: relative;
      height: 120px;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .unified-legend {
      background: rgba(15, 23, 42, 0.3);
      border: 1px solid rgba(101, 89, 249, 0.15);
      border-radius: 0.3rem;
      padding: 0.4rem;
      width: 140px;
      flex-shrink: 0;
      align-self: flex-start;
    }

    .legend-column {
      display: flex;
      flex-direction: column;
      gap: 0.15rem;
    }

    .legend-item {
      display: flex;
      align-items: center;
      margin-bottom: 0.1rem;
    }

    .legend-color {
      width: 6px;
      height: 6px;
      margin-right: 0.3rem;
      border-radius: 1px;
      flex-shrink: 0;
    }

    .legend-text {
      color: #E5E7EB;
      font-size: 0.65rem;
      line-height: 1.1;
      font-weight: 500;
    }

    .metrics-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1rem;
    }

    .metrics-table th {
      background: rgba(101, 89, 249, 0.2);
      color: #6559F9;
      font-weight: 700;
      font-size: 1.0rem;
      padding: 1rem;
      border: 1px solid rgba(101, 89, 249, 0.3);
      text-align: center;
    }

    .metrics-table .metric-header {
      color: #E5E7EB;
    }

    .metrics-table .crypto-header {
      color: #6559F9;
    }

    .metrics-table .no-crypto-header {
      color: #22C55E;
    }

    .metrics-table td {
      padding: 1rem;
      border: 1px solid rgba(101, 89, 249, 0.2);
      text-align: center;
      font-size: 0.95rem;
      background: rgba(15, 23, 42, 0.5);
    }

    .metrics-table .metric-name {
      color: #E5E7EB;
      font-weight: 600;
      text-align: left;
      padding-left: 1.5rem;
    }

    .metrics-table .crypto-value {
      color: #6559F9;
      font-weight: 700;
    }

    .metrics-table .no-crypto-value {
      color: #22C55E;
      font-weight: 700;
    }

    .metrics-explanations {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
      margin-top: 0.75rem;
    }

    .metric-explanation {
      padding: 0.5rem;
      background: rgba(15, 23, 42, 0.7);
      border-radius: 0.5rem;
      border-left: 3px solid #6559F9;
    }

    .metric-explanation-text {
      color: #E5E7EB;
      font-size: 0.95rem;
      line-height: 1.3;
      margin: 0;
    }

    .core-conclusion {
      margin-top: 0.75rem;
      padding: 0.75rem;
      background: rgba(239, 68, 68, 0.1);
      border: 2px solid #EF4444;
      border-radius: 0.75rem;
    }

    .conclusion-text {
      color: #EF4444;
      font-size: 0.9rem;
      font-weight: 700;
      line-height: 1.3;
      margin: 0;
      text-align: left;
    }

    .chart-title {
      font-size: 1.8rem;
      font-weight: 700;
      color: #6559F9;
      margin-bottom: 1rem;
      text-align: center;
    }

    /* 15-18页字体放大 */
    #slide14a .legend-text {
      font-size: 1.0rem;
      font-weight: 600;
    }

    #slide14a .metrics-table th {
      font-size: 1.0rem;
      padding: 0.8rem;
      font-weight: 700;
    }

    #slide14a .metrics-table td {
      font-size: 0.9rem;
      padding: 0.8rem;
    }

    #slide14a .metric-explanation-text {
      font-size: 1.1rem;
      line-height: 1.4;
    }

    #slide14a .metric-explanation-text strong {
      font-size: 1.3rem;
      font-weight: 800;
    }

    #slide14a .conclusion-text {
      font-size: 1.1rem;
      line-height: 1.4;
    }

    #slide14a .conclusion-text strong {
      font-size: 1.4rem;
      font-weight: 800;
    }

    #slide14a .returns-chart-title {
      font-size: 2.2rem;
      font-weight: 900;
    }

    #slide14a .returns-subtitle {
      font-size: 1.5rem;
      font-weight: 700;
    }

    #slide14a .allocation-title {
      font-size: 1.4rem;
      font-weight: 700;
    }

    #slide14a .chart-title {
      font-size: 1.5rem;
      font-weight: 700;
    }

    /* 针对Key Performance Metrics表格标题单独调整 */
    #slide14a .metrics-table-area .chart-title {
      font-size: 1.3rem;
      font-weight: 700;
    }

    /* 图表说明文字放大 */
    #slide14a .chart-explanation .explanation-text {
      font-size: 1.1rem !important;
      line-height: 1.5;
    }

    #slide14a .chart-explanation .explanation-text strong {
      font-size: 1.2rem;
      font-weight: 800;
    }

    /* Slides 15-18 通用字体放大 */
    #slide14b .slide-title, #slide14c .slide-title, #slide14d .slide-title {
      font-size: 3.8rem;
      font-weight: 900;
    }

    #slide14b, #slide14c, #slide14d {
      font-size: 1.1rem;
    }

    #slide14b .chart-title, #slide14c .chart-title, #slide14d .chart-title {
      font-size: 2.4rem;
      font-weight: 800;
    }

    #slide14b .insight-title, #slide14c .insight-title, #slide14d .insight-title {
      font-size: 1.5rem;
      font-weight: 800;
    }

    #slide14b .insight-list li, #slide14c .insight-list li, #slide14d .insight-list li {
      font-size: 1.1rem;
      line-height: 1.5;
    }

    #slide14b .insight-list li strong, #slide14c .insight-list li strong, #slide14d .insight-list li strong {
      font-size: 1.3rem;
      font-weight: 800;
    }

    #slide14b .column-title, #slide14c .column-title, #slide14d .column-title {
      font-size: 1.6rem;
      font-weight: 800;
    }

    #slide14b .column-subtitle, #slide14c .column-subtitle, #slide14d .column-subtitle {
      font-size: 1.2rem;
      font-weight: 700;
    }

    #slide14b .risk-label, #slide14c .risk-label, #slide14d .risk-label {
      font-size: 1.1rem;
      font-weight: 800;
    }

    #slide14b .risk-content, #slide14c .risk-content, #slide14d .risk-content {
      font-size: 0.95rem;
      line-height: 1.4;
    }

    #slide14b .summary-highlight, #slide14c .summary-highlight, #slide14d .summary-highlight {
      font-size: 1.5rem;
      font-weight: 800;
    }

    #slide14b .summary-detail, #slide14c .summary-detail, #slide14d .summary-detail {
      font-size: 1.1rem;
      line-height: 1.4;
    }

    /* 特殊小标题样式加强 */
    #slide14b h3, #slide14c h3, #slide14d h3,
    #slide14b h4, #slide14c h4, #slide14d h4 {
      font-size: 1.4rem;
      font-weight: 800;
      color: #6559F9;
    }

    #slide14b .panel-title, #slide14c .panel-title, #slide14d .panel-title {
      font-size: 1.8rem;
      font-weight: 900;
    }

    /* tournament-period 小标题放大 */
    #slide14a .tournament-period, #slide14b .tournament-period, 
    #slide14c .tournament-period, #slide14d .tournament-period {
      font-size: 2.0rem;
      font-weight: 700;
    }
  </style>
</head>
<body>
  <div class="scale-wrapper">
    <div class="presentation-stage" id="stage">

      <div class="corner-logo">
        <img src="logo.png" alt="HKUCoin Fund Logo" onerror="this.style.display='none'">
      </div>

      <!-- Slide 1 -->
      <div class="slide cover-slide active" id="slide1">
        <div class="safe-viewport">
          <div class="content-wrapper">
            <h1 class="title">HKUCoin Fund</h1>
            <h2 class="subtitle">Professional Asset Management</h2>

            <div class="team-section">
              <h3 class="team-title">GROUP 2 TEAM MEMBERS</h3>
              <div class="team-grid">
                <div class="team-member"><div class="member-name">Wang Haoyu</div><div class="member-role">Speaker 1</div></div>
                <div class="team-member"><div class="member-name">Shen Leyuan</div><div class="member-role">Speaker 2</div></div>
                <div class="team-member"><div class="member-name">Hu Zheyuan</div><div class="member-role">Speaker 3</div></div>
                <div class="team-member"><div class="member-name">Zhang Ziming</div><div class="member-role">Speaker 4</div></div>
                <div class="team-member"><div class="member-name">Wang Fengjiao</div><div class="member-role">Speaker 5</div></div>
                <div class="team-member"><div class="member-name">Yao Yao</div><div class="member-role">Speaker 6</div></div>
                <div class="team-member"><div class="member-name">Song Yuhan</div><div class="member-role">Speaker 7</div></div>
              </div>
            </div>

            <div class="date">October 2025</div>
          </div>
        </div>
      </div>

      <!-- Slide 2 -->
      <div class="slide content-slide" id="slide2">
        <div class="safe-viewport">
          <div class="content-wrapper">
            <div class="part-announcement">
              <div class="part-number">Part 1</div>
              <div class="part-title">Portfolio Performance Overview</div>
              <div class="speaker-info">Speaker: Wang Haoyu</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Slide 3 -->
      <div class="slide content-slide" id="slide3">
        <div class="safe-viewport">
          <div class="content-wrapper">
            <h1 class="slide-title">Fund Performance Analysis</h1>

            <div class="tournament-header">
              <div class="tournament-period">Trading Tournament Period: September 2–September 26, 2025, U.S. Eastern Time</div>
              <div class="performance-summary">Our portfolio consistently outperformed the benchmark, delivering exceptional risk-adjusted returns</div>
            </div>

            <div class="performance-main-content">
              <div class="chart-area">
                <div class="chart-title">Portfolio vs Benchmark Performance</div>
                <div class="chart-container">
                  <canvas id="performanceChart" width="1200" height="360"></canvas>
                </div>
              </div>

              <div class="key-metrics-area">
                <div class="key-metric-card">
                  <div class="key-metric-value">+238.18%</div>
                  <div class="key-metric-label">Annual Return</div>
                  <div class="key-metric-subtitle">vs Benchmark: +49.84%</div>
                </div>
                <div class="key-metric-card">
                  <div class="key-metric-value">4.69</div>
                  <div class="key-metric-label">Sharpe Ratio</div>
                  <div class="key-metric-subtitle">Risk-adjusted return</div>
                </div>
                <div class="key-metric-card">
                  <div class="key-metric-value">+91.32%</div>
                  <div class="key-metric-label">Annual Alpha</div>
                  <div class="key-metric-subtitle">Excess return</div>
                </div>
              </div>
            </div>

            <div class="risk-metrics-section">
              <div class="risk-metric-card"><div class="risk-metric-value">3.07</div><div class="risk-metric-label">Beta</div></div>
              <div class="risk-metric-card"><div class="risk-metric-value">0.77</div><div class="risk-metric-label">Treynor Ratio</div></div>
              <div class="risk-metric-card"><div class="risk-metric-value">1.91</div><div class="risk-metric-label">Information Ratio</div></div>
              <div class="risk-metric-card"><div class="risk-metric-value">-1.67%</div><div class="risk-metric-label">Max Drawdown</div></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Slide 4 (仅两面板的版本) -->
      <div class="slide content-slide" id="slide4">
        <div class="safe-viewport">
          <div class="unified-slide">
            <h1 class="slide-title">Active Multi-Asset Growth Strategy & Allocation Overview</h1>

            <div class="grid-container">

              <!-- A：Three Layer Portfolio & Insurance -->

              <div class="grid-panel">
                 <div class="panel-title-with-badge">
                    <div class="title-text">Mega-Cap Core, Small-Cap & Crypto for Offense, GLD/TLT as Dynamic Insurance, with a Light Leverage Kicker</div>
                    <div class="title-badge">Portfolio Strategy</div>
              </div>                      
                <!-- Three Layer Introduction -->
                <div style="background: rgba(101,89,249,0.1); border-left: 4px solid #6559F9; border-radius: 8px; padding: 12px; margin-bottom: 12px;">
                  <div style="font-size: 20px; color: #E5E7EB; line-height: 1.5;">
                    <strong style="color: #6559F9;">🎯 Offence & Leverage Layer (32%):</strong> High-growth opportunities (Small-Cap, Crypto, Leverage)<br>
                    <strong style="color: #6559F9;">🏛️ Mega-Cap Core Layer (47%):</strong> Stable blue-chip holdings (AAPL, UNH, NVDA, TSLA, META)<br>
                    <strong style="color: #F59E0B;">🛡️ Insurance Layer (21%):</strong> Defensive hedges (GLD, TLT)
                  </div>
                </div>

                <div style="flex: 1; display: flex; flex-direction: column; justify-content: center; gap: 12px;">
                  <!-- Satellite -->
                  <div class="satellite-row">
                    <!-- Small-Cap -->
                    <div style="flex: 15.6; background: #7C3AED; border-radius: 12px; position: relative; overflow: hidden; min-width: 120px;">
                      <div style="height: 60%; display: flex; align-items: center; justify-content: center;">
                        <div class="badge-title-md">Small-Cap 15.6%</div>
                      </div>
                      <div style="position: absolute; bottom: 0; left: 0; right: 0; height: 40%; display: flex; border-top: 1px solid rgba(255,255,255,.3);">
                        <div class="subcell" style="flex: 6.7; background: rgba(255,255,255,.18); border-right: 1px solid rgba(255,255,255,.3);"><span>OPEN</span><span>6.7%</span></div>
                        <div class="subcell" style="flex: 5.8; background: rgba(255,255,255,.12); border-right: 1px solid rgba(255,255,255,.3);"><span>SERV</span><span>5.8%</span></div>
                        <div class="subcell" style="flex: 3.1; background: rgba(255,255,255,.08);"><span>ONDS</span><span>3.1%</span></div>
                      </div>
                    </div>

                    <!-- Crypto -->
                    <div style="flex: 12.8; background: #EC4899; border-radius: 12px; position: relative; overflow: hidden; min-width: 110px;">
                      <div style="height: 55%; display: flex; align-items: center; justify-content: center;">
                        <div class="badge-title-md">Crypto 12.8%</div>
                      </div>
                      <div style="position: absolute; bottom: 0; left: 0; right: 0; height: 45%; display: flex; border-top: 1px solid rgba(255,255,255,.3);">
                        <div class="subcell" style="flex: 8.5; background: rgba(255,255,255,.18); border-right: 1px solid rgba(255,255,255,.3);"><span>SOL</span><span>8.5%</span></div>
                        <div class="subcell" style="flex: 2.3; background: rgba(255,255,255,.12); border-right: 1px solid rgba(255,255,255,.3);"><span>BTC</span><span>2.3%</span></div>
                        <div class="subcell" style="flex: 2.0; background: rgba(255,255,255,.08);"><span>others</span><span>2.0%</span></div>
                      </div>
                    </div>

                    <!-- Leverage（使用 badge-title-sm） -->
                    <div style="flex: 3.5; background: #C084FC; border-radius: 12px; position: relative; overflow: hidden; min-width: 90px;">
                      <div style="height: 70%; display: flex; align-items: center; justify-content: center;">
                        <div class="badge-title-sm">Leverage 3.5%</div>
                      </div>
                      <div style="position: absolute; bottom: 0; left: 0; right: 0; height: 30%; display: flex; border-top: 1px solid rgba(255,255,255,.3);">
                        <div class="subcell" style="flex: 1; background: rgba(255,255,255,.12);"><span>TQQQ</span><span>3.5%</span></div>
                      </div>
                    </div>
                  </div>

                  <!-- 分隔线 -->
                  <div style="height:1px;background:rgba(255,255,255,.2);margin:0 10px;"></div>

                  <!-- Core -->
                  <div class="core-row">
                    <div style="flex: 47.3; background: #6559F9; border-radius: 12px; position: relative; overflow: hidden; min-width: 320px;">
                      <div style="height: 58%; display: flex; align-items: center; justify-content: center;">
                        <div class="badge-title-lg">Core Holdings 47.3%</div>
                      </div>
                      <div style="position: absolute; bottom: 0; left: 0; right: 0; height: 42%; display: flex; border-top: 1px solid rgba(255,255,255,.3);">
                        <div class="subcell" style="flex: 13.9; background: rgba(255,255,255,.18); border-right: 1px solid rgba(255,255,255,.3); min-width:56px;"><span>AAPL</span><span>13.9%</span></div>
                        <div class="subcell" style="flex: 10.9; background: rgba(255,255,255,.15); border-right: 1px solid rgba(255,255,255,.3); min-width:52px;"><span>UNH</span><span>10.9%</span></div>
                        <div class="subcell" style="flex: 10.7; background: rgba(255,255,255,.12); border-right: 1px solid rgba(255,255,255,.3); min-width:52px;"><span>NVDA</span><span>10.7%</span></div>
                        <div class="subcell" style="flex: 6.0; background: rgba(255,255,255,.08); border-right: 1px solid rgba(255,255,255,.3); min-width:44px;"><span>TSLA</span><span>6.0%</span></div>
                        <div class="subcell" style="flex: 5.9; background: rgba(255,255,255,.06); min-width:44px;"><span>META</span><span>5.9%</span></div>
                      </div>
                    </div>
                  </div>

                  <!-- Insurance -->
                  <div class="ins-row">
                    <div style="flex: 20.8; background: #F59E0B; border-radius: 12px; position: relative; overflow: hidden; min-width: 200px;">
                      <div style="height: 60%; display: flex; align-items: center; justify-content: center;">
                        <div class="badge-title-md">Insurance 20.8%</div>
                      </div>
                      <div style="position: absolute; bottom: 0; left: 0; right: 0; height: 40%; display: flex; border-top: 1px solid rgba(255,255,255,.3);">
                        <div class="subcell" style="flex: 15.6; background: rgba(255,255,255,.18); border-right: 1px solid rgba(255,255,255,.3); min-width:72px;"><span>GLD 15.6%</span></div>
                        <div class="subcell" style="flex: 5.2; background: rgba(255,255,255,.12); min-width:56px;"><span>TLT 5.2%</span></div>
                      </div>
                    </div>
                  </div>
                </div>

                <div style="text-align: right; font-size: 16px; color:#FFFFFF; margin-top: 10px;">
                  Total Holdings: 100% (incl. crypto) | Data as of Sep 26, 2025
                </div>
              </div>

              <!-- B：Asset Allocation -->
              <div class="grid-panel">
                <div class="panel-title-with-badge">
                  <div class="title-text">Asset Allocation</div>
                  <div class="title-badge">Portfolio Total</div>
                </div>

                <div style="flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center;">
                  <div class="donut-wrap">
                    <canvas id="assetDonut"></canvas>
                    <div class="donut-center">
                      <div class="sub">Total Assets</div>
                    </div>
                  </div>

                  <div id="assetLegend">
                    <div style="display:flex;align-items:center;gap:8px"><div style="width:14px;height:14px;background:#6559F9;border-radius:3px"></div><span style="color:#E5E7EB;font-weight:800">Stocks 66.4%</span></div>
                    <div style="display:flex;align-items:center;gap:8px"><div style="width:14px;height:14px;background:#F59E0B;border-radius:3px"></div><span style="color:#E5E7EB;font-weight:800">Commodities 15.6%</span></div>
                    <div style="display:flex;align-items:center;gap:8px"><div style="width:14px;height:14px;background:#EC4899;border-radius:3px"></div><span style="color:#E5E7EB;font-weight:800">Crypto 12.8%</span></div>
                    <div style="display:flex;align-items:center;gap:8px"><div style="width:14px;height:14px;background:#10B981;border-radius:3px"></div><span style="color:#E5E7EB;font-weight:800">Bonds 5.2%</span></div>
                  </div>
                </div>

                <div style="text-align: right; font-size: 16px; color:#FFFFFF; margin-top: 10px;">
                  Diversification across 4 major asset classes
                </div>  
              </div>

            </div>
          </div>
        </div>
      </div>

      <!-- Slide 5 -->
      <div class="slide content-slide" id="slide5">
        <div class="safe-viewport">
          <div class="content-wrapper center-abs">
            <div class="part-announcement">
              <div class="part-number">Part 2</div>
              <div class="part-title">Large-Cap Strategy</div>
              <div class="speaker-info">Speaker: Shen Leyuan</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Slide 6: P9A Apple Event Study -->
      <div class="slide content-slide" id="slide6">
        <div class="safe-viewport">
          <div class="unified-slide">
            <h1 class="slide-title">Apple Event Study</h1>
            <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 30px; height: 100%;">

              <!-- Left: Charts (8:4 ratio) -->
              <div id="slide9a" style="display: flex; flex-direction: column; gap: 20px;">
                <!-- Event Window CAR Chart -->
                <div class="chart-container" style="flex: 1;">
                  <h3 style="font-size: 24px; font-weight: 700; color: #6559F9; margin-bottom: 15px;">Historical Event Windows CAR (5 Years Average)</h3>
                  <div style="flex: 1; background: rgba(15,23,42,0.5); border: 1px solid rgba(101,89,249,0.2); border-radius: 12px; display: flex; align-items: center; justify-content: center; min-height: 250px;">
                    <canvas id="appleCarChart" style="width: 100%; height: 100%;"></canvas>
                  </div>
                  <div style="font-size: 16px; color:#FFFFFF; margin-top: 10px;">
                    <strong>Historical Events:</strong> 2021-2024 iPhone launches (4 events)<br>
                    <strong>Analysis:</strong> AR = AAPL_return - SPY_return, CAR = cumulative sum(AR) (-5 to +10 trading days)
                  </div>
                </div>

                <!-- Current Event Window -->
                <div class="chart-container" style="flex: 1;">
                  <h3 style="font-size: 24px; font-weight: 700; color: #6559F9; margin-bottom: 15px;">Current Event Window Trajectory</h3>
                  <div style="flex: 1; background: rgba(15,23,42,0.5); border: 1px solid rgba(101,89,249,0.2); border-radius: 12px; display: flex; align-items: center; justify-content: center; min-height: 200px;">
                    <canvas id="appleCurrentChart" style="width: 100%; height: 100%;"></canvas>
                  </div>
                  <div style="font-size: 16px; color:#FFFFFF; margin-top: 10px;">
                    <strong>Strategy:</strong> Entry at event day (Day 0), Exit at Day +8 (+2.68% CAR)<br>
                    <strong>Result:</strong> +6.42% CAR by Day +10 (outperforming historical average)
                  </div>
                </div>
              </div>

              <!-- Right: Key Points + Apple Logo (1:4 ratio) -->
              <div id="slide9a" style="display: flex; flex-direction: column; gap: 20px;">
                <!-- Apple Logo -->
                <div class="key-points" style="flex: 0.3; display: flex; flex-direction: column; align-items: center; justify-content: center;">
                  <img src="./logo/apple-logo-svgrepo-com.svg" alt="Apple Logo" style="width: 80px; height: 80px; margin-bottom: 8px;" onerror="this.style.display='none'">
                  <div style="font-size: 30px; font-weight: 700; color: #6559F9; margin-bottom: 4px;">Apple(AAPL)</div>
                  <div style="font-size: 18px; color:#FFFFFF; text-align: center;">Event-Driven Strategy</div>
                </div>

                <!-- Key Points -->
                <div class="key-points" style="flex: 0.7;">
                  <h3 style="font-size: 30px; font-weight: 700; color: #6559F9; margin-bottom: 15px;">Key Findings</h3>
                  <div style="display: flex; flex-direction: column; gap: 12px;">
                    <div style="background: rgba(101,89,249,0.1); border-left: 4px solid #6559F9; padding: 12px; border-radius: 6px;">
                      <div style="font-size: 24px; font-weight: 600; color: #E5E7EB; margin-bottom: 4px;">Historical Pattern</div>
                      <div style="font-size: 18px; color:#FFFFFF;">4-yr avg CAR: -3.24% by Day +4, iPhone 15 hit hardest (-7.22%)</div>
                    </div>
                    <div style="background: rgba(16,185,129,0.1); border-left: 4px solid #10B981; padding: 12px; border-radius: 6px;">
                      <div style="font-size: 24px; font-weight: 600; color: #E5E7EB; margin-bottom: 4px;">Strategy Performance</div>
                      <div style="font-size: 18px; color:#FFFFFF;">2025: +2.68% exit, +6.42% total (outperforms avg)</div>
                    </div>
                    <div style="background: rgba(245,158,11,0.1); border-left: 4px solid #F59E0B; padding: 12px; border-radius: 6px;">
                      <div style="font-size: 24px; font-weight: 600; color: #E5E7EB; margin-bottom: 4px;">Risk Management</div>
                      <div style="font-size: 18px; color:#FFFFFF;">Pre-defined entry/exit points based on historical patterns</div>
                    </div>
                    <div style="background: rgba(16,185,129,0.1); border-left: 4px solid #10B981; padding: 12px; border-radius: 6px;">
                      <div style="font-size: 24px; font-weight: 600; color: #E5E7EB; margin-bottom: 4px;">Current Performance</div>
                      <div style="font-size: 18px; color:#FFFFFF;">2025 Event: +6.42% CAR by day +10 (following historical pattern)</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Slide 7: UNH Stable Growth -->
      <div class="slide content-slide" id="slide7">
        <div class="safe-viewport">
          <div class="unified-slide">
            <h1 class="slide-title">UNH: Stable Growth & Portfolio Anchor</h1>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; height: 100%;">

              <!-- Left: UNH Price Trend -->
              <div class="unh-panel chart-container" style="display: flex; flex-direction: column; height: 100%; max-height: 100%;">
                <h3 style="font-size: 28px; font-weight: 700; color: #6559F9; margin-bottom: 16px;">UNH 5-Year Weekly Trend + 200-Day MA</h3>

                <!-- Key Metrics Cards -->
                <div class="unh-metrics" style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-bottom: 12px;">
                  <div style="background: rgba(101,89,249,0.1); border: 1px solid rgba(101,89,249,0.3); border-radius: 8px; padding: 10px; text-align: center;">
                    <div style="font-size: 20px; font-weight: 700; color: #6559F9;">29.8%</div>
                    <div style="font-size: 14px; color:#FFFFFF;">Annual Volatility</div>
                  </div>
                  <div style="background: rgba(239,68,68,0.1); border: 1px solid rgba(239,68,68,0.3); border-radius: 8px; padding: 10px; text-align: center;">
                    <div style="font-size: 20px; font-weight: 700; color: #EF4444;">-61.4%</div>
                    <div style="font-size: 14px; color:#FFFFFF;">Max Drawdown</div>
                  </div>
                  <div style="background: rgba(16,185,129,0.1); border: 1px solid rgba(16,185,129,0.3); border-radius: 8px; padding: 10px; text-align: center;">
                    <div style="font-size: 20px; font-weight: 700; color: #10B981;">60.1%</div>
                    <div style="font-size: 14px; color:#FFFFFF;">Time Above 200-DMA</div>
                  </div>
                  <div style="background: rgba(245,158,11,0.1); border: 1px solid rgba(245,158,11,0.3); border-radius: 8px; padding: 10px; text-align: center;">
                    <div style="font-size: 20px; font-weight: 700; color: #F59E0B;">0.68</div>
                    <div style="font-size: 14px; color:#FFFFFF;">Portfolio Beta</div>
                  </div>
                </div>

                <div class="unh-main" style="background: rgba(15,23,42,0.5); border: 1px solid rgba(101,89,249,0.2); border-radius: 12px; display: flex; align-items: center; justify-content: center;">
                  <canvas id="unhTrendChart" style="width: 100%; height: 100%;"></canvas>
                </div>

                <!-- 90-Day Rolling Correlation Mini Chart -->
                <div class="unh-mini" style="background: rgba(15,23,42,0.5); border: 1px solid rgba(101,89,249,0.2); border-radius: 12px; padding: 12px 10px;">
                  <div style="font-size: 24px; font-weight: 600; color: #6559F9; margin-bottom: 8px; text-align: center;">90-Day Rolling Correlation</div>
                  <div style="display: flex; gap: 8px; height: 50px;">
                    <div style="flex: 1; background: rgba(101,89,249,0.1); border-radius: 6px; padding: 8px; display: flex; flex-direction: column; align-items: center; justify-content: center;">
                      <div style="font-size: 20px; font-weight: 700; color: #10B981;">0.62</div>
                      <div style="font-size: 14px; color:#FFFFFF; text-align: center;">UNH vs Portfolio (Avg: 0.58)</div>
                    </div>
                    <div style="flex: 1; background: rgba(245,158,11,0.1); border-radius: 6px; padding: 8px; display: flex; flex-direction: column; align-items: center; justify-content: center;">
                      <div style="font-size: 20px; font-weight: 700; color: #F59E0B;">0.48</div>
                      <div style="font-size: 14px; color:#FFFFFF; text-align: center;">UNH vs SPY (Avg: 0.52)</div>
                    </div>
                  </div>
                  <canvas id="correlationMiniChart" style="width: 100%; height: calc(100% - 80px); margin-top: 8px;"></canvas>
                </div>

                <div style="font-size: 14px; color:#FFFFFF; margin-top: 8px; line-height: 1.3; text-align: left;">
                  <strong>Methodology:</strong> Weekly Adj Close with 200-DMA from daily data (2020-2025)<br>
                  <strong>Current:</strong> $344.08 vs 200-DMA $401.08 | <strong>Note:</strong> Volatility from daily returns, MA from daily data
                </div>
              </div>

              <!-- Right: Portfolio Holdings -->
              <div class="unh-panel chart-container" style="display: flex; flex-direction: column; height: 100%;">
                <h3 style="font-size: 28px; font-weight: 700; color: #6559F9; margin-bottom: 20px;">Portfolio Holdings Allocation</h3>
                <div style="flex: 1; display: flex; flex-direction: column; gap: 20px;">
                  <!-- Top Holdings Bar Chart -->
                  <div style="flex: 2; background: rgba(15,23,42,0.5); border: 1px solid rgba(101,89,249,0.2); border-radius: 12px; padding: 24px; display: flex; flex-direction: column;">
                    <canvas id="holdingsChart" style="width: 100%; height: 100%;"></canvas>
                  </div>

                  <!-- Strategic Value Statement -->
                  <div style="flex: 1; background: rgba(101,89,249,0.1); border: 2px solid rgba(101,89,249,0.3); border-radius: 12px; padding: 24px; display: flex; flex-direction: column; justify-content: center;">
                    <h4 style="font-size: 30px; font-weight: 700; color: #6559F9; margin-bottom: 16px;">Strategic Value</h4>
                    <div style="font-size: 20px; color: #E5E7EB; line-height: 1.7;">
                      <strong style="color: #10B981;">Defensive Anchor:</strong> Healthcare sector stability with consistent earnings growth<br>
                      <strong style="color: #6559F9;">Low Beta (0.68):</strong> Portfolio diversification benefit during market volatility<br>
                      <strong style="color: #F59E0B;">Rebalancing Hub:</strong> Core position enables tactical satellite adjustments
                    </div>
                  </div>
                </div>
                <div style="font-size: 14px; color:#FFFFFF; margin-top: 16px; line-height: 1.5;">
                  <strong>Portfolio Coverage:</strong> Top 8 holdings represent 89.1% of total portfolio value<br>
                  <strong>UNH Weight:</strong> 10.9% (3rd largest holding, core defensive position)
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Slide 8 -->
      <div class="slide content-slide" id="slide8">
        <div class="safe-viewport">
          <div class="content-wrapper center-abs">
            <div class="part-announcement">
              <div class="part-number">Part 3</div>
              <div class="part-title">Small-Cap Strategy</div>
              <div class="speaker-info">Speaker: Hu Zheyuan</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Slide 9: P10A Why Small Caps -->
      <div class="slide content-slide" id="slide9">
        <div class="safe-viewport">
          <div class="unified-slide">
            <h1 class="slide-title">Why Small Caps: Alpha Opportunities</h1>
            <div style="display: grid; grid-template-columns: 3fr 2fr; gap: 30px; height: 100%;">

              <!-- Left: Three Reason Cards -->
              <div style="display: flex; flex-direction: column; gap: 20px;">
                <!-- Reason 1: Small Base for Growth -->
                <div style="background: rgba(30,41,59,.9); border: 1px solid rgba(101,89,249,.3); border-radius: 16px; padding: 25px; flex: 1;">
                  <div style="display: flex; align-items: center; margin-bottom: 15px;">
                    <div style="width: 36px; height: 36px; background: linear-gradient(135deg, #6559F9, #8B5CF6); border-radius: 12px; display: flex; align-items: center; justify-content: center; margin-right: 15px;">
                      <span style="font-size: 24px; font-weight: 900; color: white;">1</span>
                    </div>
                    <h3 style="font-size: 24px; font-weight: 700; color: #6559F9; margin: 0;">Small Growth Base</h3>
                  </div>
                  <div style="font-size: 20px; color: #E5E7EB; line-height: 1.6;">
                    Lower revenue baselines create higher growth potential from market share gains and product innovation. Small-cap companies can achieve 50-100%+ growth rates vs 10-20% for large caps.
                  </div>
                  <div style="margin-top: 15px; padding: 12px; background: rgba(101,89,249,0.1); border-radius: 8px;">
                    <div style="font-size: 18px; color:#FFFFFF; font-style: italic;">
                      <strong>Industry View:</strong> "Small caps represent the breeding ground for tomorrow's market leaders"
                    </div>
                  </div>
                </div>

                <!-- Reason 2: Limited Coverage -->
                <div style="background: rgba(30,41,59,.9); border: 1px solid rgba(16,185,129,.3); border-radius: 16px; padding: 25px; flex: 1;">
                  <div style="display: flex; align-items: center; margin-bottom: 15px;">
                    <div style="width: 36px; height: 36px; background: linear-gradient(135deg, #10B981, #059669); border-radius: 12px; display: flex; align-items: center; justify-content: center; margin-right: 15px;">
                      <span style="font-size: 24px; font-weight: 900; color: white;">2</span>
                    </div>
                    <h3 style="font-size: 24px; font-weight: 700; color: #10B981; margin: 0;">Limited Coverage</h3>
                  </div>
                  <div style="font-size: 20px; color: #E5E7EB; line-height: 1.6;">
                    Fewer analysts following small caps creates information asymmetry opportunities. Institutional ownership often <20% vs >80% for large caps.
                  </div>
                  <div style="margin-top: 15px; padding: 12px; background: rgba(16,185,129,0.1); border-radius: 8px;">
                    <div style="font-size: 18px; color:#FFFFFF; font-style: italic;">
                      <strong>Research Gap:</strong> Average coverage: 2-3 analysts vs 15-20+ for large caps
                    </div>
                  </div>
                </div>

                <!-- Reason 3: Information Asymmetry -->
                <div style="background: rgba(30,41,59,.9); border: 1px solid rgba(245,158,11,.3); border-radius: 16px; padding: 25px; flex: 1;">
                  <div style="display: flex; align-items: center; margin-bottom: 15px;">
                    <div style="width: 36px; height: 36px; background: linear-gradient(135deg, #F59E0B, #D97706); border-radius: 12px; display: flex; align-items: center; justify-content: center; margin-right: 15px;">
                      <span style="font-size: 24px; font-weight: 900; color: white;">3</span>
                    </div>
                    <h3 style="font-size: 24px; font-weight: 700; color: #F59E0B; margin: 0;">Information Edge</h3>
                  </div>
                  <div style="font-size: 20px; color: #E5E7EB; line-height: 1.6;">
                    Local knowledge and specialzed industry insights provide competitive advantages. Less efficient pricing creates mispricing opportunities.
                  </div>
                  <div style="margin-top: 15px; padding: 12px; background: rgba(245,158,11,0.1); border-radius: 8px;">
                    <div style="font-size: 18px; color:#FFFFFF; font-style: italic;">
                      <strong>Edge Source:</strong> Deep-dive research and on-the-ground intelligence
                    </div>
                  </div>
                </div>
              </div>

              <!-- Right: Risk Assessment Card -->
              <div style="background: rgba(30,41,59,.9); border: 1px solid rgba(239,68,68,.3); border-radius: 16px; padding: 25px; display: flex; flex-direction: column;">
                <div style="display: flex; flex-direction: column; margin-bottom: 20px;">
                  <div style="display: flex; align-items: center; margin-bottom: 8px;">
                    <div style="width: 36px; height: 36px; background: linear-gradient(135deg, #EF4444, #DC2626); border-radius: 12px; display: flex; align-items: center; justify-content: center;">
                      <span style="font-size: 28px; font-weight: 900; color: white;">!</span>
                    </div>
                    <h3 style="font-size: 28px; font-weight: 700; color: #EF4444; margin: 0 0 0 15px;">Risk Factors</h3><div style="font-size: 18px; color:#FFFFFF; margin-left: 71px; font-style: italic;">
                      Why it matters for execution
                    </div>
                  </div>
                  
                </div>

                <div style="flex: 1; display: flex; flex-direction: column; gap: 15px;">
                  <!-- Liquidity Risk -->
                  <div style="background: rgba(239,68,68,0.1); border-left: 4px solid #EF4444; padding: 15px; border-radius: 8px;">
                    <div style="font-size: 24px; font-weight: 600; color: #EF4444; margin-bottom: 8px;">Liquidity Risk</div>
                    <div style="font-size: 18px; color:#FFFFFF; line-height: 1.5;">
                      Lower trading volumes can cause slippage and difficulty exiting positions. Average daily volume: 100K-500K shares vs 10M+ for large caps. <strong style="color: #FCA5A5;">Wider Bid-Ask spreads increase entry/exit costs</strong>
                    </div>
                  </div>

                  <!-- Volatility Risk -->
                  <div style="background: rgba(239,68,68,0.1); border-left: 4px solid #EF4444; padding: 15px; border-radius: 8px;">
                    <div style="font-size: 24px; font-weight: 600; color: #EF4444; margin-bottom: 8px;">Volatility Risk</div>
                    <div style="font-size: 18px; color:#FFFFFF; line-height: 1.5;">
                      Higher beta (1.2-1.8) and larger price swings. Volatility typically 2-3x large cap averages.
                    </div>
                  </div>

                  <!-- Macro Sensitivity -->
                  <div style="background: rgba(239,68,68,0.1); border-left: 4px solid #EF4444; padding: 15px; border-radius: 8px;">
                    <div style="font-size: 24px; font-weight: 600; color: #EF4444; margin-bottom: 8px;">Macro Sensitivity</div>
                    <div style="font-size: 18px; color:#FFFFFF; line-height: 1.5;">
                      More vulnerable to economic cycles, interest rate changes, and funding environment shifts.
                    </div>
                  </div>

                  <!-- Risk Mitigation -->
                  <div style="margin-top: auto; padding: 15px; background: rgba(101,89,249,0.1); border: 1px solid rgba(101,89,249,0.3); border-radius: 8px;">
                    <div style="font-size: 24px; font-weight: 600; color: #6559F9; margin-bottom: 8px;">Risk Mitigation</div>
                    <div style="font-size: 18px; color: #E5E7EB; line-height: 1.5;">
                      <strong>Single position ≤ 5%</strong> | <strong>Stop-loss threshold ≈ -15%</strong> | <strong>Small-cap total exposure ≤ 20%</strong>
                    </div>
                    <div style="font-size: 18px; color:#FFFFFF; margin-top: 6px; font-style: italic;">
                      Position sizing and disciplined stop-losses limit downside while amplifying upside potential
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Footer note -->
            <div style="font-size: 16px; color: #64748B; text-align: center; margin-top: 20px; font-style: italic; text-align: right;">
              Data coverage: Last 5 years, Source: Public annual reports/brokerage statistics
            </div>
          </div>
        </div>
      </div>

      <!-- Slide 10: P10B OPEN & SERV Case Studies -->
      <div class="slide content-slide" id="slide10">
        <div class="safe-viewport">
          <div class="unified-slide">
            <h1 class="slide-title">Case Studies: OPEN & SERV</h1>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; height: 100%;">

              <!-- OPEN Case Study -->
              <div style="background: rgba(30,41,59,.9); border: 2px solid rgba(101,89,249,.3); border-radius: 16px; padding: 20px; display: flex; flex-direction: column;">
                <h3 style="font-size: 24px; font-weight: 700; color: #6559F9; margin-bottom: 15px;">OPEN: CEO Change Event</h3>

                <!-- Chart Area -->
                <div style="flex: 1; background: rgba(15,23,42,0.5); border: 1px solid rgba(101,89,249,0.2); border-radius: 12px; padding: 15px; margin-bottom: 15px;">
                  <canvas id="openChart" style="width: 100%; height: 100%;"></canvas>
                </div>

                <!-- Event Details -->
                <div style="background: rgba(101,89,249,0.1); border-radius: 8px; padding: 15px; margin-bottom: 15px;">
                  <div style="font-size: 24px; color: #E5E7EB; margin-bottom: 8px;">
                    <strong>Event:</strong> CEO Change Announcement | <strong>Impact:</strong> +45% gain
                  </div>
                  <div style="font-size: 20px; color:#FFFFFF;">
                    Event Date: 09/09/2025 | Entry: $6.09 | Exit: $8.89 | Holding Period: 2 days
                  </div>
                </div>

                <!-- Performance Summary -->
                <div style="background: rgba(16,185,129,0.1); border-radius: 8px; padding: 15px;">
                  <div style="font-size: 24px; font-weight: 600; color: #10B981; margin-bottom: 5px;">Trading Contribution</div>
                  <div style="font-size: 20px; color:#FFFFFF;">
                    P&L: $103,520.00 | ROI: 45.92% | Position Size: 37,000 shares
                  </div>
                </div>
              </div>

              <!-- SERV Case Study -->
              <div style="background: rgba(30,41,59,.9); border: 2px solid rgba(16,185,129,.3); border-radius: 16px; padding: 20px; display: flex; flex-direction: column;">
                <h3 style="font-size: 24px; font-weight: 700; color: #10B981; margin-bottom: 15px;">SERV: Range Trading Strategy</h3>

                <!-- Chart Area -->
                <div style="flex: 1; background: rgba(15,23,42,0.5); border: 1px solid rgba(16,185,129,0.2); border-radius: 12px; padding: 15px; margin-bottom: 15px;">
                  <canvas id="servChart" style="width: 100%; height: 100%;"></canvas>
                </div>

                <!-- Range Details -->
                <div style="background: rgba(16,185,129,0.1); border-radius: 8px; padding: 15px; margin-bottom: 15px;">
                  <div style="font-size: 24px; color: #E5E7EB; margin-bottom: 8px;">
                    <strong>Trading Range:</strong> $9.73  - $11.72  | <strong>Strategy:</strong> Buy low, sell high
                  </div>
                  <div style="font-size: 20px; color:#FFFFFF;">
                    Period: 09/02/2025 - 09/11/2025 | Multiple round trips
                  </div>
                </div>

                <!-- Performance Summary -->
                <div style="background: rgba(24Range Trading ResultsTotal P&L: $39620.00|Avg Trade: 198.10%|Win Rate: [RATE]%5,158,11,0.1); border-radius: 8px; padding: 15px;">
                  <div style="font-size: 24px; font-weight: 600; color: #F59E0B; margin-bottom: 5px;">Range Trading Results</div>
                  <div style="font-size: 20px; color:#FFFFFF;">
                    Total P&L: $39620.00|Avg Trade ROI: 20.35%
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

  
      
      <!-- Slide 11 -->
      <div class="slide content-slide" id="slide11">
        <div class="safe-viewport">
          <div class="content-wrapper center-abs">
            <div class="part-announcement">
              <div class="part-number">Part 4</div>
              <div class="part-title">Insurance Assets</div>
              <div class="speaker-info">Speaker: Zhang Ziming</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Slide 12: GLD/TLT Tactical Hedge -->
      <div class="slide content-slide" id="slide12">
        <div class="safe-viewport">
          <div class="unified-slide">
            <h1 class="slide-title">GLD/TLT Tactical Hedge & Returns</h1>



            <div class="performance-main-content grid-fig1">
              <!-- A：左上（Figure 2：GLD vs SPY 20年趋势） -->
              <section class="panel" style="grid-area: areaA;">
                <h3 style="font-size:30px; font-weight:800;">GLD vs SPY 20-Year Trend</h3>
                <div class="canvas-wrap" style="display: flex; justify-content: center; align-items: center; padding: 10px;">
                  <img src="./part4/gld_spy_20y_monthly_transparent.svg" 
                       alt="GLD vs SPY 20-Year Trend" 
                       style="width: 100%; height: auto; max-height: 100%; object-fit: contain;" />
                </div>
              </section>

              <!-- C：左下（Figure 3：日收盘走势） -->
              <section class="panel" style="grid-area: areaC;">
                <h3 style="font-size:30px; font-weight:800;">GLD & TLT Daily Close in September</h3>
                <div class="canvas-wrap" style="padding: 10px;">
                  <canvas id="figure3Chart" style="width: 120% !important; height: 100% !important;"></canvas>
                </div>
              </section>

              <!-- B：右侧大面板（交易表 + 小结） -->
              <section class="panel table" style="grid-area: areaB;">
                <h3 style="font-size:30px; font-weight:800; color:#10B981">Trade Blotter & P&amp;L (GLD &amp; TLT)</h3>
                <div class="canvas-wrap" style="padding:0;overflow:auto">
                  <table class="trade-table" id="gldTltBlotter">
                    <thead>
                      <tr>
                        <th>Asset</th><th>Date</th><th>Type</th>
                        <th style="text-align:right;">Qty</th>
                        <th style="text-align:right;">Price</th>
                        <th style="text-align:right;">Amount</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>GLD</td>
                        <td>09-04</td>
                        <td><span class="pill pill-buy">Buy</span></td>
                        <td style="text-align:right;">1,600</td>
                        <td style="text-align:right;">326.97</td>
                        <td style="text-align:right; color:#EF4444; font-weight:700;">-$523,152</td>
                      </tr>
                      <tr>
                        <td>TLT</td>
                        <td>09-04</td>
                        <td><span class="pill pill-buy">Buy</span></td>
                        <td style="text-align:right;">2,000</td>
                        <td style="text-align:right;">86.96</td>
                        <td style="text-align:right; color:#EF4444; font-weight:700;">-$173,920</td>
                      </tr>
                      <tr>
                        <td>GLD</td>
                        <td>09-04</td>
                        <td><span class="pill pill-sell">Sell</span></td>
                        <td style="text-align:right;">1,000</td>
                        <td style="text-align:right;">325.49</td>
                        <td style="text-align:right; color:#10B981; font-weight:700;">+$325,490</td>
                      </tr>
                      <tr>
                        <td>GLD</td>
                        <td>09-09</td>
                        <td><span class="pill pill-sell">Sell</span></td>
                        <td style="text-align:right;">300</td>
                        <td style="text-align:right;">334.92</td>
                        <td style="text-align:right; color:#10B981; font-weight:700;">+$100,476</td>
                      </tr>
                      <tr>
                        <td>TLT</td>
                        <td>09-09</td>
                        <td><span class="pill pill-sell">Sell</span></td>
                        <td style="text-align:right;">2,000</td>
                        <td style="text-align:right;">89.51</td>
                        <td style="text-align:right; color:#10B981; font-weight:700;">+$179,020</td>
                      </tr>
                      <tr>
                        <td>GLD</td>
                        <td>09-10</td>
                        <td><span class="pill pill-sell">Sell</span></td>
                        <td style="text-align:right;">300</td>
                        <td style="text-align:right;">335.94</td>
                        <td style="text-align:right; color:#10B981; font-weight:700;">+$100,782</td>
                      </tr>
                    </tbody>
                  </table>
                </div>

                <div class="summary-cards">
                  <div class="summary-card">
                    <h4>GLD Summary</h4>
                    <div>Invested: <span id="gldInvested">$523,152</span></div>
                    <div>Sold: <span id="gldSold">$526,748</span></div>
                    <div>P&amp;L: <span id="gldPnL">$3,596 (0.69%)</span></div>
                  </div>
                  <div class="summary-card">
                    <h4>TLT Summary</h4>
                    <div>Invested: <span id="tltInvested">$173,920</span></div>
                    <div>Sold: <span id="tltSold">$179,020</span></div>
                    <div>P&amp;L: <span id="tltPnL">$5,100 (2.93%)</span></div>
                  </div>
                </div>

                <!-- 组合汇总（保留你原来的三个数字） -->
                <div style="margin-top:10px;font-size:22px;color:#FFFFFF">
                  Combined Investment: <span id="totalInvested">$697,072</span> |
                  <span style="color:#10B981;font-weight:700">Combined P&amp;L: <span id="totalPnL">$8,696</span></span> |
                  ROI: <span id="totalRoi">1.25%</span>
                </div>
              </section>
            </div>
          </div>
        </div>
      </div>

      <!-- Slide 13 -->
      <div class="slide content-slide" id="slide13">
        <div class="safe-viewport">
          <div class="content-wrapper center-abs">
            <div class="part-announcement">
              <div class="part-number">Part 5</div>
              <div class="part-title">Digital Assets & Risk Management</div>
              <div class="speaker-info">Speaker: Wang Fengjiao</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Blank Slide 1 -->
      <div class="slide content-slide" id="slide14a">
        <div class="safe-viewport">
          <div class="unified-slide" style="padding-bottom: 80px;">
            <h1 class="slide-title" style="margin-bottom: 0.5rem;">Satellite Allocation Value of Crypto</h1>

            <div class="tournament-header" style="margin-bottom: 0.5rem;">
              <div class="tournament-period" style="font-size: 1.6rem; text-align: right; padding-right: 2rem;">— Return vs Risk Trade-off</div>
            </div>

            <div class="performance-main-content" style="margin-top: 0.5rem;">
              <!-- Left: Chart Area (70%) -->
              <div class="cumulative-returns-area" style="width: 70%; padding-right: 1rem;">
                <div class="returns-chart-title" style="font-size: 1.8rem;">Long-Term Return Leadership: 5-Year 80pp Gap</div>
                <div class="returns-subtitle" style="font-size: 1.2rem;">Cumulative Returns Comparison (%)</div>
                <div class="cumulative-chart-container" style="height: 260px; margin-bottom: 10px;">
                  <canvas id="cumulativeReturnsChart"></canvas>
                    </div>
                
                <!-- Portfolio Allocation Charts -->
                <div class="portfolio-allocation" style="display: flex; gap: 15px; align-items: center;">
                  <div class="unified-legend" style="width: 40%;">
                    <div class="legend-column">
                      <div class="legend-item" style="display: flex; align-items: center; margin-bottom: 6px;">
                        <div class="legend-color" style="width: 16px; height: 12px; background-color: #6559F9; margin-right: 6px;"></div>
                        <span class="legend-text" style="color: #E5E7EB; font-size: 0.85rem;">SPY (Large Cap)</span>
                    </div>
                      <div class="legend-item" style="display: flex; align-items: center; margin-bottom: 6px;">
                        <div class="legend-color" style="width: 16px; height: 12px; background-color: #8B5CF6; margin-right: 6px;"></div>
                        <span class="legend-text" style="color: #E5E7EB; font-size: 0.85rem;">IWM (Small Cap)</span>
                    </div>
                      <div class="legend-item" style="display: flex; align-items: center; margin-bottom: 6px;">
                        <div class="legend-color" style="width: 16px; height: 12px; background-color: #F59E0B; margin-right: 6px;"></div>
                        <span class="legend-text" style="color: #E5E7EB; font-size: 0.85rem;">GLD (Gold)</span>
                  </div>
                      <div class="legend-item" style="display: flex; align-items: center; margin-bottom: 6px;">
                        <div class="legend-color" style="width: 16px; height: 12px; background-color: #22C55E; margin-right: 6px;"></div>
                        <span class="legend-text" style="color: #E5E7EB; font-size: 0.85rem;">TLT (Bonds)</span>
                      </div>
                      <div class="legend-item" style="display: flex; align-items: center; margin-bottom: 6px;">
                        <div class="legend-color" style="width: 16px; height: 12px; background-color: #EF4444; margin-right: 6px;"></div>
                        <span class="legend-text" style="color: #E5E7EB; font-size: 0.85rem;">Crypto</span>
                      </div>
                </div>
              </div>

                  <!-- Charts on the right -->
                  <div class="allocation-charts-container" style="display: flex; gap: 12px; width: 60%;">
                    <div class="allocation-chart">
                      <div class="allocation-title" style="font-size: 0.9rem;">With Crypto Portfolio</div>
                      <div class="chart-wrapper-large">
                        <canvas id="cryptoAllocationChart"></canvas>
                    </div>
                    </div>
                    <div class="allocation-chart">
                      <div class="allocation-title" style="font-size: 0.9rem;">No Crypto Portfolio</div>
                      <div class="chart-wrapper-large">
                        <canvas id="noCryptoAllocationChart"></canvas>
                    </div>
                  </div>
                </div>
              </div>
                
                <!-- Chart Explanation -->
                <div class="chart-explanation" style="margin-top: 12px;">
                  <p class="explanation-text" style="color: #E5E7EB; font-size: 18px; line-height: 1.4;">
                    <strong>📈 Long-Term Return Leadership</strong><br>
                    • ~80pp 5-year total return gap, clear trend divergence since 2021<br>
                    • Long-term return resilience maintained despite 2022 short-term volatility
                  </p>
            </div>
          </div>

              <!-- Right: Key Metrics (30%) -->
              <div class="metrics-table-area" style="display: flex; flex-direction: column; height: 100%;">
                <div class="chart-title" style="font-size: 1.8rem; margin-bottom: 0.8rem;">Key Performance Metrics</div>
                <table class="metrics-table" style="font-size: 1rem; margin-bottom: 0.8rem;">
                  <thead>
                    <tr>
                      <th class="metric-header">Metric</th>
                      <th class="crypto-header">With Crypto</th>
                      <th class="no-crypto-header">No Crypto</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td class="metric-name">Volatility</td>
                      <td class="crypto-value">16.60%</td>
                      <td class="no-crypto-value">14.16%</td>
                    </tr>
                    <tr>
                      <td class="metric-name">Sharpe Ratio</td>
                      <td class="crypto-value">1.214</td>
                      <td class="no-crypto-value">0.846</td>
                    </tr>
                    <tr>
                      <td class="metric-name">Max Drawdown</td>
                      <td class="crypto-value">-29.00%</td>
                      <td class="no-crypto-value">-21.81%</td>
                    </tr>
                  </tbody>
                </table>
                
                <!-- Metrics Explanations -->
                <div class="metrics-explanations" style="margin-bottom: 0.8rem;">
                  <div class="metric-explanation" style="margin-bottom: 0.8rem;">
                    <p class="metric-explanation-text" style="font-size: 0.95rem; line-height: 1.5;">
                      <strong style="font-size: 1.2rem;">⚖️ Better Risk-Reward Ratio</strong><br>
                      Volatility up from 14.18% to 16.61%, but Sharpe Ratio +36.8% — 0.368 more return per unit of risk
                    </p>
                  </div>
                  <div class="metric-explanation">
                    <p class="metric-explanation-text" style="font-size: 0.95rem; line-height: 1.5;">
                      <strong style="font-size: 1.2rem;">⚠️ Reasonable Risk Cost</strong><br>
                      Max drawdown up 7.2pp (inevitable with crypto's high volatility); ~80% return gap makes short-term drawdown a "worthy trade-off"
                    </p>
                  </div>
                </div>
                
                <!-- Core Conclusion -->
                <div class="core-conclusion" style="margin-top: auto;">
                  <p class="conclusion-text" style="font-size: 1rem; line-height: 1.5; padding: 0.8rem;">
                    <strong style="font-size: 1.2rem;">🎯 Key Conclusion</strong><br>
                    Crypto's return gain far exceeds its risk increase, delivering better risk-adjusted returns
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Blank Slide 2 -->
      <div class="slide content-slide" id="slide14b">
        <div class="safe-viewport">
          <div class="unified-slide" style="padding-bottom: 80px;">
            <h1 class="slide-title" style="margin-bottom: 1rem;">Correlation Analysis: Crypto = Portfolio Diversifier</h1>
            
            <div class="diversification-main-content" style="display: flex; gap: 20px; margin-top: 0.8rem;">
              <!-- Left: Correlation Heatmap (40%) -->
              <div class="heatmap-area" style="width: 40%; background: rgba(30, 41, 59, 0.9); border: 2px solid rgba(101, 89, 249, 0.3); border-radius: 1.2rem; padding: 1.3rem;">
                <div class="chart-title" style="color: #6559F9; font-size: 1.5rem; font-weight: 700; margin-bottom: 0.8rem; text-align: center;">Asset Correlation Matrix Heatmap</div>
                <div class="heatmap-container" style="width: 420px; height: 420px; margin: 0 auto 0.8rem; background: rgba(15, 23, 42, 0.5); border: 1px solid rgba(101, 89, 249, 0.2); border-radius: 0.8rem; padding: 1rem;">
                  <canvas id="correlationHeatmap14b"></canvas>
                </div>
                
                <!-- Heatmap Legend -->
                <div class="heatmap-legend" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; font-size: 13px;">
                  <div class="scale-item" style="display: flex; align-items: center; gap: 6px;">
                    <div class="scale-color" style="width: 14px; height: 14px; background: #3B82F6; border-radius: 2px;"></div>
                    <span style="color: #E5E7EB; font-weight: 600;">Strong Negative</span>
                  </div>
                  <div class="scale-item" style="display: flex; align-items: center; gap: 6px;">
                    <div class="scale-color" style="width: 14px; height: 14px; background: #60A5FA; border-radius: 2px;"></div>
                    <span style="color: #E5E7EB; font-weight: 600;">Weak Negative</span>
                  </div>
                  <div class="scale-item" style="display: flex; align-items: center; gap: 6px;">
                    <div class="scale-color" style="width: 14px; height: 14px; background: #E5E7EB; border-radius: 2px;"></div>
                    <span style="color: #E5E7EB; font-weight: 600;">Near Zero</span>
                  </div>
                  <div class="scale-item" style="display: flex; align-items: center; gap: 6px;">
                    <div class="scale-color" style="width: 14px; height: 14px; background: #C084FC; border-radius: 2px;"></div>
                    <span style="color: #E5E7EB; font-weight: 600;">Weak Positive</span>
                  </div>
                  <div class="scale-item" style="display: flex; align-items: center; gap: 6px;">
                    <div class="scale-color" style="width: 14px; height: 14px; background: #8B5CF6; border-radius: 2px;"></div>
                    <span style="color: #E5E7EB; font-weight: 600;">Moderate Positive</span>
                  </div>
                  <div class="scale-item" style="display: flex; align-items: center; gap: 6px;">
                    <div class="scale-color" style="width: 14px; height: 14px; background: #6559F9; border-radius: 2px;"></div>
                    <span style="color: #E5E7EB; font-weight: 600;">Strong Positive</span>
                  </div>
                </div>
              </div>

              <!-- Right: Analysis Summary (60%) -->
              <div class="correlation-analysis-area" style="width: 60%; background: rgba(30, 41, 59, 0.9); border: 2px solid rgba(101, 89, 249, 0.3); border-radius: 1.2rem; padding: 1.3rem;">
                <div class="chart-title" style="color: #6559F9; font-size: 1.5rem; font-weight: 700; margin-bottom: 0.8rem; text-align: center;">Key Insights</div>
                
                <div class="correlation-insights" style="display: flex; flex-direction: column; gap: 0.9rem;">
                  <div class="insight-section" style="background: rgba(101, 89, 249, 0.1); border-left: 4px solid #6559F9; padding: 0.9rem; border-radius: 0.5rem;">
                    <h4 class="insight-title" style="color: #6559F9; font-size: 1.3rem; font-weight: 700; margin-bottom: 0.6rem;">🔄 Crypto vs. Traditional Assets: Near-Zero Correlation = "Diversification Powerhouse"</h4>
                    <ul class="insight-list" style="color: #E5E7EB; font-size: 0.85rem; line-height: 1.5; margin: 0; padding-left: 1.2rem;">
                      <li style="margin-bottom: 0.5rem;"><strong style="color: #22C55E;">🟢 vs. Equities (SPY/IWM):</strong> ~-0.01 to 0.03 (near-zero)<br>→ vs. SPY-IWM (0.834)→ Solves "lockstep" pain</li>
                      <li style="margin-bottom: 0.5rem;"><strong style="color: #22C55E;">🟢 vs. Gold (GLD):</strong> ~-0.04 (slight negative)<br>→ Independent inflation hedge</li>
                      <li style="margin-bottom: 0;"><strong style="color: #22C55E;">🟢 vs. Bonds (SHY):</strong> ~-0.03 (low negative)<br>→ Softens bond volatility (e.g., 2023 dip: crypto steady)</li>
                    </ul>
                  </div>

                  <div class="insight-section" style="background: rgba(245, 158, 11, 0.1); border-left: 4px solid #F59E0B; padding: 0.9rem; border-radius: 0.5rem;">
                    <h4 class="insight-title" style="color: #F59E0B; font-size: 1.3rem; font-weight: 700; margin-bottom: 0.6rem;">🔗 Intra-Crypto Correlation: Choose Right Coins to Cut Risk</h4>
                    <ul class="insight-list" style="color: #E5E7EB; font-size: 0.85rem; line-height: 1.5; margin: 0; padding-left: 1.2rem;">
                      <li style="margin-bottom: 0.5rem;"><strong style="color: #F59E0B;">🟡 BTC ↔ ETH (0.80):</strong> High correlation → Allocate less (avoid over-concentration)</li>
                      <li style="margin-bottom: 0.5rem;"><strong style="color: #22C55E;">🟢 BTC ↔ SOL (0.57):</strong> Moderate correlation → Allocate more (best diversification)</li>
                      <li style="margin-bottom: 0;"><strong style="color: #F59E0B;">🟡 ETH ↔ SOL (0.63):</strong> Moderate correlation → Balance with BTC</li>
                    </ul>
                  </div>

                  <div class="insight-section" style="background: rgba(34, 197, 94, 0.1); border-left: 4px solid #22C55E; padding: 0.9rem; border-radius: 0.5rem;">
                    <h4 class="insight-title" style="color: #22C55E; font-size: 1.3rem; font-weight: 700; margin-bottom: 0.6rem;">🎯 Key Insight: Adding crypto cuts overall portfolio volatility</h4>
                    <div style="color: #E5E7EB; font-size: 1rem; line-height: 1.5;">
                      Near-zero correlation (SPY: -0.01, GLD: -0.04) →10% crypto allocation: ~15% volatility cut (vs. all-traditional portfolios) ➡️ Steady long-term returns
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Blank Slide 3 -->
      <div class="slide content-slide" id="slide14c">
        <div class="safe-viewport">
          <div class="unified-slide" style="padding-bottom: 80px;">
            <h1 class="slide-title" style="margin-bottom: 1rem;">Trading Analysis: SOL's Core Trading Logic</h1>
            
            <!-- Main Content Layout -->
            <div class="trading-main-content" style="display: flex; gap: 22px; margin-top: 0.4rem;">
              <!-- Left: Trading Chart Area (60%) -->
              <div class="trading-chart-area" style="width: 50%; background: rgba(30, 41, 59, 0.9); border: 2px solid rgba(101, 89, 249, 0.3); border-radius: 1.2rem; padding: 1.2rem;">
                <div class="chart-title" style="color: #6559F9; font-size: 18px; font-weight: 700; margin-bottom: 0.8rem; text-align: center;">September 2025 Complete Trading Analysis</div>
                <div class="trading-chart-container" style="height: 280px; margin-bottom: 0.6rem; background: rgba(15, 23, 42, 0.5); border: 1px solid rgba(101, 89, 249, 0.2); border-radius: 0.8rem; padding: 1rem;">
                  <canvas id="tradingAnalysisChart14c"></canvas>
                </div>
                
                
                <!-- Chart Explanation -->
                <div class="chart-explanation" style="background: rgba(101, 89, 249, 0.1); border-left: 4px solid #6559F9; padding: 0.9rem; border-radius: 0.5rem;">
                  <p class="explanation-text" style="color: #E5E7EB; font-size: 1.2rem; line-height: 1.5; margin: 0;">
                    <strong style="color: #6559F9;">📊 Current Portfolio Approach & Future Enhancement</strong><br>
                    Given our current experience level, crypto serves primarily as a strategic asset allocation component rather than active trading positions. While our September analysis demonstrates tactical awareness, we recognize the complexity of crypto timing requires deeper expertise.<br><br>
                    <strong style="color: #6559F9;">🚀 Future Development</strong><br>
                    We plan to introduce more sophisticated timing models and enhanced analytical frameworks to create superior value for our fund holders through improved entry/exit strategies and risk management protocols.
                  </p>
                </div>
              </div>

              <!-- Right: Trading Strategy Analysis (36%) -->
              <div class="trading-insights-area" style="width: 50%; background: rgba(30, 41, 59, 0.9); border: 2px solid rgba(101, 89, 249, 0.3); border-radius: 1.2rem; padding: 1.2rem;">
                <div class="chart-title" style="color: #6559F9; font-size: 1.7rem; font-weight: 700; margin-bottom: 0.8rem; text-align: center;">Key Insights</div>
                
                <div class="trading-insights" style="display: flex; flex-direction: column; gap: 0.9rem;">
                  <div class="insight-section" style="background: rgba(101, 89, 249, 0.1); border-left: 4px solid #6559F9; padding: 0.9rem; border-radius: 0.5rem;">
                    <h4 class="insight-title" style="color: #6559F9; font-size: 1.5rem; font-weight: 700; margin-bottom: 0.6rem;">🎯 Why Double Down on SOL?</h4>
                    <ul class="insight-list" style="color: #E5E7EB; font-size: 0.85rem; line-height: 1.5; margin: 0; padding-left: 1.2rem;">
                      <li style="margin-bottom: 0.5rem;"><strong style="color: #6559F9;">📊 ETF Approval Catalyst:</strong> SOL expected as 3rd-largest crypto ETF in Oct 2025</li>
                      <li style="margin-bottom: 0.5rem;"><strong style="color: #6559F9;">🔄 Superior Correlation Edge:</strong> SOL-SPY correlation ~0.32 vs BTC (0.366) & ETH (0.383)</li>
                      <li style="margin-bottom: 0;"><strong style="color: #6559F9;">🏛️ Smart Money Signal:</strong> Multiple DAT firms signaled large SOL buy orders in Sept</li>
                    </ul>
                  </div>

                  <div class="insight-section" style="background: rgba(245, 158, 11, 0.1); border-left: 4px solid #F59E0B; padding: 0.9rem; border-radius: 0.5rem;">
                    <h4 class="insight-title" style="color: #F59E0B; font-size: 1.5rem; font-weight: 700; margin-bottom: 0.6rem;">⚡ Tactical September Moves</h4>
                    <ul class="insight-list" style="color: #E5E7EB; font-size: 0.85rem; line-height: 1.5; margin: 0; padding-left: 1.2rem;">
                      <li style="margin-bottom: 0.5rem;"><strong style="color: #F59E0B;">Sep 5-16:</strong> Dip buying during Sept 9-22 correction → Lower average entry cost</li>
                      <li style="margin-bottom: 0;"><strong style="color: #F59E0B;">Sep 18:</strong> Partial profit-taking on rebound → Locked gains, kept core position</li>
                    </ul>
                  </div>

                  <div class="insight-section" style="background: rgba(34, 197, 94, 0.1); border-left: 4px solid #22C55E; padding: 0.9rem; border-radius: 0.5rem;">
                    <h4 class="insight-title" style="color: #22C55E; font-size: 1.5rem; font-weight: 700; margin-bottom: 0.6rem;">🛡️ Hedging Discipline & Long-term View</h4>
                    <ul class="insight-list" style="color: #E5E7EB; font-size: 0.85rem; line-height: 1.5; margin: 0; padding-left: 1.2rem;">
                      <li style="margin-bottom: 0.5rem;"><strong style="color: #22C55E;">September Reality:</strong> Crypto underperformed SPY (normal short-term divergence)</li>
                      <li style="margin-bottom: 0.5rem;"><strong style="color: #22C55E;">5-Year Perspective:</strong> Correlation data proves long-term diversification value</li>
                      <li style="margin-bottom: 0;"><strong style="color: #22C55E;">Strategic Hold:</strong> Short-term divergence ≠ abandon structural hedge protection</li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Blank Slide 4 -->
      <div class="slide content-slide" id="slide14d">
        <div class="safe-viewport">
          <div class="unified-slide" style="padding-bottom: 80px;">
            <h1 class="slide-title" style="margin-bottom: 0.5rem;">Asset-Specific Risk Management: Target Core</h1>
            
            <!-- Subtitle and Core Logic -->
            <div class="tournament-header" style="margin-bottom: 0.8rem; margin-top: 0.3rem;">
              <div class="tournament-period" style="font-size: 1.8rem; text-align: center; color: #6559F9; font-weight: 700; margin-bottom: 0.4rem;">Differentiated Control by Risk Attributes, Not Single Index Backtesting</div>
              <div class="performance-summary" style="font-size: 1.4rem; text-align: center; color: #E5E7EB;">
                Risk Management ≠ "One Size Fits All" → Focus on High-Risk Assets (Stocks/Crypto), Relax for Hedge Assets (Bonds/Gold)
              </div>
            </div>

            <!-- Three-Column Asset Risk Management -->
            <div class="asset-risk-columns" style="display: flex; gap: 18px; margin-bottom: 0.8rem;">
              <!-- Column 1: Stock Risk Management -->
              <div class="risk-column" style="flex: 1; background: rgba(30, 41, 59, 0.9); border: 2px solid rgba(101, 89, 249, 0.3); border-radius: 0.8rem; padding: 1.1rem;">
                <div class="column-header" style="text-align: center; margin-bottom: 0.8rem;">
                  <div style="font-size: 2rem; margin-bottom: 0.3rem;">📈</div>
                  <div class="column-title" style="color: #6559F9; font-size: 1.6rem; font-weight: 700;">Core Risk Source — Equities</div>
                  <div class="column-subtitle" style="color:#FFFFFF; font-size: 1.2rem; margin-top: 0.2rem;">(Focus: Small Cap IWM)</div>
                </div>
                
                <div class="risk-details" style="display: flex; flex-direction: column; gap: 0.7rem;">
                  <div class="risk-item" style="background: rgba(15, 23, 42, 0.5); border-radius: 0.4rem; padding: 0.7rem;">
                    <div class="risk-label" style="color: #E5E7EB; font-weight: 700; font-size: 1.4rem; margin-bottom: 0.3rem;">Risk Target:</div>
                    <div class="risk-content" style="color:#FFFFFF; font-size: 1.2rem; line-height: 1.3;">Equities (Focus Small Cap IWM)</div>
                  </div>
                  
                  <div class="risk-item" style="background: rgba(15, 23, 42, 0.5); border-radius: 0.4rem; padding: 0.7rem;">
                    <div class="risk-label" style="color: #E5E7EB; font-weight: 700; font-size: 1.4rem; margin-bottom: 0.3rem;">Backtest Method:</div>
                    <div class="risk-content" style="color:#FFFFFF; font-size: 1.2rem; line-height: 1.3;">IWM Index + Core Holdings Vol Average<br>
                    → IWM -5% → Holdings avg -6.2%<br>
                    → Set "≥6% loss triggers stop-loss"</div>
                  </div>
                  
                  <div class="risk-item" style="background: rgba(15, 23, 42, 0.5); border-radius: 0.4rem; padding: 0.7rem;">
                    <div class="risk-label" style="color: #E5E7EB; font-weight: 700; font-size: 1.4rem; margin-bottom: 0.3rem;">Control Measures:</div>
                    <div class="risk-content" style="color:#FFFFFF; font-size: 1.2rem; line-height: 1.3;">1. Single stock ≤5% portfolio<br>
                    2. Small cap total ≤20%<br>
                    3. 6% trigger: -50% position, clear if no rebound</div>
                  </div>
                </div>
                
                <div class="risk-status" style="margin-top: 0.8rem; text-align: center;">
                  <div class="status-indicator" style="display: inline-block; background: rgba(34, 197, 94, 0.2); color: #22C55E; padding: 0.4rem 0.9rem; border-radius: 1.2rem; font-size: 1.4rem; font-weight: 600;">Actively Controlled</div>
                </div>
              </div>

              <!-- Column 2: Crypto Risk Management -->
              <div class="risk-column" style="flex: 1; background: rgba(30, 41, 59, 0.9); border: 2px solid rgba(239, 68, 68, 0.3); border-radius: 0.8rem; padding: 1.1rem;">
                <div class="column-header" style="text-align: center; margin-bottom: 0.8rem;">
                  <div style="font-size: 2rem; margin-bottom: 0.3rem;">🔹</div>
                  <div class="column-title" style="color: #EF4444; font-size: 1.6rem; font-weight: 700;">Core Risk Source — Crypto</div>
                  <div class="column-subtitle" style="color:#FFFFFF; font-size: 1.2rem; margin-top: 0.2rem;">(SOL/BTC/ETH)</div>
                </div>
                
                <div class="risk-details" style="display: flex; flex-direction: column; gap: 0.7rem;">
                  <div class="risk-item" style="background: rgba(15, 23, 42, 0.5); border-radius: 0.4rem; padding: 0.7rem;">
                    <div class="risk-label" style="color: #E5E7EB; font-weight: 700; font-size: 1.4rem; margin-bottom: 0.3rem;">Risk Target:</div>
                    <div class="risk-content" style="color:#FFFFFF; font-size: 1.2rem; line-height: 1.3;">Crypto (SOL/BTC/ETH)</div>
                  </div>
                  
                  <div class="risk-item" style="background: rgba(15, 23, 42, 0.5); border-radius: 0.4rem; padding: 0.7rem;">
                    <div class="risk-label" style="color: #E5E7EB; font-weight: 700; font-size: 1.4rem; margin-bottom: 0.3rem;">Backtest Method:</div>
                    <div class="risk-content" style="color:#FFFFFF; font-size: 1.2rem; line-height: 1.3;">CRIX Index + Individual Vol<br>
                    → CRIX -4% → SOL avg -5.8%<br>
                    → Set "≥8% pause, ≥10% stop 30%"</div>
                  </div>
                  
                  <div class="risk-item" style="background: rgba(15, 23, 42, 0.5); border-radius: 0.4rem; padding: 0.7rem;">
                    <div class="risk-label" style="color: #E5E7EB; font-weight: 700; font-size: 1.4rem; margin-bottom: 0.3rem;">Control Measures:</div>
                    <div class="risk-content" style="color:#FFFFFF; font-size: 1.2rem; line-height: 1.3;">1. Single crypto ≤8% portfolio<br>
                    2. Total crypto ≤15%<br>
                    3. Monitor SOL-ETH-BTC corr>0.6→reduce high-vol</div>
                  </div>
                </div>
                
                <div class="risk-status" style="margin-top: 0.8rem; text-align: center;">
                  <div class="status-indicator" style="display: inline-block; background: rgba(245, 158, 11, 0.2); color: #F59E0B; padding: 0.4rem 0.9rem; border-radius: 1.2rem; font-size: 1.4rem; font-weight: 600;">Strictly Monitored</div>
                </div>
              </div>

              <!-- Column 3: Low-Risk Assets Management -->
              <div class="risk-column" style="flex: 1; background: rgba(30, 41, 59, 0.9); border: 2px solid rgba(34, 197, 94, 0.3); border-radius: 0.8rem; padding: 1.1rem;">
                <div class="column-header" style="text-align: center; margin-bottom: 0.8rem;">
                  <div style="font-size: 2rem; margin-bottom: 0.3rem;">🛡️</div>
                  <div class="column-title" style="color: #22C55E; font-size: 1.6rem; font-weight: 700;">Hedge Tools — Low Risk Assets</div>
                  <div class="column-subtitle" style="color:#FFFFFF; font-size: 1.2rem; margin-top: 0.2rem;">(Bonds/Gold)</div>
                </div>
                
                <div class="risk-details" style="display: flex; flex-direction: column; gap: 0.7rem;">
                  <div class="risk-item" style="background: rgba(15, 23, 42, 0.5); border-radius: 0.4rem; padding: 0.7rem;">
                    <div class="risk-label" style="color: #E5E7EB; font-weight: 700; font-size: 1.4rem; margin-bottom: 0.3rem;">Risk Target:</div>
                    <div class="risk-content" style="color:#FFFFFF; font-size: 1.2rem; line-height: 1.3;">Bonds (SHY), Gold (GLD)</div>
                  </div>
                  
                  <div class="risk-item" style="background: rgba(15, 23, 42, 0.5); border-radius: 0.4rem; padding: 0.7rem;">
                    <div class="risk-label" style="color: #E5E7EB; font-weight: 700; font-size: 1.4rem; margin-bottom: 0.3rem;">Logic:</div>
                    <div class="risk-content" style="color:#FFFFFF; font-size: 1.2rem; line-height: 1.3;">Hedge tools by nature, low risk<br>
                    → No strict stop-loss needed<br>
                    → Focus on liquidity buffer</div>
                  </div>
                  
                  <div class="risk-item" style="background: rgba(15, 23, 42, 0.5); border-radius: 0.4rem; padding: 0.7rem;">
                    <div class="risk-label" style="color: #E5E7EB; font-weight: 700; font-size: 1.4rem; margin-bottom: 0.3rem;">Control Measures:</div>
                    <div class="risk-content" style="color:#FFFFFF; font-size: 1.2rem; line-height: 1.3;">1. Bonds + Gold total ≥20% (liquidity)<br>
                    2. Only adjust when bond vol ≥2% or gold ≥3%<br>
                    3. Rebalance, not stop-loss</div>
                  </div>
                </div>
                
                <div class="risk-status" style="margin-top: 0.8rem; text-align: center;">
                  <div class="status-indicator" style="display: inline-block; background: rgba(107, 114, 128, 0.2); color: #9CA3AF; padding: 0.4rem 0.9rem; border-radius: 1.2rem; font-size: 1.4rem; font-weight: 600;">Stable Buffer</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>    

      <!-- Slide 15 -->
      <div class="slide content-slide" id="slide15">
        <div class="safe-viewport">
          <div class="content-wrapper center-abs">
            <div class="part-announcement">
              <div class="part-number">Part 6</div>
              <div class="part-title">True Drivers & Lessons Learned</div>
              <div class="speaker-info">Speaker: Yao Yao</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Slide 16: True Drivers & Lessons Learned -->
      <div class="slide content-slide" id="slide16">
        <div class="safe-viewport">
          <div class="unified-slide">
            <h1 class="slide-title">True Drivers & Lessons Learned</h1>


            <div class="performance-main-content" style="display: grid; grid-template-columns: 1fr 1fr; grid-template-rows: 1fr 1fr 1fr auto; gap: 24px; height: 100%;">
              <!-- 左上：Pareto Chart -->
              <div class="chart-area" style="grid-column: 1; grid-row: 1 / 4;">
                <div class="chart-title" style="font-size:28px; font-weight:800;">Trade-Level P&L Analysis & Pareto Distribution</div>
                <div class="chart-container" style="padding: 20px; height: 420px; min-height: 420px;">
                  <canvas id="paretoChart" style="width: 100%; height: 100%; display:block;"></canvas>
                </div>
              </div>

              <!-- 右上：Top Contributors -->
              <div class="insight-card" style="grid-column: 2; grid-row: 1; background: rgba(16,185,129,0.1); border-left: 4px solid #10B981; border-radius: 8px; padding: 20px; display: flex; flex-direction: column;">
                <h3 style="font-size: 28px; font-weight: 700; color: #10B981; margin: 0 0 12px 0;">Top Contributors</h3>
                <div style="font-size: 20px; color: #E5E7EB; margin-bottom: 8px; display: flex; justify-content: space-between;">
                  <span>OPEN Position</span>
                  <span style="color: #10B981; font-weight: 600;">+$103,520 (59%)</span>
                </div>
                <div style="font-size: 20px; color: #E5E7EB; margin-bottom: 8px; display: flex; justify-content: space-between;">
                  <span>SERV Range Trading</span>
                  <span style="color: #10B981; font-weight: 600;">+$39,620 (23%)</span>
                </div>
                <div style="font-size: 20px; color: #E5E7EB; display: flex; justify-content: space-between;">
                  <span>AAPL Event</span>
                  <span style="color: #10B981; font-weight: 600;">+$33,390 (19%)</span>
                </div>
              </div>

              <!-- 右中：Lessons Learned -->
              <div class="insight-card" style="grid-column: 2; grid-row: 2; background: rgba(245,158,11,0.1); border-left: 4px solid #F59E0B; border-radius: 8px; padding: 20px; display: flex; flex-direction: column;">
                <h3 style="font-size: 28px; font-weight: 700; color: #F59E0B; margin: 0 0 12px 0;">Lessons Learned</h3>
                <div style="font-size: 20px; color: #E5E7EB; margin-bottom: 8px;">• Concentration amplifies gains & losses</div>
                <div style="font-size: 20px; color: #E5E7EB; margin-bottom: 8px;">• Event-driven strategies need precise timing</div>
                <div style="font-size: 20px; color: #E5E7EB;">• Risk management discipline is crucial</div>
              </div>

              <!-- 右下：Strategy Evolution -->
              <div class="insight-card" style="grid-column: 2; grid-row: 3; background: rgba(168,85,247,0.1); border-left: 4px solid #A855F7; border-radius: 8px; padding: 20px; display: flex; flex-direction: column;">
                <h3 style="font-size: 28px; font-weight: 700; color: #A855F7; margin: 0 0 12px 0;">Strategy Evolution</h3>
                <div style="font-size: 20px; color: #E5E7EB; margin-bottom: 8px;">• From ad-hoc to systematic approach</div>
                <div style="font-size: 20px; color: #E5E7EB; margin-bottom: 8px;">• Improved position sizing & timing</div>
                <div style="font-size: 20px; color: #10B981;">• Enhanced stop-loss discipline</div>
              </div>

              <!-- 底部横跨两列：Future Focus -->
              <div class="insight-card" style="background: rgba(101,89,249,0.1); border-left: 4px solid #6559F9; border-radius: 8px; padding: 20px; grid-column: 1 / 3; grid-row: 4; display: flex; justify-content: space-between; align-items: center;">
                <div>
                  <h3 style="font-size: 30px; font-weight: 700; color: #6559F9; margin: 0 0 12px 0;">Future Focus</h3>
                  <div style="display: flex; gap: 32px;">
                    <div style="font-size: 22px; color: #E5E7EB;">• Scale event-driven strategies with risk controls</div>
                    <div style="font-size: 22px; color: #10B981;">• Improve systematic research process</div>
                    <div style="font-size: 22px; color: #10B981;">• Diversify concentrated wins</div>
                  </div>
                </div>
                <div style="font-size: 40px; font-weight: 800; color: #6559F9;">80/20 Rule</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Slide 17 -->
      <div class="slide content-slide" id="slide17">
        <div class="safe-viewport">
          <div class="content-wrapper center-abs">
            <div class="part-announcement">
              <div class="part-number">Part 7</div>
              <div class="part-title">EMH Reflection & Team Takeaways</div>
              <div class="speaker-info">Speaker: Song Yuhan</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Slide 18: EMH Reflection & Team Takeaways -->
      <div class="slide content-slide" id="slide18">
        <div class="safe-viewport">
          <div class="unified-slide">
            <h1 class="slide-title">EMH Reflection & Team Takeaways</h1>

            <div class="performance-main-content" style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px; align-items: start;">
              <!-- Left Column: EMH Analysis -->
              <div style="background: rgba(15,23,42,0.5); border: 1px solid rgba(101,89,249,0.2); border-radius: 12px; padding: 24px; display: flex; flex-direction: column; gap: 20px; height: 100%;">
                <div style="font-size: 28px; font-weight: 700; color: #6559F9; margin-bottom: 8px; text-align: center;">Efficient Market Hypothesis Three-Level Analysis</div>
                
                <div style="background: rgba(101,89,249,0.1); border-left: 4px solid #6559F9; padding: 18px; border-radius: 8px;">
                  <div style="font-size: 24px; font-weight: 700; color: #6559F9; margin-bottom: 12px;">Weak Form EMH</div>
                  <div style="font-size: 20px; color: #E5E7EB; margin-bottom: 8px;">• Historical price patterns provide predictive value</div>
                  <div style="font-size: 20px; color: #E5E7EB; margin-bottom: 8px;">• AAPL event pattern consistency challenges randomness</div>
                  <div style="font-size: 20px; color: #E5E7EB; margin-bottom: 8px;">• Technical analysis yields positive alpha</div>
                  <div style="font-size: 20px; color: #10B981;">Case: Historical post-event recovery patterns</div>
                </div>

                <div style="background: rgba(16,185,129,0.1); border-left: 4px solid #10B981; padding: 18px; border-radius: 8px;">
                  <div style="font-size: 24px; font-weight: 700; color: #10B981; margin-bottom: 12px;">Semi-Strong Form EMH</div>
                  <div style="font-size: 20px; color: #E5E7EB; margin-bottom: 8px;">• Information dissemination creates temporary mispricing</div>
                  <div style="font-size: 20px; color: #E5E7EB; margin-bottom: 8px;">• OPEN CEO change overreaction (+80% gain)</div>
                  <div style="font-size: 20px; color: #E5E7EB; margin-bottom: 8px;">• Market adjustment period creates arbitrage opportunities</div>
                  <div style="font-size: 20px; color: #10B981;">Case: CEO change event overreaction</div>
                </div>

                <div style="background: rgba(245,158,11,0.1); border-left: 4px solid #F59E0B; padding: 18px; border-radius: 8px;">
                  <div style="font-size: 24px; font-weight: 700; color: #F59E0B; margin-bottom: 12px;">Strong Form EMH</div>
                  <div style="font-size: 20px; color: #E5E7EB; margin-bottom: 8px;">• All public information instantly priced in</div>
                  <div style="font-size: 20px; color: #E5E7EB; margin-bottom: 8px;">• Limited opportunities for consistent alpha</div>
                  <div style="font-size: 20px; color: #E5E7EB; margin-bottom: 8px;">• Our strategy suggests selective inefficiencies</div>
                  <div style="font-size: 20px; color: #10B981;">Reality: Market not perfectly efficient</div>
                </div>
              </div>

              <!-- Right Column: Team Insights -->
              <div style="background: rgba(15,23,42,0.5); border: 1px solid rgba(101,89,249,0.2); border-radius: 12px; padding: 24px; display: flex; flex-direction: column; gap: 20px; height: 100%;">
                <div style="font-size: 28px; font-weight: 700; color: #6559F9; margin-bottom: 8px; text-align: center;">Team Structure & Collaboration Insights</div>
                
                <div style="background: rgba(168,85,247,0.1); border-left: 4px solid #A855F7; padding: 18px; border-radius: 8px;">
                  <div style="font-size: 24px; font-weight: 700; color: #A855F7; margin-bottom: 12px;">Team Responsibilities</div>
                  <div style="font-size: 20px; color: #E5E7EB; margin-bottom: 6px;">• Research: Deep-dive analysis & opportunity identification</div>
                  <div style="font-size: 20px; color: #E5E7EB; margin-bottom: 6px;">• Execution: Trade timing & position management</div>
                  <div style="font-size: 20px; color: #E5E7EB; margin-bottom: 6px;">• Risk Management: Portfolio protection & controls</div>
                  <div style="font-size: 20px; color: #E5E7EB;">• Analysis: Performance attribution & strategy evolution</div>
                </div>

                <div style="background: rgba(101,89,249,0.1); border-left: 4px solid #6559F9; padding: 18px; border-radius: 8px;">
                  <div style="font-size: 24px; font-weight: 700; color: #6559F9; margin-bottom: 12px;">Key Learnings</div>
                  <div style="font-size: 20px; color: #E5E7EB; margin-bottom: 8px;">• Complementary skills enhance team capabilities</div>
                  <div style="font-size: 20px; color: #E5E7EB; margin-bottom: 8px;">• Systematic approach beats individual brilliance</div>
                  <div style="font-size: 20px; color: #E5E7EB;">• Continuous learning and adaptation essential</div>
                </div>

                <div style="background: rgba(16,185,129,0.1); border-left: 4px solid #10B981; padding: 18px; border-radius: 8px;">
                  <div style="font-size: 24px; font-weight: 700; color: #10B981; margin-bottom: 12px;">Professional Development</div>
                  <div style="font-size: 20px; color: #E5E7EB; margin-bottom: 8px;">• Trading tournament as real-world training ground</div>
                  <div style="font-size: 20px; color: #E5E7EB; margin-bottom: 8px;">• Portfolio management skills development</div>
                  <div style="font-size: 20px; color: #10B981;">• Risk management and discipline cultivation</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Slide 19: Ending Pages Divider (optional, could be removed) -->
      <div class="slide content-slide" id="slide19">
        <div class="safe-viewport">
          <div class="content-wrapper center-abs">
            <div class="part-announcement">
              <div class="part-number">Ending</div>
              <div class="part-title">Q & A</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Slide 20: Q&A with QR -->
      <div class="slide content-slide" id="slide20">
        <div class="safe-viewport">
          <div class="unified-slide" style="display:flex; flex-direction:column; justify-content:center; align-items:center; gap:32px;">
            <div style="font-size:120px; font-weight:800; color:#6559F9; letter-spacing:2px;">Q & A</div>
            <img src="qrcode.png" alt="QR Code" style="width:400px; height:400px; border-radius:12px; background:#fff; padding:12px; box-shadow: 0 8px 24px rgba(101,89,249,0.3);" onerror="this.style.display='none'" />
          </div>
        </div>
      </div>

      <!-- Slide 21: Thank You with Logo & QR -->
      <div class="slide content-slide" id="slide21">
        <div class="safe-viewport">
          <div class="unified-slide" style="display:flex; flex-direction:column; justify-content:center; align-items:center; gap:48px;">
            <div style="font-size:120px; font-weight:900; color:#E5E7EB;">Thank You</div>
            <div style="display:flex; align-items:center; justify-content:center; gap:60px;">
              <img src="logo.png" alt="HKU Coin Logo" style="max-width:500px; height:auto;" onerror="this.style.display='none'" />
              <img src="qrcode.png" alt="QR Code" style="width:240px; height:240px; border-radius:12px; background:#fff; padding:12px; box-shadow: 0 8px 24px rgba(101,89,249,0.3);" onerror="this.style.display='none'" />
            </div>
          </div>
        </div>
      </div>

  
      <div class="navigation">
        <button class="nav-btn" id="prevBtn" onclick="changeSlide(-1)" disabled>← Previous</button>
        <button class="nav-btn" id="nextBtn" onclick="changeSlide(1)">Next →</button>
      </div>

      <div class="slide-indicator">
        <div class="indicator active" onclick="goToSlide(1)"></div>
        <div class="indicator" onclick="goToSlide(2)"></div>
        <div class="indicator" onclick="goToSlide(3)"></div>
        <div class="indicator" onclick="goToSlide(4)"></div>
        <div class="indicator" onclick="goToSlide(5)"></div>
        <div class="indicator" onclick="goToSlide(6)"></div>
        <div class="indicator" onclick="goToSlide(7)"></div>
        <div class="indicator" onclick="goToSlide(8)"></div>
        <div class="indicator" onclick="goToSlide(9)"></div>
        <div class="indicator" onclick="goToSlide(10)"></div>
        <div class="indicator" onclick="goToSlide(11)"></div>
        <div class="indicator" onclick="goToSlide(12)"></div>
        <div class="indicator" onclick="goToSlide(13)"></div>
        <div class="indicator" onclick="goToSlide(14)"></div>
        <div class="indicator" onclick="goToSlide(15)"></div>
        <div class="indicator" onclick="goToSlide(16)"></div>
        <div class="indicator" onclick="goToSlide(17)"></div>
        <div class="indicator" onclick="goToSlide(19)"></div>
        <div class="indicator" onclick="goToSlide(20)"></div>
        <div class="indicator" onclick="goToSlide(21)"></div>
        <div class="indicator" onclick="goToSlide(22)"></div>
        <div class="indicator" onclick="goToSlide(23)"></div>
        <div class="indicator" onclick="goToSlide(24)"></div>
      </div>

      <div class="navigation">
        <button class="nav-btn" id="prevBtn" onclick="changeSlide(-1)" disabled>← Previous</button>
        <button class="nav-btn" id="nextBtn" onclick="changeSlide(1)">Next →</button>
      </div>

      </div>
  </div>

  <script>
    // ========== Slide16 Pareto Chart ========== //
    function initParetoFromCSV(){
      const canvas = document.getElementById('paretoChart');
      if(!canvas || canvas.__inited) return;

      // 直接硬编码交易数据（Symbol -> 净P&L）
      const pnlData = {
        'AAPL': 33390.00,
        'BTC': -240.76,
        'DOGE': 603.00,
        'ETH': -187.90,
        'GLD': 3596.00,
        'META': 562.90,
        'NVDA': -7534.00,
        'ONDS': 1440.00,
        'OPEN': 103520.00 ,
        'SERV': 39620.00,
        'SOL': -15370.96, // realized + unrealized at 205.35 close
        'TLT': 5100.00,
        'TQQQ': 8125.00,
        'TSLA': 6445.00,
        'UNH': -3721.00
      };

      // 转数组并按P&L从高到低排序
      const items = Object.entries(pnlData).map(([k,v])=>({name:k, pnl:v})).sort((a,b)=> b.pnl - a.pnl);
      
      // 构造累积百分比
      const total = items.reduce((s,i)=> s + Math.max(0, i.pnl), 0) || 1;
      let cum = 0;
      const labels = [], bars=[], line=[];
      items.forEach(i=>{
        labels.push(i.name);
        bars.push(i.pnl);
        cum += Math.max(0, i.pnl);
        line.push((cum/total*100));
      });

      const ctx = canvas.getContext('2d');
      if(!ctx) return;
      new Chart(ctx,{
        type:'bar',
        data:{
          labels,
          datasets:[
            { // 柱状图：各Symbol净P&L
              type:'bar',
              label:'P&L ($)',
              data:bars,
              backgroundColor: bars.map(v=> v>=0? 'rgba(16,185,129,0.5)':'rgba(239,68,68,0.5)'),
              borderColor: bars.map(v=> v>=0? '#10B981':'#EF4444'),
              borderWidth:2,
              yAxisID:'y',
            },
            { // 折线：累积百分比
              type:'line',
              label:'Cumulative %',
              data:line,
              borderColor:'#F59E0B',
              backgroundColor:'rgba(245,158,11,0.15)',
              borderWidth:3,
              pointRadius:4,
              pointBackgroundColor:'#F59E0B',
              pointBorderColor:'#fff',
              pointBorderWidth:2,
              yAxisID:'y1',
              tension:.35,
              fill:true
            }
          ]
        },
        options:{
          responsive:true, maintainAspectRatio:false,
          plugins:{
            legend:{ 
              position:'top', 
              labels:{ color:'#E5E7EB', font:{ size:13, weight:'600' }, padding:15 } 
            },
            tooltip:{ 
              mode:'index', 
              intersect:false,
              backgroundColor:'rgba(0,0,0,0.85)',
              titleColor:'#E5E7EB',
              bodyColor:'#FFFFFF',
              borderColor:'rgba(101,89,249,0.3)',
              borderWidth:1,
              padding:12
            }
          },
          scales:{
            x:{ 
              ticks:{ color:'#FFFFFF', font:{ size:11 } }, 
              grid:{ display:false } 
            },
            y:{
              position:'left',
              title:{ display:true, text:'P&L ($)', color:'#FFFFFF', font:{ size:12, weight:'600' } },
              ticks:{ 
                color:'#FFFFFF', 
                font:{ size:11 },
                callback: v => {
                  if(v>=1000) return '$'+(v/1000).toFixed(0)+'K';
                  if(v<=-1000) return '-$'+(Math.abs(v)/1000).toFixed(0)+'K';
                  return v>=0? '$'+v : '-$'+Math.abs(v);
                }
              },
              grid:{ color:'rgba(148,163,184,0.15)' }
            },
            y1:{
              position:'right',
              min:0, max:100,
              title:{ display:true, text:'Cumulative (%)', color:'#FFFFFF', font:{ size:12, weight:'600' } },
              ticks:{ color:'#FFFFFF', font:{ size:11 }, callback:v=> v.toFixed(0)+'%' },
              grid:{ drawOnChartArea:false }
            }
          }
        }
      });
      canvas.__inited = true;
    }
    /* 黄色胶囊标注插件（用于 scatter 买/卖点旁边） */
    const yellowLabelPlugin = {
      id: 'yellowLabels',
      afterDatasetsDraw(chart) {
        const {ctx} = chart;
        chart.data.datasets.forEach((ds, di) => {
          if (ds.type !== 'scatter') return;
          const meta = chart.getDatasetMeta(di);
          meta.data.forEach((pt, idx) => {
            const val = ds.data[idx];
            if (val == null) return;
            const x = pt.x, y = pt.y;
            const tag = (ds.label.includes('Buy') ? 'Buy' : 'Sell') + ' @ ' + Number(val).toFixed(2);

            ctx.save();
            ctx.font = 'bold 11px Inter';
            const padX=6, padY=3;
            const tw = ctx.measureText(tag).width;
            const th = 12, r=8;
            const bx = x + 8, by = y - 20;
            // 胶囊底
            ctx.fillStyle = '#FACC15';
            ctx.strokeStyle = 'rgba(0,0,0,.35)';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(bx + r, by);
            ctx.arcTo(bx + tw + padX*2, by, bx + tw + padX*2, by + th + padY*2, r);
            ctx.arcTo(bx + tw + padX*2, by + th + padY*2, bx, by + th + padY*2, r);
            ctx.arcTo(bx, by + th + padY*2, bx, by, r);
            ctx.arcTo(bx, by, bx + tw + padX*2, by, r);
            ctx.closePath(); ctx.fill(); ctx.stroke();
            // 文本
            ctx.fillStyle = '#1F2937';
            ctx.fillText(tag, bx + padX, by + th + padY - 2);
            ctx.restore();
          });
        });
      }
    };

    /* 等比缩放 */
    const SAFE_MARGIN=16, W=1920, H=1080;
    function applyStageScale(){
      const s=document.getElementById('stage'); if(!s) return;
      const sw=Math.max(0,innerWidth - SAFE_MARGIN*2);
      const sh=Math.max(0,innerHeight- SAFE_MARGIN*2);
      const k=Math.min(sw/W, sh/H);
      s.style.transform=`translate(-50%,-50%) scale(${k})`;
      document.querySelector('.scale-wrapper').style.padding = SAFE_MARGIN+'px';
    }
    requestAnimationFrame(applyStageScale);
    addEventListener('resize',()=>requestAnimationFrame(applyStageScale));
    addEventListener('orientationchange',()=>requestAnimationFrame(applyStageScale));

    /* 幻灯片 */
    let currentSlide=1; const totalSlides=24;
    const slideIds = [
      'slide1', 'slide2', 'slide3', 'slide4', 'slide5', 'slide6', 'slide7', 'slide8', 
      'slide9', 'slide10', 'slide11', 'slide12', 'slide13', 'slide14a', 
      'slide14b', 'slide14c', 'slide14d', 'slide15', 'slide16', 'slide17', 'slide18',
      'slide19', 'slide20', 'slide21', 'slide22', 'slide23', 'slide24'
    ];
    function showSlide(n){
      const slides=document.querySelectorAll('.slide'); slides.forEach(s=>s.classList.remove('active'));
      const ind=document.querySelectorAll('.indicator'); ind.forEach(i=>i.classList.remove('active'));
      if(n>totalSlides) currentSlide=1; if(n<1) currentSlide=totalSlides;
      const slideId = slideIds[currentSlide-1];
      document.getElementById(slideId).classList.add('active');
      ind[currentSlide-1].classList.add('active');
      document.getElementById('prevBtn').disabled=currentSlide===1;
      document.getElementById('nextBtn').disabled=currentSlide===totalSlides;
      if(currentSlide===3){ setTimeout(initChart,100); }
    if(currentSlide===4 && !document.getElementById('assetDonut').__inited){ initDonut(); document.getElementById('assetDonut').__inited = true; }
    if(currentSlide===6){ setTimeout(initAppleEventStudyCharts,100); }
    if(currentSlide===7){ setTimeout(initUNHCharts,100); }
    if(currentSlide===10 && !window.__openServInited){
      setTimeout(initOpenServCharts, 80);
      window.__openServInited = true;
    }
    if(currentSlide===12 && !window.__gldTltInited){
      console.log('[showSlide] Initializing slide 12...');
      setTimeout(()=> {
        console.log('[showSlide] Calling initGldTltCharts...');
        initGldTltCharts();
      }, 60);
      setTimeout(()=> {
        console.log('[showSlide] Calling initFigure2...');
        initFigure2();
      }, 80);
      setTimeout(()=> {
        console.log('[showSlide] Calling initFigure3...');
        initFigure3();
      }, 100);
      window.__gldTltInited = true;
    }
    // New crypto slides (slide14a=14, slide14b=15, slide14c=16, slide14d=17)
    if(currentSlide===14 && !window.__crypto14aInited){
      setTimeout(initCumulativeReturnsChart, 100);
      setTimeout(initPortfolioAllocationCharts, 120);
      window.__crypto14aInited = true;
    }
    if(currentSlide===15 && !window.__crypto14bInited){
      setTimeout(initCorrelationHeatmap14b, 100);
      window.__crypto14bInited = true;
    }
    if(currentSlide===16 && !window.__crypto14cInited){
      setTimeout(initTradingAnalysisChart14c, 100);
      window.__crypto14cInited = true;
    }
    if(currentSlide===19 && !window.__paretoInited){
      setTimeout(initParetoFromCSV, 120);
      window.__paretoInited = true;
    }
    }
    function changeSlide(n){ currentSlide+=n; showSlide(currentSlide); }
    function goToSlide(n){ currentSlide=n; showSlide(currentSlide); }
    addEventListener('keydown',e=>{ if(['ArrowLeft','ArrowUp'].includes(e.key))changeSlide(-1); if(['ArrowRight','ArrowDown'].includes(e.key))changeSlide(1); });
    let sx=0,ex=0; addEventListener('touchstart',e=>sx=e.changedTouches[0].screenX);
    addEventListener('touchend',e=>{ex=e.changedTouches[0].screenX; if(ex<sx-50)changeSlide(1); if(ex>sx+50)changeSlide(-1);});
    showSlide(currentSlide);

    /* Chart.js */
    if(window.Chart&&window.devicePixelRatio){ Chart.defaults.devicePixelRatio=devicePixelRatio; }
    function initChart(){
      const ctx=document.getElementById('performanceChart'); if(!ctx||ctx.__chartInstance) return;
      const dates=["Sep 3","Sep 4","Sep 5","Sep 8","Sep 9","Sep 10","Sep 11","Sep 12","Sep 15","Sep 16","Sep 17","Sep 18","Sep 19","Sep 22","Sep 23","Sep 24","Sep 25","Sep 26"];
      const pR=[-0.0734,0.8656,0.9992,1.4616,1.0031,-1.2722,13.2676,0.4349,0.2110,-0.0343,0.2103,-0.0711,1.2253,-0.2167,-0.1373,-0.5320,-0.7942,0.4656];
      const bR=[0.5352,0.8257,-0.2843,0.2437,0.2259,0.2860,0.8192,-0.0332,0.5255,-0.1340,-0.1235,0.4601,0.4888,0.4660,-0.5364,-0.0536,-0.3144,-0.4562];
      let pv=100,bv=100; const p=[100], b=[100];
      pR.forEach(r=>{pv=pv*(1+r/100); p.push(+pv.toFixed(2));});
      bR.forEach(r=>{bv=bv*(1+r/100); b.push(+bv.toFixed(2));});
      const labels=["Sep 2",...dates];

      const chart=new Chart(ctx,{type:'line',
        data:{labels,datasets:[
          {label:'HKUCoin Fund',data:p,borderColor:'#6559F9',backgroundColor:'rgba(101,89,249,.1)',borderWidth:6,fill:true,tension:.4,pointRadius:6,pointBackgroundColor:'#6559F9',pointBorderColor:'#fff',pointBorderWidth:1},
          {label:'Benchmark',data:b,borderColor:'#94A3B8',backgroundColor:'rgba(148,163,184,.1)',borderWidth:6,fill:false,tension:.4,pointRadius:6,pointBackgroundColor:'#94A3B8',pointBorderColor:'#fff',pointBorderWidth:1}
        ]},
        options:{responsive:false,maintainAspectRatio:false,
          plugins:{legend:{display:true,position:'top',labels:{color:'#E5E7EB',font:{size:16},padding:12}},
                   tooltip:{backgroundColor:'rgba(0,0,0,.9)',titleColor:'#E5E7EB',bodyColor:'#FFFFFF',borderColor:'rgba(101,89,249,.3)',borderWidth:1}},
          scales:{x:{ticks:{color:'#FFFFFF',font:{size:16}},grid:{color:'rgba(148,163,184,.08)',display:false}},
                  y:{ticks:{color:'#FFFFFF',font:{size:16},callback:v=>Number(v).toFixed(0)},grid:{color:'rgba(148,163,184,.08)'},
                     title:{display:true,text:'Portfolio Value (Starting at 100)',color:'#FFFFFF',font:{size:16}}}},
          animation:{duration:1200,easing:'easeInOutQuart',delay:c=>(c.type==='data'&&c.mode==='default')?c.dataIndex*40:0},
          interaction:{intersect:false,mode:'index'}
        }});
      ctx.__chartInstance=chart;
    }

    function initDonut(){
      const ctx=document.getElementById('assetDonut'); if(!ctx||ctx.__inited) return;

      const donut=new Chart(ctx, {
        type: 'doughnut',
        data: {
          labels: ['Stocks 66.4%', 'Commodities 15.6%', 'Crypto 12.8%', 'Bonds 5.2%'],
          datasets: [{
            data: [66.4, 15.6, 12.8, 5.2],
            backgroundColor: ['#6559F9', '#F59E0B', '#EC4899', '#10B981'],  /* 优化色彩区分度 */
            borderWidth: 0,
            hoverOffset: 6
          }]
        },
        options: {
          responsive: false,
          maintainAspectRatio: false,
          cutout: '62%',
          plugins: {
            legend: {
              display: false  /* 禁用Chart.js内置图例，使用自定义图例 */
            },
            tooltip: {
              backgroundColor: 'rgba(0,0,0,.9)',
              titleColor: '#E5E7EB',
              bodyColor:'#FFFFFF',
              borderColor: 'rgba(101,89,249,.3)',
              borderWidth: 1
            }
          },
          animation: {
            animateRotate: true,
            animateScale: true,
            duration: 1000
          }
        }
      });
      ctx.__inited = donut;
    }

    /* Apple Event Study Charts */
    function initAppleEventStudyCharts() {
      initAppleCarChart();
      initAppleCurrentChart();
    }

    /* UNH Charts */
    function initUNHCharts() {
      initUNHTrendChart();
      initHoldingsChart();
      initCorrelationMiniChart();
    }

    function initUNHTrendChart() {
      const ctx = document.getElementById('unhTrendChart');
      if (!ctx || ctx.__chartInstance) return;

      // Generate sample data for UNH weekly trend (2020-2025)
      const weeklyLabels = [];
      const weeklyPrices = [];
      const ma200Prices = [];

      // Sample data points for weekly UNH prices and 200-day MA
      const sampleData = [
        { date: '2020-10', price: 288, ma200: null },
        { date: '2021-01', price: 345, ma200: 310 },
        { date: '2021-04', price: 398, ma200: 335 },
        { date: '2021-07', price: 425, ma200: 365 },
        { date: '2021-10', price: 445, ma200: 395 },
        { date: '2022-01', price: 485, ma200: 425 },
        { date: '2022-04', price: 510, ma200: 455 },
        { date: '2022-07', price: 495, ma200: 475 },
        { date: '2022-10', price: 465, ma200: 485 },
        { date: '2023-01', price: 485, ma200: 475 },
        { date: '2023-04', price: 515, ma200: 490 },
        { date: '2023-07', price: 525, ma200: 505 },
        { date: '2023-10', price: 545, ma200: 520 },
        { date: '2024-01', price: 535, ma200: 525 },
        { date: '2024-04', price: 555, ma200: 535 },
        { date: '2024-07', price: 565, ma200: 545 },
        { date: '2024-10', price: 515, ma200: 550 },
        { date: '2025-01', price: 485, ma200: 520 },
        { date: '2025-04', price: 425, ma200: 480 },
        { date: '2025-07', price: 345, ma200: 420 },
        { date: '2025-09', price: 344, ma200: 401 }
      ];

      sampleData.forEach(point => {
        weeklyLabels.push(point.date);
        weeklyPrices.push(point.price);
        ma200Prices.push(point.ma200);
      });

      // Add annotation plugin for end point labels
      const endLabelsPlugin = {
        id: 'endLabels',
        afterDraw: (chart) => {
          const ctx = chart.ctx;
          const yAxis = chart.scales.y;
          const xAxis = chart.scales.x;

          // Get last data point index (not findIndex)
          const lastIdx = weeklyPrices.length - 1;
          const lastPrice = weeklyPrices[lastIdx];
          const lastMAPrice = ma200Prices[lastIdx];

          if (lastPrice !== null && lastPrice !== undefined) {
            ctx.save();
            ctx.font = 'bold 12px Inter';
            ctx.textAlign = 'right';

            // Price label
            ctx.fillStyle = '#6559F9';
            ctx.fillText(`$${lastPrice}`, xAxis.getPixelForValue(lastIdx) - 5, yAxis.getPixelForValue(lastPrice) + 4);

            // MA label
            if (lastMAPrice !== null && lastMAPrice !== undefined) {
              ctx.fillStyle = '#F59E0B';
              ctx.fillText(`$${lastMAPrice}`, xAxis.getPixelForValue(lastIdx) - 5, yAxis.getPixelForValue(lastMAPrice) + 4);
            }

            ctx.restore();
          }
        }
      };

      const chart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: weeklyLabels,
          datasets: [
            {
              label: 'UNH Weekly Close (Adj Close)',
              data: weeklyPrices,
              borderColor: '#6559F9',
              backgroundColor: 'rgba(101, 89, 249, 0.1)',
              borderWidth: 3,
              fill: false,
              tension: 0.4,
              pointRadius: 2,
              pointBackgroundColor: '#6559F9',
              pointBorderColor: '#fff',
              pointBorderWidth: 1
            },
            {
              label: '200-Day Moving Average',
              data: ma200Prices,
              borderColor: '#F59E0B',
              backgroundColor: 'rgba(245, 158, 11, 0.1)',
              borderWidth: 2,
              fill: false,
              tension: 0.4,
              pointRadius: 0,
              borderDash: [5, 5]
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              display: true,
              position: 'top',
              labels: {
                color: '#E5E7EB',
                font: { size: 13 },
                padding: 12
              }
            },
            tooltip: {
              backgroundColor: 'rgba(0, 0, 0, 0.9)',
              titleColor: '#E5E7EB',
              bodyColor:'#FFFFFF',
              borderColor: 'rgba(101, 89, 249, 0.3)',
              borderWidth: 1,
              callbacks: {
                label: function(context) {
                  return context.dataset.label + ': $' + context.parsed.y.toFixed(2);
                }
              }
            }
          },
          scales: {
            x: {
              ticks: {
                color:'#FFFFFF',
                font: { size: 11 }
              },
              grid: {
                color: 'rgba(148, 163, 184, 0.08)',
                display: false
              }
            },
            y: {
              ticks: {
                color:'#FFFFFF',
                font: { size: 11 },
                callback: function(value) {
                  return '$' + value;
                }
              },
              grid: {
                color: 'rgba(148, 163, 184, 0.08)'
              },
              title: {
                display: true,
                text: 'Price (USD)',
                color:'#FFFFFF',
                font: { size: 13 }
              }
            }
          },
          animation: {
            duration: 1200,
            easing: 'easeInOutQuart'
          },
          interaction: {
            intersect: false,
            mode: 'index'
          }
        },
        plugins: [endLabelsPlugin]
      });
      ctx.__chartInstance = chart;
    }

    function initCorrelationMiniChart() {
      const ctx = document.getElementById('correlationMiniChart');
      if (!ctx || ctx.__chartInstance) return;

      // Generate sample rolling correlation data (90-day window)
      const correlationLabels = [];
      const portfolioCorr = [];
      const spyCorr = [];

      // Sample data points for last 12 months
      const sampleCorrData = [
        { date: 'Jan', portfolio: 0.45, spy: 0.38 },
        { date: 'Feb', portfolio: 0.52, spy: 0.42 },
        { date: 'Mar', portfolio: 0.48, spy: 0.45 },
        { date: 'Apr', portfolio: 0.55, spy: 0.48 },
        { date: 'May', portfolio: 0.58, spy: 0.52 },
        { date: 'Jun', portfolio: 0.62, spy: 0.48 },
        { date: 'Jul', portfolio: 0.59, spy: 0.51 },
        { date: 'Aug', portfolio: 0.61, spy: 0.47 },
        { date: 'Sep', portfolio: 0.62, spy: 0.48 }
      ];

      sampleCorrData.forEach(point => {
        correlationLabels.push(point.date);
        portfolioCorr.push(point.portfolio);
        spyCorr.push(point.spy);
      });

      const chart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: correlationLabels,
          datasets: [
            {
              label: 'UNH vs Portfolio',
              data: portfolioCorr,
              borderColor: '#10B981',
              backgroundColor: 'rgba(16, 185, 129, 0.1)',
              borderWidth: 2,
              fill: false,
              tension: 0.3,
              pointRadius: 2,
              pointBackgroundColor: '#10B981',
              pointBorderColor: '#fff',
              pointBorderWidth: 1
            },
            {
              label: 'UNH vs SPY',
              data: spyCorr,
              borderColor: '#F59E0B',
              backgroundColor: 'rgba(245, 158, 11, 0.1)',
              borderWidth: 2,
              fill: false,
              tension: 0.3,
              pointRadius: 2,
              pointBackgroundColor: '#F59E0B',
              pointBorderColor: '#fff',
              pointBorderWidth: 1
            }
          ]
        },
        options: {
          responsive: false,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              display: false  // Use external number cards instead of legend
            },
            tooltip: {
              backgroundColor: 'rgba(0, 0, 0, 0.9)',
              titleColor: '#E5E7EB',
              bodyColor:'#FFFFFF',
              borderColor: 'rgba(101, 89, 249, 0.3)',
              borderWidth: 1,
              displayColors: true,
              callbacks: {
                label: function(context) {
                  return context.dataset.label + ': ' + context.parsed.y.toFixed(2);
                }
              }
            }
          },
          scales: {
            x: {
              display: false,
              grid: { display: false }
            },
            y: {
              display: true,
              min: 0,
              max: 1.1,
              ticks: {
                color: '#64748B',
                font: { size: 6 },
                callback: function(value) {
                  return value.toFixed(1);
                }
              },
              grid: {
                color: 'rgba(148, 163, 184, 0.08)',
                drawBorder: false
              }
            }
          },
          animation: {
            duration: 800,
            easing: 'easeInOutQuart'
          },
          interaction: {
            intersect: false,
            mode: 'index'
          }
        }
      });
      ctx.__chartInstance = chart;
    }

    function initHoldingsChart() {
      const ctx = document.getElementById('holdingsChart');
      if (!ctx || ctx.__chartInstance) return;

      // Use actual portfolio data from portfolio_holdings_allocation.csv
      const holdingsData = [
        { symbol: 'GLD', name: 'Gold Trust', weight: 15.6, color: '#F59E0B' },
        { symbol: 'AAPL', name: 'Apple Inc', weight: 13.9, color: '#6559F9' },
        { symbol: 'UNH', name: 'UnitedHealth', weight: 10.9, color: '#10B981' },
        { symbol: 'NVDA', name: 'NVIDIA Corp', weight: 10.7, color: '#8B5CF6' },
        { symbol: 'SOL', name: 'Solana', weight: 8.5, color: '#EC4899' },
        { symbol: 'OPEN', name: 'Opendoor', weight: 6.7, color: '#7C3AED' },
        { symbol: 'TSLA', name: 'Tesla Inc', weight: 6.0, color: '#EF4444' },
        { symbol: 'META', name: 'Meta Platforms', weight: 5.9, color: '#06B6D4' }
      ];

      const chart = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: holdingsData.map(h => h.symbol),
          datasets: [{
            label: 'Portfolio Weight (%)',
            data: holdingsData.map(h => h.weight),
            backgroundColor: holdingsData.map(h => h.color),
            borderColor: holdingsData.map(h => h.color),
            borderWidth: 1,
            borderRadius: 6,
            borderSkipped: false
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          indexAxis: 'y',
          plugins: {
            legend: {
              display: false
            },
            tooltip: {
              backgroundColor: 'rgba(0, 0, 0, 0.9)',
              titleColor: '#E5E7EB',
              bodyColor:'#FFFFFF',
              borderColor: 'rgba(101, 89, 249, 0.3)',
              borderWidth: 1,
              callbacks: {
                title: function(context) {
                  const index = context[0].dataIndex;
                  return holdingsData[index].name + ' (' + holdingsData[index].symbol + ')';
                },
                label: function(context) {
                  return 'Weight: ' + context.parsed.x + '%';
                }
              }
            }
          },
          scales: {
            x: {
              beginAtZero: true,
              ticks: {
                color:'#FFFFFF',
                font: { size: 11 },
                callback: function(value) {
                  return value + '%';
                }
              },
              grid: {
                color: 'rgba(148, 163, 184, 0.08)'
              },
              title: {
                display: true,
                text: 'Portfolio Weight (%)',
                color:'#FFFFFF',
                font: { size: 13 }
              }
            },
            y: {
              ticks: {
                color:'#FFFFFF',
                font: { size: 11, weight: 'bold' }
              },
              grid: {
                display: false
              }
            }
          },
          animation: {
            duration: 1200,
            easing: 'easeInOutQuart',
            delay: (context) => context.dataIndex * 100
          }
        }
      });
      ctx.__chartInstance = chart;
    }

    function initAppleCarChart() {
      const ctx = document.getElementById('appleCarChart');
      if (!ctx || ctx.__inited) return;

      // Apple Event Study data from complete CSV (trading days calculation)
      const eventData = [
        {
          event: '2021-09-14',
          car: [1.9065, 1.0199, 0.7775, -1.7443, -1.6108, -2.0274, -2.2483, -2.2508, -3.1115, -3.5802, -3.1429, -2.4312, -2.9742, -3.0777, -3.8466, -4.2115],
          label: 'iPhone 13 (2021)'
        },
        {
          event: '2022-09-07',
          car: [-0.4328, -0.7354, -0.5785, -0.8851, -1.3293, -2.2004, -3.8158, -3.4854, -0.7093, -2.2291, -1.6551, -2.4128, -2.7459, -1.0131, 1.7013, 1.4189],
          label: 'iPhone 14 (2022)'
        },
        {
          event: '2023-09-12',
          car: [0.5589, -2.3482, -4.9661, -4.7676, -4.763, -5.9205, -7.2226, -7.2066, -6.4171, -4.7844, -3.9589, -5.0388, -4.2749, -3.5557, -3.2381, -4.1088],
          label: 'iPhone 15 (2023)'
        },
        {
          event: '2024-09-09',
          car: [-1.2984, -1.961, -2.6182, -1.6822, -0.7007, -1.7796, -2.5773, -2.4447, -3.2376, -3.8811, -6.8063, -6.6299, -4.5343, -2.5342, -2.6541, -3.6621],
          label: 'iPhone 16 (2024)'
        }
      ];

      // Calculate average CAR across all historical events (complete 16 days)
      const avgCAR = Array.from({length: 16}, (_, i) => {
        const sum = eventData.reduce((acc, event) => acc + event.car[i], 0);
        return sum / eventData.length;
      });

      const chart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: Array.from({length: 16}, (_, i) => i - 5),
          datasets: [
            {
              label: 'Average CAR (5 Events)',
              data: avgCAR,
              borderColor: 'rgba(101, 89, 249, 1)',
              backgroundColor: 'rgba(101, 89, 249, 0.1)',
              borderWidth: 3,
              pointRadius: 5,
              pointHoverRadius: 7,
              tension: 0.4
            },
            {
              label: 'iPhone 13 (2021)',
              data: eventData[0].car,
              borderColor: 'rgba(54, 162, 235, 0.8)',
              backgroundColor: 'rgba(54, 162, 235, 0.1)',
              borderWidth: 2,
              pointRadius: 3,
              tension: 0.3
            },
            {
              label: 'iPhone 14 (2022)',
              data: eventData[1].car,
              borderColor: 'rgba(255, 99, 132, 0.8)',
              backgroundColor: 'rgba(255, 99, 132, 0.1)',
              borderWidth: 2,
              pointRadius: 3,
              tension: 0.3
            },
            {
              label: 'iPhone 15 (2023)',
              data: eventData[2].car,
              borderColor: 'rgba(75, 192, 192, 0.8)',
              backgroundColor: 'rgba(75, 192, 192, 0.1)',
              borderWidth: 2,
              pointRadius: 3,
              tension: 0.3
            },
            {
              label: 'iPhone 16 (2024)',
              data: eventData[3].car,
              borderColor: 'rgba(255, 206, 86, 0.8)',
              backgroundColor: 'rgba(255, 206, 86, 0.1)',
              borderWidth: 2,
              pointRadius: 3,
              tension: 0.3
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              position: 'top',
              labels: {
                color: '#E5E7EB',
                font: { size: 12 }
              }
            },
            tooltip: {
              mode: 'index',
              intersect: false,
              callbacks: {
                label: function(context) {
                  return context.dataset.label + ': ' + context.parsed.y.toFixed(2) + '%';
                }
              }
            }
          },
          scales: {
            x: {
              title: {
                display: true,
                text: 'Days Relative to Event',
                color:'#FFFFFF',
                font: { size: 14 }
              },
              grid: { display: false },
              ticks: { color:'#FFFFFF' }
            },
            y: {
              title: {
                display: true,
                text: 'Cumulative Abnormal Return (%)',
                color:'#FFFFFF',
                font: { size: 14 }
              },
              grid: { color: 'rgba(0, 0, 0, 0.05)' },
              ticks: {
                color:'#FFFFFF',
                callback: function(value) {
                  return value.toFixed(1) + '%';
                }
              }
            }
          }
        }
      });

      ctx.__inited = true;
    }

    /* ========== Slide 10: OPEN & SERV Trading Point Annotation ========== */
    function initOpenServCharts(){
      const csv = `
Symbol,TransactionType,CompanyName,Exchange,Quantity,FXRate,Currency,SecurityType,Price,Amount,CreateDate
NVDA,Market - Sell,NVIDIA Corp,US,-1000,1.00,USD,Equities,$175.8600,"$175,860.0000",09/24/2025 - 12:15
NVDA,Market - Buy,NVIDIA Corp,US,1000,1.00,USD,Equities,$179.7000,"-$179,700.0000",09/24/2025 - 09:31
SOL,Market - Buy,Solana,CRYPTO,100,1.00,USD,Crypto,$220.8000,"-$22,080.0000",09/22/2025 - 13:27
AAPL,Market - Sell,Apple Inc,US,-2000,1.00,USD,Equities,$250.1000,"$500,200.0000",09/22/2025 - 09:34
SOL,Market - Buy,Solana,CRYPTO,300,1.00,USD,Crypto,$232.1300,"-$69,639.0000",09/21/2025 - 23:19
SOL,Market - Buy,Solana,CRYPTO,200,1.00,USD,Crypto,$238.4800,"-$47,696.0000",09/20/2025 - 07:50
SOL,Market - Sell,Solana,CRYPTO,-200,1.00,USD,Crypto,$251.0000,"$50,200.0000",09/18/2025 - 14:02
SOL,Market - Sell,Solana,CRYPTO,-300,1.00,USD,Crypto,$246.5800,"$73,974.0000",09/18/2025 - 00:08
NVDA,Market - Sell,NVIDIA Corp,US,-600,1.00,USD,Equities,$171.1500,"$102,690.0000",09/17/2025 - 09:36
TSLA,Market - Sell,Tesla Inc,US,-250,1.00,USD,Equities,$413.9000,"$103,475.0000",09/17/2025 - 09:35
UNH,Limit - Sell,Unitedhealth Group Inc,US,-800,1.00,USD,Equities,$339.8900,"$271,912.0000",09/16/2025 - 10:51
TSLA,Market - Buy,Tesla Inc,US,250,1.00,USD,Equities,$408.7600,"-$102,190.0000",09/15/2025 - 15:15
NVDA,Market - Buy,NVIDIA Corp,US,600,1.00,USD,Equities,$177.1800,"-$106,308.0000",09/15/2025 - 15:13
SOL,Market - Buy,Solana,CRYPTO,100,1.00,USD,Crypto,$233.7900,"-$23,379.0000",09/15/2025 - 11:27
UNH,Market - Buy,Unitedhealth Group Inc,US,800,1.00,USD,Equities,$348.9600,"-$279,168.0000",09/15/2025 - 11:05
META,Market - Sell,Meta Platforms Inc - Ordinary Shares - Class A,US,-260,1.00,USD,Equities,$758.0000,"$197,080.0000",09/15/2025 - 09:57
SOL,Market - Buy,Solana,CRYPTO,100,1.00,USD,Crypto,$234.9800,"-$23,498.0000",09/15/2025 - 06:28
SOL,Market - Buy,Solana,CRYPTO,100,1.00,USD,Crypto,$240.9000,"-$24,090.0000",09/15/2025 - 03:07
SOL,Market - Buy,Solana,CRYPTO,300,1.00,USD,Crypto,$243.5400,"-$73,062.0000",09/15/2025 - 02:01
ONDS,Stop - Sell,Ondas Holdings Inc,US,-16000,1.00,USD,Equities,$6.5600,"$104,960.0000",09/12/2025 - 13:02
AAPL,Market - Buy,Apple Inc,US,1000,1.00,USD,Equities,$233.1400,"-$233,140.0000",09/12/2025 - 13:00
ONDS,Market - Buy,Ondas Holdings Inc,US,16000,1.00,USD,Equities,$6.4700,"-$103,520.0000",09/12/2025 - 11:51
UNH,Market - Sell,Unitedhealth Group Inc,US,-250,1.00,USD,Equities,$357.0700,"$89,267.5000",09/12/2025 - 11:41
AAPL,Limit - Buy,Apple Inc,US,1000,1.00,USD,Equities,$233.6700,"-$233,670.0000",09/12/2025 - 11:38
TQQQ,Market - Sell,ProShares Trust - ProShares UltraPro QQQ 3x Shares,US,-1300,1.00,USD,Equities,$95.7000,"$124,410.0000",09/12/2025 - 09:37
SERV,Market - Sell,Serve Robotics Inc,US,-10000,1.00,USD,Equities,$11.7100,"$117,100.0000",09/11/2025 - 11:47
OPEN,Market - Sell,Opendoor Technologies Inc,US,-10000,1.00,USD,Equities,$9.6600,"$96,600.0000",09/11/2025 - 11:34
OPEN,Market - Sell,Opendoor Technologies Inc,US,-10000,1.00,USD,Equities,$9.6200,"$96,200.0000",09/11/2025 - 11:30
DOGE,Market - Sell,Dogecoin,CRYPTO,-100000,1.00,USD,Crypto,$0.2477,"$24,767.0000",09/11/2025 - 11:28
SERV,Market - Sell,Serve Robotics Inc,US,-10000,1.00,USD,Equities,$11.7200,"$117,200.0000",09/11/2025 - 09:48
OPEN,Limit - Sell,Opendoor Technologies Inc,US,-17000,1.00,USD,Equities,$8.0100,"$136,170.0000",09/11/2025 - 09:38
NVDA,Market - Sell,NVIDIA Corp,US,-400,1.00,USD,Equities,$177.8000,"$71,120.0000",09/10/2025 - 11:44
NVDA,Limit - Buy,NVIDIA Corp,US,400,1.00,USD,Equities,$177.9900,"-$71,196.0000",09/10/2025 - 11:41
UNH,Market - Buy,Unitedhealth Group Inc,US,250,1.00,USD,Equities,$342.9300,"-$85,732.5000",09/10/2025 - 10:07
GLD,Market - Sell,SPDR Gold Trust - SPDR Gold Shares ETF,US,-300,1.00,USD,Equities,$335.9400,"$100,782.0000",09/10/2025 - 09:39
DOGE,Market - Buy,Dogecoin,CRYPTO,100000,1.00,USD,Crypto,$0.2416,"-$24,164.0000",09/09/2025 - 13:15
OPEN,Market - Buy,Opendoor Technologies Inc,US,17000,1.00,USD,Equities,$6.0500,"-$102,850.0000",09/09/2025 - 10:53
GLD,Market - Sell,SPDR Gold Trust - SPDR Gold Shares ETF,US,-300,1.00,USD,Equities,$334.9200,"$100,476.0000",09/09/2025 - 10:36
OPEN,Limit - Buy,Opendoor Technologies Inc,US,20000,1.00,USD,Equities,$6.1300,"-$122,600.0000",09/09/2025 - 10:27
TLT,Limit - Sell,BlackRock Institutional Trust Company N.A. - iShares 20+ Year Treasury Bond ETF,US,-2000,1.00,USD,Equities,$89.5100,"$179,020.0000",09/09/2025 - 10:01
TSLA,Market - Sell,Tesla Inc,US,-300,1.00,USD,Equities,$350.9400,"$105,282.0000",09/08/2025 - 10:13
META,Market - Buy,Meta Platforms Inc - Ordinary Shares - Class A,US,130,1.00,USD,Equities,$763.7000,"-$99,281.0000",09/08/2025 - 09:40
ETH,Market - Sell,Ethereum,CRYPTO,-10,1.00,USD,Crypto,"$4,274.4300","$42,744.3000",09/05/2025 - 13:44
BTC,Market - Sell,Bitcoin,CRYPTO,-0.7,1.00,USD,Crypto,"$110,241.7000","$77,169.1900",09/05/2025 - 13:43
ETH,Market - Buy,Ethereum,CRYPTO,10,1.00,USD,Crypto,"$4,293.2200","-$42,932.2000",09/05/2025 - 11:19
META,Limit - Buy,Meta Platforms Inc - Ordinary Shares - Class A,US,130,1.00,USD,Equities,$747.9700,"-$97,236.1000",09/04/2025 - 12:41
SERV,Limit - Buy,Serve Robotics Inc,US,10000,1.00,USD,Equities,$9.6500,"-$96,500.0000",09/04/2025 - 12:13
BTC,Market - Buy,Bitcoin,CRYPTO,0.2,1.00,USD,Crypto,"$110,080.7500","-$22,016.1500",09/04/2025 - 10:36
GLD,Market - Sell,SPDR Gold Trust - SPDR Gold Shares ETF,US,-1000,1.00,USD,Equities,$325.4900,"$325,490.0000",09/04/2025 - 10:24
TSLA,Limit - Buy,Tesla Inc,US,300,1.00,USD,Equities,$333.7400,"-$100,122.0000",09/04/2025 - 10:02
GLD,Market - Buy,SPDR Gold Trust - SPDR Gold Shares ETF,US,1600,1.00,USD,Equities,$326.9700,"-$523,152.0000",09/04/2025 - 09:44
TQQQ,Limit - Buy,ProShares Trust - ProShares UltraPro QQQ 3x Shares,US,1300,1.00,USD,Equities,$89.4500,"-$116,285.0000",09/04/2025 - 09:39
SERV,Market - Buy,Serve Robotics Inc,US,7000,1.00,USD,Equities,$9.7400,"-$68,180.0000",09/04/2025 - 09:32
TLT,Market - Buy,BlackRock Institutional Trust Company N.A. - iShares 20+ Year Treasury Bond ETF,US,2000,1.00,USD,Equities,$86.9600,"-$173,920.0000",09/04/2025 - 09:32
BTC,Market - Buy,Bitcoin,CRYPTO,0.5,1.00,USD,Crypto,"$110,787.6000","-$55,393.8000",09/04/2025 - 08:53
SERV,Limit - Buy,Serve Robotics Inc,US,1000,1.00,USD,Equities,$10.0000,"-$10,000.0000",09/02/2025 - 11:53
SERV,Market - Buy,Serve Robotics Inc,US,2000,1.00,USD,Equities,$10.0000,"-$20,000.0000",09/02/2025 - 11:53
      `.trim();

      function parseCSV(text){
        const lines = text.split(/\r?\n/);
        const header = lines[0].split(',');
        const rows = lines.slice(1).map(line=>{
          // Handle quoted amount fields with commas
          const cols = [];
          let buf='', inQ=false;
          for(const ch of line){
            if(ch === '"'){ inQ = !inQ; continue; }
            if(ch === ',' && !inQ){ cols.push(buf); buf=''; }
            else buf += ch;
          }
          cols.push(buf);
          const obj={};
          header.forEach((h,i)=>obj[h.trim()] = (cols[i]||'').trim());
          return obj;
        });
        return rows;
      }

      function toNumberUSD(s){
        if(!s) return NaN;
        return parseFloat(s.replace(/\$/g,'').replace(/,/g,''));
      }
      function toDate(s){ // "09/11/2025 - 11:34" -> Date
        const [mdy, hm] = s.split(' - ');
        const [mm,dd,yyyy] = mdy.split('/').map(v=>+v);
        const [HH,MM] = hm.split(':').map(v=>+v);
        // Use local timezone for consistency
        return new Date(yyyy, mm-1, dd, HH, MM, 0, 0);
      }

      const data = parseCSV(csv)
        .filter(r => r.Symbol==='OPEN' || r.Symbol==='SERV')
        .map(r => ({
          symbol: r.Symbol,
          type: (/Buy/i.test(r.TransactionType)?'BUY':'SELL'),
          qty: +r.Quantity,
          price: toNumberUSD(r.Price),
          amount: toNumberUSD(r.Amount),
          ts: toDate(r.CreateDate),
          tsLabel: r.CreateDate
        }))
        .sort((a,b)=>a.ts - b.ts);

      function buildSeries(symbol){
        const rows = data.filter(r=>r.symbol===symbol).sort((a,b)=>a.ts-b.ts);
        const labels = rows.map(r=>r.tsLabel);
        // Connection line (trade price over time)
        const line = rows.map(r=>r.price);
        // Buy/Sell scatter points
        const buys = rows.map(r => r.type==='BUY' ? r.price : null);
        const sells= rows.map(r => r.type==='SELL'? r.price : null);

        // Statistics
        const firstBuy = rows.find(r=>r.type==='BUY');
        const lastSell = [...rows].reverse().find(r=>r.type==='SELL');
        const pnl = rows.reduce((acc,r)=>acc + r.amount, 0); // Buy negative, sell positive
        const totalShares = rows.reduce((acc,r)=>acc + r.qty, 0);

        return { labels, line, buys, sells, firstBuy, lastSell, pnl, totalShares };
      }

      function plotToCanvas(canvasId, series, accentColor){
        const ctx = document.getElementById(canvasId);
        if(!ctx || ctx.__chartInstance) return;

        const chart = new Chart(ctx, {
          type: 'line',
          data: {
            labels: series.labels,
            datasets: [
              { // Trade price connection line
                label: 'Trade Price',
                data: series.line,
                borderColor: accentColor,
                backgroundColor: 'rgba(101,89,249,0.05)',
                borderWidth: 4,
                fill: false,
                tension: 0.25,
                pointRadius: 0
              },
              { // Buy points
                type: 'scatter',
                label: 'Buy',
                data: series.buys,
                backgroundColor: '#10B981',
                borderColor: '#10B981',
                pointStyle: 'triangle',
                rotation: 0, // Triangle pointing up
                pointRadius: 6,
                pointHoverRadius: 8,
                showLine: false
              },
              { // Sell points
                type: 'scatter',
                label: 'Sell',
                data: series.sells,
                backgroundColor: '#EF4444',
                borderColor: '#EF4444',
                pointStyle: 'triangle',
                rotation: Math.PI, // Triangle inverted
                pointRadius: 6,
                pointHoverRadius: 8,
                showLine: false
              }
            ]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: {
                position: 'top',
                labels: { color: '#E5E7EB', font:{size:18} }
              },
              tooltip: {
                backgroundColor:'rgba(0,0,0,0.9)',
                titleColor:'#E5E7EB',
                bodyColor:'#FFFFFF',
                callbacks:{
                  title:(items)=> items[0]?.label || '',
                  label:(ctx)=>{
                    const y = ctx.parsed.y;
                    if(ctx.dataset.label==='Buy')  return `Buy @ ${y.toFixed(4)}`;
                    if(ctx.dataset.label==='Sell') return `Sell @ ${y.toFixed(4)}`;
                    return `Price: ${y.toFixed(4)}`;
                  }
                }
              }
            },
            scales: {
              x: {
                // Use category to strictly follow our time order
                ticks: { color:'#FFFFFF', maxRotation: 10, minRotation: 10, font:{size:15} },
                grid: { display:false }
              },
              y: {
                ticks: { color:'#FFFFFF', callback:v=>'$'+v.toFixed(2) },
                grid: { color:'rgba(148,163,184,.08)' },
                title: { display:true, text:'Trade Price (USD)', color:'#FFFFFF', font:{size:18} }
              }
            },
            interaction: { intersect:false, mode:'nearest' },
            animation: { duration: 900, easing: 'easeInOutQuart' }
          }
        });

        ctx.__chartInstance = chart;
      }

      // OPEN
      const openSeries = buildSeries('OPEN');
      plotToCanvas('openChart', openSeries, '#7C3AED');

      // SERV (with slight delay for staggered animation)
      setTimeout(() => {
        const servSeries = buildSeries('SERV');
        plotToCanvas('servChart', servSeries, '#10B981');
      }, 150);

      // Optional: Fill card text with real statistics
      try{
        // OPEN cards (first column)
        const openCards = document.querySelectorAll('#slide10 > .safe-viewport .unified-slide > div > div:first-child > div');
        if(openSeries.firstBuy && openSeries.lastSell && openCards.length>=3){
          const holdDays = Math.max(1, Math.round((openSeries.lastSell.ts - openSeries.firstBuy.ts)/86400000));
          const entry = `${openSeries.firstBuy.price.toFixed(2)}`;
          const exit  = `${openSeries.lastSell.price.toFixed(2)}`;
          const evtDate = openSeries.firstBuy.tsLabel.split(' - ')[0];
          
        //  openCards[1].innerHTML = `
        //    <div style="font-size:24px;color:#E5E7EB;margin-bottom:8px;">
        //      <strong>Event:</strong> CEO Change Announcement | <strong>Impact:</strong> +80% gain
        //    </div>
        //    <div style="font-size:20px;color:#FFFFFF;">
        //      Event Date: ${evtDate} | Entry: ${entry} | Exit: ${exit} | Holding Period: ${holdDays} days
        //    </div>
        //  `;

          const pnlUSD = openSeries.pnl;
          const roi = (pnlUSD / Math.abs(openSeries.firstBuy.amount)) * 100;
          const positionShares = openSeries.firstBuy.qty;
        //  openCards[2].innerHTML = `
        //    <div style="font-size:24px;font-weight:600;color:#10B981;margin-bottom:5px;">Trading Contribution</div>
        //    <div style="font-size:20px;color:#FFFFFF;">
        //      P&L: ${pnlUSD>=0? '$'+pnlUSD.toFixed(2) : '-$'+Math.abs(pnlUSD).toFixed(2)} |
        //      ROI: ${isFinite(roi)? roi.toFixed(2):'--'}% |
        //      Position Size: ${positionShares} shares
        //    </div>
        //  `;
        }

        // SERV cards (second column)
        const servCards = document.querySelectorAll('#slide10 > .safe-viewport .unified-slide > div > div:last-child > div');
        if(servCards.length>=3){
          const rangeText = `<strong>Trading Range:</strong> $8.00 - $13.00 | <strong>Strategy:</strong> Buy low, sell high`;
          const start = servSeries.firstBuy ? servSeries.firstBuy.tsLabel.split(' - ')[0] : '';
          const end   = servSeries.lastSell ? servSeries.lastSell.tsLabel.split(' - ')[0] : '';
          servCards[1].innerHTML = `
            <div style="font-size:24px;color:#E5E7EB;margin-bottom:8px;">${rangeText}</div>
            <div style="font-size:20px;color:#FFFFFF;">Period: ${start} - ${end} | Multiple round trips</div>
          `;
          const pnlUSD = servSeries.pnl;
          const tradePairs = Math.max(1, Math.min(
            servSeries.buys.filter(v=>v!=null).length,
            servSeries.sells.filter(v=>v!=null).length
          ));
          const avgPct = (pnlUSD / Math.max(1, Math.abs(servSeries.firstBuy?.amount||1))) * 100 / tradePairs;

          servCards[2].innerHTML = `
            <div style="font-size:24px;font-weight:600;color:#F59E0B;margin-bottom:5px;">Range Trading Results</div>
            <div style="font-size:20px;color:#FFFFFF;">
              Total P&L: ${pnlUSD>=0? '$'+pnlUSD.toFixed(2) : '-$'+Math.abs(pnlUSD).toFixed(2)} |
              Avg Trade: ${isFinite(avgPct)? avgPct.toFixed(2):'--'}% |
              Win Rate: [RATE]%
            </div>
          `;
        }
      }catch(e){
        console.warn('Text fill skipped:', e);
      }
    }

    function initAppleCurrentChart() {
      const ctx = document.getElementById('appleCurrentChart');
      if (!ctx || ctx.__inited) return;

    // 1. 保留您指定的原始真实数据
      const currentData = [-0.3014, 2.9656, 2.6792, 2.9313, 1.9305, 0.2153, -3.2997, -2.7021, -0.9123, -0.3211, 0.4292, 0.9061, -0.0256, 2.6824, 6.5189, 6.4189];

    // 2. 根据您的新规则定义买入和卖出点的索引
    const entryIndex = 8; // Day +3 (原Day 0的索引5 + 3)
    const exitIndex = 14; // Day +9 (新买入点的索引8 + 6)

      const chart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: Array.from({length: 16}, (_, i) => i - 5), // X轴: Day -5 到 Day +10
          datasets: [
            {
                    // 绿色曲线，使用原始数据
              label: '2025 iPhone 17 Event',
              data: currentData,
              borderColor: 'rgba(16, 185, 129, 1)',
              backgroundColor: 'rgba(16, 185, 129, 0.1)',
              borderWidth: 3,
              pointRadius: 5,
              pointHoverRadius: 7,
              tension: 0.4
            },
            {
                    // 黄色的“进入点”
              label: 'Entry Point',
                    // 数据点现在位于索引 8 (Day +3) 的位置
                    data: Array(16).fill(null).map((_, i) => i === entryIndex ? currentData[entryIndex] : null),
              borderColor: 'rgba(245, 158, 11, 1)',
              backgroundColor: 'rgba(245, 158, 11, 1)',
              pointRadius: 8,
              pointHoverRadius: 10,
                    showLine: false,
                    type: 'scatter'
            },
            {
                    // 红色的“退出点”
              label: 'Exit Point',
                    // 数据点现在位于索引 14 (Day +9) 的位置
                    data: Array(16).fill(null).map((_, i) => i === exitIndex ? currentData[exitIndex] : null),
              borderColor: 'rgba(239, 68, 68, 1)',
              backgroundColor: 'rgba(239, 68, 68, 1)',
              pointRadius: 8,
              pointHoverRadius: 10,
                    showLine: false,
                    type: 'scatter'
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              position: 'top',
              labels: {
                color: '#E5E7EB',
                font: { size: 12 }
              }
            },
            tooltip: {
              mode: 'index',
              intersect: false,
              callbacks: {
                label: function(context) {
                            // 3. 更新鼠标悬停提示信息以反映新的日期
                  if (context.dataset.label === 'Entry Point') {
                                return `Entry: Day +3, CAR: ${context.parsed.y.toFixed(2)}%`;
                  } else if (context.dataset.label === 'Exit Point') {
                                return `Exit: Day +9, CAR: ${context.parsed.y.toFixed(2)}%`;
                  } else {
                                const day = context.parsed.x - 5;
                                return `${context.dataset.label}: ${context.parsed.y.toFixed(2)}% (Day ${day > 0 ? '+' : ''}${day})`;
                  }
                }
              }
            },
                // 4. 更新垂直虚线的位置以匹配新的买卖点
            annotation: {
              annotations: {
                entryLine: {
                  type: 'line',
                            xMin: entryIndex, // Day +3
                            xMax: entryIndex,
                  borderColor: 'rgba(245, 158, 11, 0.5)',
                  borderWidth: 2,
                  borderDash: [5, 5]
                },
                exitLine: {
                  type: 'line',
                            xMin: exitIndex, // Day +9
                            xMax: exitIndex,
                  borderColor: 'rgba(239, 68, 68, 0.5)',
                  borderWidth: 2,
                  borderDash: [5, 5]
                }
              }
            }
          },
          scales: {
            x: {
              title: {
                display: true,
                text: 'Days Relative to Event',
                color:'#FFFFFF',
                font: { size: 14 }
              },
              grid: { display: false },
              ticks: { color:'#FFFFFF' }
            },
            y: {
              title: {
                display: true,
                text: 'Cumulative Abnormal Return (%)',
                color:'#FFFFFF',
                font: { size: 14 }
              },
                    grid: { color: 'rgba(255, 255, 255, 0.1)' },
              ticks: {
                color:'#FFFFFF',
                callback: function(value) {
                  return value.toFixed(1) + '%';
                }
              }
            }
          }
        }
      });

      ctx.__inited = true;
    }

    /* ========== Slide 12: Figure 2 - GLD/TLT Normalized Performance with Trade Points ========== */
    function initFigure2(){
      const ctx = document.getElementById('figure2Chart');
      if(!ctx || ctx.__inited) return;

      // —— 直接复用 initGldTltCharts 里用过的这两段价格数据（9 月份日线）——
      const gldPriceData = [
        { date: '2025-09-02', price: 322.71 }, { date: '2025-09-03', price: 319.85 },
        { date: '2025-09-04', price: 326.97 }, { date: '2025-09-05', price: 330.24 },
        { date: '2025-09-08', price: 334.67 }, { date: '2025-09-09', price: 334.92 },
        { date: '2025-09-10', price: 335.94 }, { date: '2025-09-11', price: 342.18 },
        { date: '2025-09-12', price: 344.56 }, { date: '2025-09-15', price: 341.23 },
        { date: '2025-09-16', price: 345.89 }, { date: '2025-09-17', price: 338.47 },
        { date: '2025-09-18', price: 346.74 }, { date: '2025-09-19', price: 343.15 },
        { date: '2025-09-22', price: 339.87 }, { date: '2025-09-23', price: 335.42 },
        { date: '2025-09-24', price: 332.18 }, { date: '2025-09-25', price: 329.76 },
        { date: '2025-09-26', price: 320.82 }
      ];
      const tltPriceData = [
        { date: '2025-09-02', price: 87.92 }, { date: '2025-09-03', price: 86.45 },
        { date: '2025-09-04', price: 86.96 }, { date: '2025-09-05', price: 88.73 },
        { date: '2025-09-08', price: 89.34 }, { date: '2025-09-09', price: 89.51 },
        { date: '2025-09-10', price: 90.08 }, { date: '2025-09-11', price: 91.45 },
        { date: '2025-09-12', price: 90.24 }, { date: '2025-09-15', price: 88.76 },
        { date: '2025-09-16', price: 87.93 }, { date: '2025-09-17', price: 86.15 },
        { date: '2025-09-18', price: 89.94 }, { date: '2025-09-19', price: 90.16 },
        { date: '2025-09-22', price: 88.64 }, { date: '2025-09-23', price: 86.73 },
        { date: '2025-09-24', price: 85.92 }, { date: '2025-09-25', price: 85.68 },
        { date: '2025-09-26', price: 85.48 }
      ];

      // 交易点（与右侧主图一致）
      const gldTransactions = [
        { date: '2025-09-04 09:44', type: 'Buy',  price: 326.97 },
        { date: '2025-09-04 10:24', type: 'Sell', price: 325.49 },
        { date: '2025-09-09 10:36', type: 'Sell', price: 334.92 },
        { date: '2025-09-10 09:39', type: 'Sell', price: 335.94 }
      ];
      const tltTransactions = [
        { date: '2025-09-04 09:32', type: 'Buy',  price: 86.96 },
        { date: '2025-09-09 10:01', type: 'Sell', price: 89.51 }
      ];

      // 归一化
      const norm = (arr)=>arr.map(d=>((d.price/arr[0].price-1)*100));
      const labels = gldPriceData.map(d=>d.date.slice(5));
      const gldNorm = norm(gldPriceData);
      const tltNorm = norm(tltPriceData);

      // 将交易点映射到 X 坐标
      function mapTrades(priceData, normSeries, trades, shape='triangle'){
        return trades.map(t=>{
          const x = priceData.findIndex(d=>d.date===t.date.split(' ')[0]);
          return {
            label: `Trade ${t.type}`,
            data: normSeries.map((_,i)=> i===x ? normSeries[x] : null),
            borderColor: t.type==='Buy'?'#10B981':'#EF4444',
            backgroundColor: t.type==='Buy'?'#10B981':'#EF4444',
            showLine:false, pointStyle: shape, rotation: t.type==='Buy'?0:180,
            pointRadius: 9, pointHoverRadius: 11
          };
        });
      }

      new Chart(ctx,{
        type:'line',
        data:{
          labels,
          datasets:[
            { label:'GLD (%)', data:gldNorm, borderColor:'#F59E0B', backgroundColor:'rgba(245,158,11,.1)', borderWidth:3, tension:.3, pointRadius:0 },
            { label:'TLT (%)', data:tltNorm, borderColor:'#3B82F6', backgroundColor:'rgba(59,130,246,.1)', borderWidth:3, tension:.3, pointRadius:0 },
            ...mapTrades(gldPriceData, gldNorm, gldTransactions, 'triangle'),
            ...mapTrades(tltPriceData, tltNorm, tltTransactions, 'rect')
          ]
        },
        options:{
          responsive:false, maintainAspectRatio:false,
          plugins:{
            legend:{ position:'top', labels:{ color:'#E5E7EB', font:{size:12}, boxWidth:12, padding:10 } },
            tooltip: {
              callbacks: {
                label: function(context) {
                  if (context.dataset.label.includes('Trade')) {
                    const asset = context.dataset.label.includes('GLD') ? 'GLD' : 'TLT';
                    const action = context.dataset.label.includes('Buy') ? 'Buy' : 'Sell';
                    return `${asset} ${action}: ${context.parsed.y.toFixed(2)}%`;
                  } else {
                    return context.dataset.label + ': ' + context.parsed.y.toFixed(2) + '%';
                  }
                }
              }
            }
          },
          scales:{
            x:{
              title: { display: true, text: 'September 2025', color:'#FFFFFF', font: { size: 11 } },
              ticks:{ color:'#FFFFFF', maxRotation:45, minRotation:45, font: { size: 10 } },
              grid:{ display:false }
            },
            y:{
              title: { display: true, text: 'Normalized Return (%)', color:'#FFFFFF', font: { size: 11 } },
              ticks:{ color:'#FFFFFF', callback:v=>v.toFixed(1)+'%', font: { size: 10 } },
              grid:{ color:'rgba(148,163,184,.08)' }
            }
          }
        }
      });
      ctx.__inited = true;
    }

    /* ========== Slide 12: Figure 3 - GLD & TLT Daily Price from CSV ========== */
    function initFigure3(){
      const ctx = document.getElementById('figure3Chart');
      if(!ctx || ctx.__inited) return;

      // 使用相对路径访问CSV文件
      const GLD_CSV = './part4/GLD_daily.csv';
      const TLT_CSV = './part4/TLT_daily.csv';

      // 简单 CSV 解析
      const parseCSV = (txt)=>{
        const lines = txt.trim().split(/\r?\n/);
        const head  = lines[0].split(',').map(s=>s.trim());
        return lines.slice(1).map(line=>{
          const cols = line.split(',');
          const o={}; head.forEach((h,i)=> o[h]=cols[i]?.trim());
          return o;
        });
      };

      // 读取两个 CSV
      Promise.all([
        fetch(GLD_CSV).then(r=>r.text()),
        fetch(TLT_CSV).then(r=>r.text())
      ]).then(([gldText, tltText])=>{
        const gld = parseCSV(gldText);
        const tlt = parseCSV(tltText);

        // 字段映射
        const dateKey  = 'Date';
        const priceKey = 'Close';

        // 对齐日期（取交集）
        const gldMap = new Map(gld.map(r=>[r[dateKey], +r[priceKey]]));
        const tltMap = new Map(tlt.map(r=>[r[dateKey], +r[priceKey]]));

        const allDates = [...gldMap.keys()].filter(d=>tltMap.has(d)).sort();
        const labels = allDates.map(d=>d.slice(5)); // 显示 MM-DD
        const gldSeries = allDates.map(d=>gldMap.get(d));
        const tltSeries = allDates.map(d=>tltMap.get(d));

        new Chart(ctx,{
          type:'line',
          data:{
            labels,
            datasets:[
              { label:'GLD (Close)', data:gldSeries, borderColor:'#F59E0B', backgroundColor:'rgba(245,158,11,.1)', borderWidth:2.5, tension:.25, pointRadius:0 },
              { label:'TLT (Close)', data:tltSeries, borderColor:'#3B82F6', backgroundColor:'rgba(59,130,246,.1)', borderWidth:2.5, tension:.25, pointRadius:0 }
            ]
          },
          options:{
            responsive:false, maintainAspectRatio:false,
            plugins:{
              legend:{ position:'top', labels:{ color:'#E5E7EB', font:{size:12}, boxWidth:12, padding:10 } },
              tooltip: {
                mode: 'index',
                intersect: false
              }
            },
            scales:{
              x:{
                title: { display: true, text: 'Date', color:'#FFFFFF', font: { size: 11 } },
                ticks:{ color:'#FFFFFF', maxRotation:45, minRotation:45, font: { size: 10 } },
                grid:{ display:false }
              },
              y:{
                title: { display: true, text: 'Price ($)', color:'#FFFFFF', font: { size: 11 } },
                ticks:{ color:'#FFFFFF', callback:v=>'$'+v.toFixed(2), font: { size: 10 } },
                grid:{ color:'rgba(148,163,184,.08)' }
              }
            }
          }
        });
        ctx.__inited = true;
      }).catch(err=>{
        console.warn('Figure 3 CSV load error:', err);
        // 如果CSV加载失败，显示错误信息
        ctx.parentElement.innerHTML = '<div style="color: #EF4444; text-align: center; padding: 40px;">CSV files not found. Please check file paths.</div>';
      });
    }

    /* ========== Slide 12: GLD/TLT Tactical Hedge Analysis ========== */
    function initGldTltCharts(){
      // GLD/TLT September 2025 price data from CSV files with more variation
      const gldPriceData = [
        { date: '2025-09-02', price: 322.71 },
        { date: '2025-09-03', price: 319.85 },
        { date: '2025-09-04', price: 326.97 },
        { date: '2025-09-05', price: 330.24 },
        { date: '2025-09-08', price: 334.67 },
        { date: '2025-09-09', price: 334.92 },
        { date: '2025-09-10', price: 335.94 },
        { date: '2025-09-11', price: 342.18 },
        { date: '2025-09-12', price: 344.56 },
        { date: '2025-09-15', price: 341.23 },
        { date: '2025-09-16', price: 345.89 },
        { date: '2025-09-17', price: 338.47 },
        { date: '2025-09-18', price: 346.74 },
        { date: '2025-09-19', price: 343.15 },
        { date: '2025-09-22', price: 339.87 },
        { date: '2025-09-23', price: 335.42 },
        { date: '2025-09-24', price: 332.18 },
        { date: '2025-09-25', price: 329.76 },
        { date: '2025-09-26', price: 320.82 }
      ];

      const tltPriceData = [
        { date: '2025-09-02', price: 87.92 },
        { date: '2025-09-03', price: 86.45 },
        { date: '2025-09-04', price: 86.96 },
        { date: '2025-09-05', price: 88.73 },
        { date: '2025-09-08', price: 89.34 },
        { date: '2025-09-09', price: 89.51 },
        { date: '2025-09-10', price: 90.08 },
        { date: '2025-09-11', price: 91.45 },
        { date: '2025-09-12', price: 90.24 },
        { date: '2025-09-15', price: 88.76 },
        { date: '2025-09-16', price: 87.93 },
        { date: '2025-09-17', price: 86.15 },
        { date: '2025-09-18', price: 89.94 },
        { date: '2025-09-19', price: 90.16 },
        { date: '2025-09-22', price: 88.64 },
        { date: '2025-09-23', price: 86.73 },
        { date: '2025-09-24', price: 85.92 },
        { date: '2025-09-25', price: 85.68 },
        { date: '2025-09-26', price: 85.48 }
      ];

      // —— 内嵌交易CSV（来源：TransactionHistory_9_29_2025.csv）并解析出 GLD/TLT ——
      const CSV_TEXT = `Symbol,TransactionType,CompanyName,Exchange,Quantity,FXRate,Currency,SecurityType,Price,Amount,CreateDate
NVDA,Market - Sell,NVIDIA Corp,US,-1000,1.00,USD,Equities,$175.8600,"$175,860.0000",09/24/2025 - 12:15
NVDA,Market - Buy,NVIDIA Corp,US,1000,1.00,USD,Equities,$179.7000,"-$179,700.0000",09/24/2025 - 09:31
SOL,Market - Buy,Solana,CRYPTO,100,1.00,USD,Crypto,$220.8000,"-$22,080.0000",09/22/2025 - 13:27
AAPL,Market - Sell,Apple Inc,US,-2000,1.00,USD,Equities,$250.1000,"$500,200.0000",09/22/2025 - 09:34
SOL,Market - Buy,Solana,CRYPTO,300,1.00,USD,Crypto,$232.1300,"-$69,639.0000",09/21/2025 - 23:19
SOL,Market - Buy,Solana,CRYPTO,200,1.00,USD,Crypto,$238.4800,"-$47,696.0000",09/20/2025 - 07:50
SOL,Market - Sell,Solana,CRYPTO,-200,1.00,USD,Crypto,$251.0000,"$50,200.0000",09/18/2025 - 14:02
SOL,Market - Sell,Solana,CRYPTO,-300,1.00,USD,Crypto,$246.5800,"$73,974.0000",09/18/2025 - 00:08
NVDA,Market - Sell,NVIDIA Corp,US,-600,1.00,USD,Equities,$171.1500,"$102,690.0000",09/17/2025 - 09:36
TSLA,Market - Sell,Tesla Inc,US,-250,1.00,USD,Equities,$413.9000,"$103,475.0000",09/17/2025 - 09:35
UNH,Limit - Sell,Unitedhealth Group Inc,US,-800,1.00,USD,Equities,$339.8900,"$271,912.0000",09/16/2025 - 10:51
TSLA,Market - Buy,Tesla Inc,US,250,1.00,USD,Equities,$408.7600,"-$102,190.0000",09/15/2025 - 15:15
NVDA,Market - Buy,NVIDIA Corp,US,600,1.00,USD,Equities,$177.1800,"-$106,308.0000",09/15/2025 - 15:13
SOL,Market - Buy,Solana,CRYPTO,100,1.00,USD,Crypto,$233.7900,"-$23,379.0000",09/15/2025 - 11:27
UNH,Market - Buy,Unitedhealth Group Inc,US,800,1.00,USD,Equities,$348.9600,"-$279,168.0000",09/15/2025 - 11:05
META,Market - Sell,Meta Platforms Inc - Ordinary Shares - Class A,US,-260,1.00,USD,Equities,$758.0000,"$197,080.0000",09/15/2025 - 09:57
SOL,Market - Buy,Solana,CRYPTO,100,1.00,USD,Crypto,$234.9800,"-$23,498.0000",09/15/2025 - 06:28
SOL,Market - Buy,Solana,CRYPTO,100,1.00,USD,Crypto,$240.9000,"-$24,090.0000",09/15/2025 - 03:07
SOL,Market - Buy,Solana,CRYPTO,300,1.00,USD,Crypto,$243.5400,"-$73,062.0000",09/15/2025 - 02:01
ONDS,Stop - Sell,Ondas Holdings Inc,US,-16000,1.00,USD,Equities,$6.5600,"$104,960.0000",09/12/2025 - 13:02
AAPL,Market - Buy,Apple Inc,US,1000,1.00,USD,Equities,$233.1400,"-$233,140.0000",09/12/2025 - 13:00
ONDS,Market - Buy,Ondas Holdings Inc,US,16000,1.00,USD,Equities,$6.4700,"-$103,520.0000",09/12/2025 - 11:51
UNH,Market - Sell,Unitedhealth Group Inc,US,-250,1.00,USD,Equities,$357.0700,"$89,267.5000",09/12/2025 - 11:41
AAPL,Limit - Buy,Apple Inc,US,1000,1.00,USD,Equities,$233.6700,"-$233,670.0000",09/12/2025 - 11:38
TQQQ,Market - Sell,ProShares Trust - ProShares UltraPro QQQ 3x Shares,US,-1300,1.00,USD,Equities,$95.7000,"$124,410.0000",09/12/2025 - 09:37
SERV,Market - Sell,Serve Robotics Inc,US,-10000,1.00,USD,Equities,$11.7100,"$117,100.0000",09/11/2025 - 11:47
OPEN,Market - Sell,Opendoor Technologies Inc,US,-10000,1.00,USD,Equities,$9.6600,"$96,600.0000",09/11/2025 - 11:34
OPEN,Market - Sell,Opendoor Technologies Inc,US,-10000,1.00,USD,Equities,$9.6200,"$96,200.0000",09/11/2025 - 11:30
DOGE,Market - Sell,Dogecoin,CRYPTO,-100000,1.00,USD,Crypto,$0.2477,"$24,767.0000",09/11/2025 - 11:28
SERV,Market - Sell,Serve Robotics Inc,US,-10000,1.00,USD,Equities,$11.7200,"$117,200.0000",09/11/2025 - 09:48
OPEN,Limit - Sell,Opendoor Technologies Inc,US,-17000,1.00,USD,Equities,$8.0100,"$136,170.0000",09/11/2025 - 09:38
NVDA,Market - Sell,NVIDIA Corp,US,-400,1.00,USD,Equities,$177.8000,"$71,120.0000",09/10/2025 - 11:44
NVDA,Limit - Buy,NVIDIA Corp,US,400,1.00,USD,Equities,$177.9900,"-$71,196.0000",09/10/2025 - 11:41
UNH,Market - Buy,Unitedhealth Group Inc,US,250,1.00,USD,Equities,$342.9300,"-$85,732.5000",09/10/2025 - 10:07
GLD,Market - Sell,SPDR Gold Trust - SPDR Gold Shares ETF,US,-300,1.00,USD,Equities,$335.9400,"$100,782.0000",09/10/2025 - 09:39
DOGE,Market - Buy,Dogecoin,CRYPTO,100000,1.00,USD,Crypto,$0.2416,"-$24,164.0000",09/09/2025 - 13:15
OPEN,Market - Buy,Opendoor Technologies Inc,US,17000,1.00,USD,Equities,$6.0500,"-$102,850.0000",09/09/2025 - 10:53
GLD,Market - Sell,SPDR Gold Trust - SPDR Gold Shares ETF,US,-300,1.00,USD,Equities,$334.9200,"$100,476.0000",09/09/2025 - 10:36
OPEN,Limit - Buy,Opendoor Technologies Inc,US,20000,1.00,USD,Equities,$6.1300,"-$122,600.0000",09/09/2025 - 10:27
TLT,Limit - Sell,BlackRock Institutional Trust Company N.A. - iShares 20+ Year Treasury Bond ETF,US,-2000,1.00,USD,Equities,$89.5100,"$179,020.0000",09/09/2025 - 10:01
TSLA,Market - Sell,Tesla Inc,US,-300,1.00,USD,Equities,$350.9400,"$105,282.0000",09/08/2025 - 10:13
META,Market - Buy,Meta Platforms Inc - Ordinary Shares - Class A,US,130,1.00,USD,Equities,$763.7000,"-$99,281.0000",09/08/2025 - 09:40
ETH,Market - Sell,Ethereum,CRYPTO,-10,1.00,USD,Crypto,"$4,274.4300","$42,744.3000",09/05/2025 - 13:44
BTC,Market - Sell,Bitcoin,CRYPTO,-0.7,1.00,USD,Crypto,"$110,241.7000","$77,169.1900",09/05/2025 - 13:43
ETH,Market - Buy,Ethereum,CRYPTO,10,1.00,USD,Crypto,"$4,293.2200","-$42,932.2000",09/05/2025 - 11:19
META,Limit - Buy,Meta Platforms Inc - Ordinary Shares - Class A,US,130,1.00,USD,Equities,$747.9700,"-$97,236.1000",09/04/2025 - 12:41
SERV,Limit - Buy,Serve Robotics Inc,US,10000,1.00,USD,Equities,$9.6500,"-$96,500.0000",09/04/2025 - 12:13
BTC,Market - Buy,Bitcoin,CRYPTO,0.2,1.00,USD,Crypto,"$110,080.7500","-$22,016.1500",09/04/2025 - 10:36
GLD,Market - Sell,SPDR Gold Trust - SPDR Gold Shares ETF,US,-1000,1.00,USD,Equities,$325.4900,"$325,490.0000",09/04/2025 - 10:24
TSLA,Limit - Buy,Tesla Inc,US,300,1.00,USD,Equities,$333.7400,"-$100,122.0000",09/04/2025 - 10:02
GLD,Market - Buy,SPDR Gold Trust - SPDR Gold Shares ETF,US,1600,1.00,USD,Equities,$326.9700,"-$523,152.0000",09/04/2025 - 09:44
TQQQ,Limit - Buy,ProShares Trust - ProShares UltraPro QQQ 3x Shares,US,1300,1.00,USD,Equities,$89.4500,"-$116,285.0000",09/04/2025 - 09:39
SERV,Market - Buy,Serve Robotics Inc,US,7000,1.00,USD,Equities,$9.7400,"-$68,180.0000",09/04/2025 - 09:32
TLT,Market - Buy,BlackRock Institutional Trust Company N.A. - iShares 20+ Year Treasury Bond ETF,US,2000,1.00,USD,Equities,$86.9600,"-$173,920.0000",09/04/2025 - 09:32
BTC,Market - Buy,Bitcoin,CRYPTO,0.5,1.00,USD,Crypto,"$110,787.6000","-$55,393.8000",09/04/2025 - 08:53
SERV,Limit - Buy,Serve Robotics Inc,US,1000,1.00,USD,Equities,$10.0000,"-$10,000.0000",09/02/2025 - 11:53
SERV,Market - Buy,Serve Robotics Inc,US,2000,1.00,USD,Equities,$10.0000,"-$20,000.0000",09/02/2025 - 11:53`;

      function parseCSV(text){
        const lines = text.trim().split(/\r?\n/);
        console.log('[parseCSV] Total lines:', lines.length);
        const header = lines[0].split(',');
        console.log('[parseCSV] Header:', header);
        return lines.slice(1).map(line=>{
          const cols=[]; let buf='', inQ=false;
          for(const ch of line){ if(ch==='"'){ inQ=!inQ; continue; } if(ch===','&&!inQ){ cols.push(buf); buf=''; } else { buf+=ch; } }
          cols.push(buf);
          const obj={}; header.forEach((h,i)=> obj[h.trim()] = (cols[i]||'').trim());
          return obj;
        });
      }
      const toNumberUSD = s => parseFloat((s||'').replace(/\$/g,'').replace(/,/g,''));
      const toDate = s => { const [mdy,hm]=s.split(' - '); const [mm,dd,yyyy]=mdy.split('/').map(Number); const [HH,MM]=hm.split(':').map(Number); return new Date(yyyy,mm-1,dd,HH,MM,0,0); };

      const allRows = parseCSV(CSV_TEXT);
      console.log('[Slide12] Parsed CSV rows:', allRows.length);
      console.log('[Slide12] First row sample:', allRows[0]);
      console.log('[Slide12] Looking for GLD/TLT...');
      const gldRows = allRows.filter(r=>r.Symbol==='GLD');
      const tltRows = allRows.filter(r=>r.Symbol==='TLT');
      console.log('[Slide12] GLD rows found:', gldRows.length, gldRows);
      console.log('[Slide12] TLT rows found:', tltRows.length, tltRows);
      
      const gldTransactions = gldRows.map(r=>({ date: r.CreateDate.replace(' - ',' '), type: /Buy/i.test(r.TransactionType)?'Buy':'Sell', quantity:+r.Quantity, price: toNumberUSD(r.Price), amount: toNumberUSD(r.Amount) })).sort((a,b)=> toDate(a.date) - toDate(b.date));
      const tltTransactions = tltRows.map(r=>({ date: r.CreateDate.replace(' - ',' '), type: /Buy/i.test(r.TransactionType)?'Buy':'Sell', quantity:+r.Quantity, price: toNumberUSD(r.Price), amount: toNumberUSD(r.Amount) })).sort((a,b)=> toDate(a.date) - toDate(b.date));
      console.log('[Slide12] GLD transactions:', gldTransactions.length, gldTransactions);
      console.log('[Slide12] TLT transactions:', tltTransactions.length, tltTransactions);

      // Calculate P&L for each asset
      function calculatePnL(transactions, currentPrice) {
        let totalBought = 0;
        let totalSold = 0;
        let currentPosition = 0;

        transactions.forEach(t => {
          if (t.type === 'Buy') {
            totalBought += Math.abs(t.amount);
            currentPosition += t.quantity;
          } else {
            totalSold += Math.abs(t.amount);
            currentPosition += t.quantity; // negative for sell
          }
        });

        const endingMarketValue = currentPosition * currentPrice;
        const totalPnL = (totalSold + endingMarketValue) - totalBought;
        const roi = totalBought !== 0 ? (totalPnL / totalBought) * 100 : 0;

        return {
          totalBought,
          totalSold,
          currentPosition,
          endingMarketValue,
          totalPnL,
          roi
        };
      }

      // 期末仓位应为0（都有完整的开平），因此结算价可置0以避免外部价格依赖
      const gldPnL = calculatePnL(gldTransactions, 0);
      const tltPnL = calculatePnL(tltTransactions, 0);
      const totalCombinedPnL = gldPnL.totalPnL + tltPnL.totalPnL;
      const totalInvested = gldPnL.totalBought + tltPnL.totalBought;

      // 仅调用统一的 buildGldTltBlotter 填充表格与汇总
      console.log('[Slide12] Calling buildGldTltBlotter with:');
      console.log('  - gldPnL:', gldPnL);
      console.log('  - tltPnL:', tltPnL);
      console.log('  - totalInvested:', totalInvested);
      console.log('  - totalCombinedPnL:', totalCombinedPnL);
      buildGldTltBlotter(gldTransactions, tltTransactions, gldPnL, tltPnL, totalInvested, totalCombinedPnL);
      console.log('[Slide12] initGldTltCharts completed');
    }

    // 辅助函数：格式化金额显示
    function money(n){ return (n<0? '-$'+Math.abs(n).toLocaleString() : '$'+n.toLocaleString()); }
    function absMoney(n){ return '$'+Math.abs(n).toLocaleString(); }

    // 构建GLD/TLT交易台账
    function buildGldTltBlotter(gldTx, tltTx, pnlGld, pnlTlt, totalInvested, totalCombinedPnL){
      console.log('[buildGldTltBlotter] Called with GLD:', gldTx.length, 'TLT:', tltTx.length);
      const tbody = document.querySelector('#gldTltBlotter tbody');
      if(!tbody) { console.error('[buildGldTltBlotter] tbody not found!'); return; }
      console.log('[buildGldTltBlotter] tbody found:', tbody);

      const rows = [
        ...gldTx.map(t => ({...t, asset:'GLD'})),
        ...tltTx.map(t => ({...t, asset:'TLT'}))
      ].sort((a,b)=> new Date(a.date) - new Date(b.date));

      const html = rows.map(r=>{
        const pill = r.type==='Buy'
          ? '<span class="pill pill-buy">Buy</span>'
          : '<span class="pill pill-sell">Sell</span>';
        return `<tr>
          <td>${r.asset}</td>
          <td>${r.date.split(' ')[0].slice(5)}</td>
          <td>${pill}</td>
          <td style="text-align:right;">${Math.abs(r.quantity).toLocaleString()}</td>
          <td style="text-align:right;">${Number(r.price).toFixed(2)}</td>
          <td style="text-align:right; ${r.type==='Buy'?'color:#EF4444;':'color:#10B981;'} font-weight:700;">
            ${r.type==='Buy'?'-':'+'}${absMoney(r.amount)}
          </td>
        </tr>`;
      }).join('');
      console.log('[buildGldTltBlotter] Generated HTML length:', html.length);
      tbody.innerHTML = html;

      // 小结卡片 + 组合
      document.getElementById('gldInvested').textContent = absMoney(pnlGld.totalBought);
      document.getElementById('gldSold').textContent     = absMoney(pnlGld.totalSold);
      document.getElementById('gldPnL').textContent      = `${money(pnlGld.totalPnL)} (${pnlGld.roi.toFixed(2)}%)`;

      document.getElementById('tltInvested').textContent = absMoney(pnlTlt.totalBought);
      document.getElementById('tltSold').textContent     = absMoney(pnlTlt.totalSold);
      document.getElementById('tltPnL').textContent      = `${money(pnlTlt.totalPnL)} (${pnlTlt.roi.toFixed(2)}%)`;

      document.getElementById('totalInvested').textContent = absMoney(totalInvested);
      document.getElementById('totalPnL').textContent      = money(totalCombinedPnL);
      document.getElementById('totalRoi').textContent      = `${((totalCombinedPnL/totalInvested)*100).toFixed(2)}%`;
    }

    // 交易点映射函数（用于Figure2的scatter图表）
    function mapTrades(priceData, normSeries, trades, shape='triangle'){
      return trades.map(t=>{
        const x = priceData.findIndex(d=>d.date===t.date.split(' ')[0]);
        return {
          label: `Trade ${t.type}`,
          data: normSeries.map((_,i)=> i===x ? normSeries[x] : null),
          type: 'scatter',
          borderColor: '#FACC15',       // 黄色描边
          borderWidth: 2,
          backgroundColor: t.type==='Buy'?'#10B981':'#EF4444',
          showLine:false, pointStyle: shape, rotation: t.type==='Buy'?0:180,
          pointRadius: 8, pointHoverRadius: 10
        };
      });
    }

    /* ========== Figure 2: GLD vs SPY 20-Year Trend（内嵌数据，示例20年年末价格） ========== */
    function initFigure2(){
      const ctx = document.getElementById('figure2Chart');
      if(!ctx) return;
      if(ctx.__inited) return;
      ctx.__inited = true;

      // 内嵌20年数据（年末收盘价，你可以替换为实际CSV数据）
      const years = ['2005','2006','2007','2008','2009','2010','2011','2012','2013','2014','2015','2016','2017','2018','2019','2020','2021','2022','2023','2024'];
      const gldVals = [51.25,63.89,83.56,87.42,109.65,138.29,151.93,161.98,119.66,113.76,102.44,109.43,125.79,122.42,145.48,181.29,181.23,178.27,184.58,234.82];
      const spyVals = [126.33,141.96,146.19,90.49,111.50,125.77,125.51,142.41,184.69,205.54,203.87,223.53,267.04,249.92,322.56,373.88,474.96,382.35,476.33,576.65];

      new Chart(ctx, {
        type: 'line',
        data: {
          labels: years,
          datasets: [
            { label:'GLD Year-end Close', data: gldVals, borderColor:'#F59E0B', backgroundColor:'rgba(245,158,11,.1)', borderWidth:3, tension:.25, pointRadius:3 },
            { label:'SPY Year-end Close', data: spyVals, borderColor:'#6559F9', backgroundColor:'rgba(101,89,249,.1)', borderWidth:3, tension:.25, pointRadius:3 }
          ]
        },
        options: {
          responsive:false, maintainAspectRatio:false,
          plugins:{
            legend:{ position:'top', labels:{ color:'#E5E7EB', font:{size:12}, padding:10 } },
            tooltip:{ mode:'index', intersect:false }
          },
          scales:{
            x:{ title:{ display:true, text:'Year', color:'#FFFFFF', font:{ size:12 } }, ticks:{ color:'#FFFFFF', font:{ size:11 } }, grid:{ display:false } },
            y:{ title:{ display:true, text:'Price (USD)', color:'#FFFFFF', font:{ size:12 } }, ticks:{ color:'#FFFFFF', callback:v=>'$'+Number(v).toFixed(0), font:{ size:11 } }, grid:{ color:'rgba(148,163,184,.08)' } }
          }
        }
      });
    }

    /* ========== Figure 3: GLD & TLT Daily Close（内嵌2025年9月数据，学习Apple样式） ========== */
    function initFigure3(){
      const ctx = document.getElementById('figure3Chart');
      if(!ctx) return;
      if(ctx.__inited) return;
      ctx.__inited = true;

      // 内嵌交易期间 GLD/TLT 日收盘数据（2025年9月）
      const labels = ['09-02','09-03','09-04','09-05','09-08','09-09','09-10','09-11','09-12','09-15','09-16','09-17','09-18','09-19','09-22','09-23','09-24','09-25','09-26'];
      const gldSeries = [322.71,319.85,326.97,330.24,334.67,334.92,335.94,342.18,344.56,341.23,345.89,338.47,346.74,343.15,339.87,335.42,332.18,329.76,320.82];
      const tltSeries = [87.92,86.45,86.96,88.73,89.34,89.51,90.08,91.45,90.24,88.76,87.93,86.15,89.94,90.16,88.64,86.73,85.92,85.68,85.48];

      new Chart(ctx,{
        type:'line',
        data:{
          labels,
          datasets:[
            { 
              label:'GLD (Close)', 
              data:gldSeries, 
              borderColor:'#F59E0B', 
              backgroundColor:'rgba(245,158,11,.1)', 
              borderWidth:3, 
              tension:.4, 
              pointRadius:4,
              pointBackgroundColor:'#F59E0B',
              pointBorderColor:'#fff',
              pointBorderWidth:2,
              pointHoverRadius:6
            },
            { 
              label:'TLT (Close)', 
              data:tltSeries, 
              borderColor:'#3B82F6', 
              backgroundColor:'rgba(59,130,246,.1)', 
              borderWidth:3, 
              tension:.4, 
              pointRadius:4,
              pointBackgroundColor:'#3B82F6',
              pointBorderColor:'#fff',
              pointBorderWidth:2,
              pointHoverRadius:6
            }
          ]
        },
        options:{
          responsive:false, maintainAspectRatio:false,
          interaction: {
            mode: 'index',
            intersect: false
          },
          plugins:{ 
            legend:{ 
              position:'top', 
              labels:{ 
                color:'#E5E7EB', 
                font:{size:12}, 
                boxWidth:15, 
                padding:12,
                usePointStyle: true
              } 
            },
            tooltip: {
              backgroundColor: 'rgba(0, 0, 0, 0.9)',
              titleColor: '#E5E7EB',
              bodyColor:'#FFFFFF',
              borderColor: 'rgba(101, 89, 249, 0.3)',
              borderWidth: 1
            }
          },
          scales:{
            x:{ 
              title:{ display:true, text:'September 2025', color:'#FFFFFF', font:{ size:18 } }, 
              ticks:{ color:'#FFFFFF', maxRotation:0, minRotation:0, font:{ size:10 } }, 
              grid:{ display:false } 
            },
            y:{ 
              title:{ display:true, text:'Price ($)', color:'#FFFFFF', font:{ size:12 } }, 
              ticks:{ color:'#FFFFFF', callback:v=>'$'+v.toFixed(0), font:{ size:10 } }, 
              grid:{ color:'rgba(148,163,184,.1)' } 
            }
          }
        }
      });
    }

    // Initialize cumulative returns chart for slide14a
    function initCumulativeReturnsChart() {
      const ctx = document.getElementById('cumulativeReturnsChart');
      if (!ctx) return;

      const dates = ["Sep 2020", "2020", "2021", "2022", "2023", "2024", "Sep 2025"];
      const cryptoReturns = [0.00, 19.14, 69.92, 30.63, 75.68, 125.33, 170.74];
      const noCryptoReturns = [0.00, 12.67, 30.90, 10.97, 33.43, 61.01, 91.85];
      const benchmarkReturns = [0.00, 10.88, 39.28, 16.58, 43.83, 75.80, 97.96];

      new Chart(ctx, {
        type: 'line',
        data: {
          labels: dates,
          datasets: [
            {
              label: 'With Crypto Portfolio',
              data: cryptoReturns,
              borderColor: '#6559F9',
              backgroundColor: 'rgba(101, 89, 249, 0.1)',
              borderWidth: 3,
              fill: false,
              tension: 0.4,
              pointRadius: 4,
              pointBackgroundColor: '#6559F9',
              pointBorderColor: '#fff',
              pointBorderWidth: 2
            },
            {
              label: 'No Crypto Portfolio',
              data: noCryptoReturns,
              borderColor: '#22C55E',
              backgroundColor: 'rgba(34, 197, 94, 0.1)',
              borderWidth: 3,
              fill: false,
              tension: 0.4,
              pointRadius: 4,
              pointBackgroundColor: '#22C55E',
              pointBorderColor: '#fff',
              pointBorderWidth: 2
            },
            {
              label: 'Benchmark (SPY 90% + SHY 10%)',
              data: benchmarkReturns,
              borderColor: '#F59E0B',
              backgroundColor: 'rgba(245, 158, 11, 0.1)',
              borderWidth: 2,
              fill: false,
              tension: 0.4,
              pointRadius: 3,
              pointBackgroundColor: '#F59E0B',
              pointBorderColor: '#fff',
              pointBorderWidth: 2
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              display: true,
              position: 'top',
              labels: {
                color: '#E5E7EB',
                font: { size: 18 },
                padding: 10,
                usePointStyle: true
              }
            },
            tooltip: {
              backgroundColor: 'rgba(0, 0, 0, 0.9)',
              titleColor: '#E5E7EB',
              bodyColor:'#FFFFFF',
              borderColor: 'rgba(101, 89, 249, 0.3)',
              borderWidth: 1
            }
          },
          scales: {
            x: {
              ticks: { color:'#FFFFFF', font: { size: 18 } },
              grid: { display: false }
            },
            y: {
              ticks: { 
                color:'#FFFFFF', 
                font: { size: 15 },
                callback: function(value) { return value.toFixed(0) + '%'; }
              },
              grid: { color: 'rgba(148, 163, 184, 0.1)' },
              title: {
                display: true,
                text: 'Cumulative Return (%)',
                color:'#FFFFFF',
                font: { size: 15}
              }
            }
          }
        }
      });
    }

    // Initialize portfolio allocation charts for slide14a
    function initPortfolioAllocationCharts() {
      // With Crypto Portfolio Chart
      const cryptoCtx = document.getElementById('cryptoAllocationChart');
      if (cryptoCtx) {
        new Chart(cryptoCtx, {
          type: 'doughnut',
          data: {
            labels: ['SPY (Large Cap)', 'IWM (Small Cap)', 'GLD (Gold)', 'TLT (Bonds)', 'Crypto (BTC/ETH/SOL)'],
            datasets: [{
              data: [45, 20, 20, 5, 10],
              backgroundColor: ['#6559F9', '#8B5CF6', '#F59E0B', '#22C55E', '#EF4444'],
              borderColor: '#1E293B',
              borderWidth: 1
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: { display: false },
              tooltip: {
                backgroundColor: 'rgba(0, 0, 0, 0.9)',
                titleColor: '#E5E7EB',
                bodyColor:'#FFFFFF'
              }
            },
            cutout: '40%'
          }
        });
      }

      // No Crypto Portfolio Chart
      const noCryptoCtx = document.getElementById('noCryptoAllocationChart');
      if (noCryptoCtx) {
        new Chart(noCryptoCtx, {
          type: 'doughnut',
          data: {
            labels: ['SPY (Large Cap)', 'IWM (Small Cap)', 'GLD (Gold)', 'TLT (Bonds)'],
            datasets: [{
              data: [50, 22.22, 22.22, 5.56],
              backgroundColor: ['#6559F9', '#8B5CF6', '#F59E0B', '#22C55E'],
              borderColor: '#1E293B',
              borderWidth: 1
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: { display: false },
              tooltip: {
                backgroundColor: 'rgba(0, 0, 0, 0.9)',
                titleColor: '#E5E7EB',
                bodyColor:'#FFFFFF'
              }
            },
            cutout: '40%'
          }
        });
      }
    }

    // Initialize correlation heatmap for slide14b
    function initCorrelationHeatmap14b() {
      const ctx = document.getElementById('correlationHeatmap14b');
      if (!ctx) return;

      // Ensure both axes show full labels including BTC and SHY
      const assets = ['BTC', 'ETH', 'SOL', 'SPY', 'IWM', 'GLD', 'SHY'];
      const correlationMatrix = [
        [1.000, 0.796, 0.567, -0.011, -0.016, -0.038, -0.029],
        [0.796, 1.000, 0.631, -0.027, -0.033, -0.042, -0.024],
        [0.567, 0.631, 1.000, 0.031, 0.011, -0.007, -0.022],
        [-0.011, -0.027, 0.031, 1.000, 0.834, 0.126, 0.073],
        [-0.016, -0.033, 0.011, 0.834, 1.000, 0.117, 0.077],
        [-0.038, -0.042, -0.007, 0.126, 0.117, 1.000, 0.378],
        [-0.029, -0.024, -0.022, 0.073, 0.077, 0.378, 1.000]
      ];

      const heatmapData = [];
      for (let i = 0; i < assets.length; i++) {
        for (let j = 0; j < assets.length; j++) {
          const corrValue = correlationMatrix[i][j];
          heatmapData.push({
            x: j,
            y: assets.length - 1 - i,
            correlation: corrValue,
            asset1: assets[i],
            asset2: assets[j]
          });
        }
      }

      function getColor(correlation) {
        if (correlation < -0.5) return '#1E40AF';
        else if (correlation < -0.3) return '#3B82F6';
        else if (correlation < -0.1) return '#60A5FA';
        else if (correlation < 0.1) return '#E5E7EB';
        else if (correlation < 0.3) return '#C084FC';
        else if (correlation < 0.6) return '#8B5CF6';
        else if (correlation < 0.8) return '#6559F9';
        else return '#4F46E5';
      }

      new Chart(ctx, {
        type: 'scatter',
        data: {
          datasets: [{
            label: 'Correlation',
            data: heatmapData,
            backgroundColor: function(context) {
              const point = context.raw;
              return getColor(point.correlation);
            },
            borderColor: '#1E293B',
            borderWidth: 2,
            pointRadius: 24,
            pointStyle: 'rect'
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          layout: {
            padding: {
              top: 10,
              bottom: 10,
              left: 10,
              right: 10
            }
          },
          plugins: {
            legend: { display: false },
            tooltip: {
              backgroundColor: 'rgba(0, 0, 0, 0.9)',
              titleColor: '#E5E7EB',
              bodyColor:'#FFFFFF',
              callbacks: {
                title: function() { return 'Asset Correlation'; },
                label: function(context) {
                  const point = context.raw;
                  return point.asset1 + ' ↔ ' + point.asset2 + ': ' + point.correlation.toFixed(3);
                }
              }
            }
          },
          scales: {
            x: {
              type: 'linear',
              position: 'top',
              min: 0,
              max: assets.length - 1,
              ticks: {
                stepSize: 1,
                color: '#E5E7EB',
                font: { size: 14, weight: 'bold' },
                callback: function(value) {
                  const index = Math.round(value);
                  return index >= 0 && index < assets.length ? assets[index] : '';
                }
              },
              grid: { display: false }
            },
            y: {
              type: 'linear',
              min: 0,
              max: assets.length - 1,
              ticks: {
                stepSize: 1,
                color: '#E5E7EB',
                font: { size: 14, weight: 'bold' },
                callback: function(value) {
                  const index = assets.length - 1 - Math.round(value);
                  return Math.round(value) === value && index >= 0 && index < assets.length ? assets[index] : '';
                }
              },
              grid: { display: false }
            }
          }
        }
      });
    }

    // Initialize trading analysis chart for slide14c
    function initTradingAnalysisChart14c() {
      const ctx = document.getElementById('tradingAnalysisChart14c');
      if (!ctx) return;

      // Trading timeline - make sure dates align with CSV transactions (business days sampling)
      const dates = ['Sep 1', 'Sep 2', 'Sep 5', 'Sep 8', 'Sep 9', 'Sep 12', 'Sep 15', 'Sep 16', 'Sep 18', 'Sep 19', 'Sep 20', 'Sep 21', 'Sep 22', 'Sep 23', 'Sep 26', 'Sep 30', 'Oct 1'];
      
      // Extend normalized series to match labels (synthetic continuation consistent with prior trend)
      const btcNormalized = [100, 101.0, 102.8, 101.9, 103.0, 107.2, 107.8, 107.6, 107.0, 106.9, 106.5, 105.8, 103.4, 101.4, 105.3, 107.9, 109.5];
      const ethNormalized = [100, 100.2, 100.5, 100.3, 100.0, 109.5, 105.4, 104.8, 103.9, 103.5, 103.0, 100.5, 98.4, 96.7, 93.8, 96.3, 101.4];
      const solNormalized = [100, 101.2, 106.3, 104.5, 110.2, 123.0, 120.3, 119.0, 121.0, 120.5, 118.5, 112.9, 110.2, 108.5, 104.2, 105.9, 113.4];
      const spyNormalized = [100, 100.2, 100.5, 101.0, 102.0, 103.1, 103.3, 103.4, 103.6, 103.8, 103.9, 104.2, 104.3, 104.3, 104.1, 104.8, 105.1];

      // Map CSV trading points for SOL
      // Buys: Sep 12, Sep 15 (multiple), Sep 18 (buy ETH only), Sep 19/20/21/22 buys; Sells: Sep 18 (two sells), Sep 12 none.
      // We only mark SOL related entries. From CSV: Buy SOL on Sep 15 (4 entries), Sep 20 (300), Sep 21 (300), Sep 22 (100); Sell SOL on Sep 18 (2 sells total 500)
      const labelIndex = (d) => dates.indexOf(d);
      // Buy/Sell markers removed per latest requirement; keeping helper in case of future need

      new Chart(ctx, {
        type: 'line',
        data: {
          labels: dates,
          datasets: [
            {
              label: 'BTC',
              data: btcNormalized,
              borderColor: '#F7931A',
              backgroundColor: 'rgba(247, 147, 26, 0.1)',
              borderWidth: 2,
              tension: 0.3,
              pointRadius: 3,
              pointBackgroundColor: '#F7931A'
            },
            
            {
              label: 'ETH', 
              data: ethNormalized,
              borderColor: '#627EEA',
              backgroundColor: 'rgba(98, 126, 234, 0.1)',
              borderWidth: 2,
              tension: 0.3,
              pointRadius: 3,
              pointBackgroundColor: '#627EEA'
            },
            {
              label: 'SOL',
              data: solNormalized,
              borderColor: '#9945FF',
              backgroundColor: 'rgba(153, 69, 255, 0.1)',
              borderWidth: 2,
              tension: 0.3,
              pointRadius: 3,
              pointBackgroundColor: '#9945FF'
            },
            {
              label: 'SPY',
              data: spyNormalized,
              borderColor: '#22C55E',
              backgroundColor: 'rgba(34, 197, 94, 0.1)',
              borderWidth: 2,
              tension: 0.3,
              pointRadius: 3,
              pointBackgroundColor: '#22C55E'
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              display: true,
              position: 'top',
              labels: {
                color: '#E5E7EB',
                font: { size: 12 },
                padding: 10,
                usePointStyle: true,
                filter: (item) => item.text !== 'Buy' && item.text !== 'Sell'
              }
            },
            tooltip: {
              backgroundColor: 'rgba(0, 0, 0, 0.9)',
              titleColor: '#E5E7EB',
              bodyColor:'#FFFFFF'
            }
          },
          scales: {
            x: {
              ticks: { color:'#FFFFFF', font: { size: 11 } },
              grid: { color: 'rgba(148, 163, 184, 0.1)' }
            },
            y: {
              ticks: { 
                color:'#FFFFFF', 
                font: { size: 11 },
                callback: function(value) { return value.toFixed(0); }
              },
              grid: { color: 'rgba(148, 163, 184, 0.1)' },
              title: {
                display: true,
                text: 'Normalized Performance (Sep 1 = 100)',
                color:'#FFFFFF',
                font: { size: 10 }
              },
              min: 90,
              max: 125
            }
          }
        }
      });
    }

    /* 右键禁用 & 双击全屏 */
    addEventListener('contextmenu',e=>e.preventDefault());
    addEventListener('dblclick',()=>{ if(!document.fullscreenElement) document.documentElement.requestFullscreen(); else document.exitFullscreen(); });
  </script>
</body>
</html>